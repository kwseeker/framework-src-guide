<mxfile host="Electron" modified="2025-02-10T08:06:16.233Z" agent="Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/21.6.5 Chrome/114.0.5735.243 Electron/25.3.1 Safari/537.36" etag="i0Qi7lgECgTN7lx-JIw3" version="21.6.5" type="device">
  <diagram name="第 1 页" id="cxMNqNoHDy86zcxc0TlN">
    <mxGraphModel dx="5357" dy="1256" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-41" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="JILRKh1KAr4Q8uxwXJQX-26" target="JILRKh1KAr4Q8uxwXJQX-40" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="3900" y="540" />
              <mxPoint x="3900" y="880" />
              <mxPoint x="260" y="880" />
              <mxPoint x="260" y="950" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-1" value="&lt;h1 style=&quot;font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;Quarkus Core 工作流程 （3.17.6）&lt;/font&gt;&lt;/h1&gt;&lt;p style=&quot;font-size: 11px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;Quarkus 为了支持&lt;b&gt;本地化编译&lt;/b&gt;将启动流程分为了&lt;b&gt;引导阶段&lt;/b&gt;和&lt;b&gt;应用启动阶段&lt;/b&gt;，引导阶段主要是&lt;b&gt;执行 BuildStep 生成一套应用代码&lt;/b&gt;（应用代码里面很多类是在&lt;b&gt;增强阶段&lt;/b&gt;用自己封装的字节码工具Gizmo（基于ASM）动态生成的），这也导致源码不容易理解（相当于从元编程的角度编写应用代码）另外还有很多动态类加载、函数式代码、事件驱动代码提升了读码难度。&lt;br&gt;&lt;span style=&quot;font-size: 11px;&quot;&gt;Quarkus 执行流程是先执行引导阶段生成一套应用代码，再执行生成的应用代码。&lt;/span&gt;&lt;br&gt;&lt;span style=&quot;font-size: 11px;&quot;&gt;测试DEMO: quarkus-010-smallest-system。&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;font-size: 11px; background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="40" y="10" width="960" height="90" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-4" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="JILRKh1KAr4Q8uxwXJQX-2" target="JILRKh1KAr4Q8uxwXJQX-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-2" value="&lt;b&gt;DevModeMain#main&lt;/b&gt;&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;开发模式启动的真正入口&lt;br&gt;&lt;/b&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;main 线程，这里main线程不会一直存活&lt;/font&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="40" y="120" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-8" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="JILRKh1KAr4Q8uxwXJQX-3" target="JILRKh1KAr4Q8uxwXJQX-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-3" value="&lt;div&gt;public static void &lt;b&gt;main&lt;/b&gt;(String... args) throws Exception {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; try (InputStream devModeCp = DevModeMain.class.getClassLoader()&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .getResourceAsStream(&lt;b&gt;DEV_MODE_CONTEXT&lt;/b&gt;)) { &lt;font color=&quot;#007fff&quot;&gt;// 读取&amp;nbsp;META-INF/dev-mode-context.dat&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;DevModeContext&lt;/b&gt; context;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; try {&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // dev-mode-context.dat 反序列化为 DevModeContext&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;context&lt;/b&gt; = (DevModeContext) new ObjectInputStream(new DataInputStream(devModeCp))&lt;br&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;.readObject();&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; } catch (Exception e) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; throw new RuntimeException(...&lt;span style=&quot;background-color: initial;&quot;&gt;,&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;e);&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; context.setArgs(args);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;DevModeMain&lt;/b&gt; &lt;b&gt;devModeMain&lt;/b&gt; = new DevModeMain(context);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; devModeMain.&lt;b&gt;start&lt;/b&gt;();&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;arcSize=3;" parent="1" vertex="1">
          <mxGeometry x="280" y="120" width="440" height="200" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-1" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;endArrow=open;endFill=0;" parent="1" source="JILRKh1KAr4Q8uxwXJQX-5" target="JILRKh1KAr4Q8uxwXJQX-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-5" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;DevModeMain&lt;/b&gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;真正的主类&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;// 这个文件是编译生成的，是对象序列化文件&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;public static final String DEV_MODE_CONTEXT = &quot;META-INF/dev-mode-context.dat&quot;;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;// 开发模式应用上下文&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final &lt;b&gt;DevModeContext&lt;/b&gt; &lt;b&gt;context&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile CuratedApplication curatedApplication;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private Closeable realCloseable;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;public void start() throws Exception&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;public void close() throws IOException&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="-520" y="120" width="480" height="200" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-11" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;endArrow=open;endFill=0;" parent="1" source="JILRKh1KAr4Q8uxwXJQX-6" target="JILRKh1KAr4Q8uxwXJQX-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-6" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center; font-size: 10px;&quot;&gt;&lt;b style=&quot;font-size: 10px;&quot;&gt;DevModeContext&lt;/b&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;开发模式应用上下文&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;public static final CompilationUnit EMPTY_COMPILATION_UNIT = new &lt;br style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; CompilationUnit(PathList.of(), null, null, null, null);&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;public static final String ENABLE_PREVIEW_FLAG = &quot;--enable-preview&quot;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;b style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;// 应用资源根路径信息（包括工程根目录、类路径、测试类路径、target路径等等）&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;private &lt;b style=&quot;font-size: 10px;&quot;&gt;ModuleInfo&lt;/b&gt; &lt;b style=&quot;font-size: 10px;&quot;&gt;applicationRoot&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;private final List&amp;lt;ModuleInfo&amp;gt; additionalModules = new ArrayList&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&lt;b style=&quot;font-size: 10px;&quot;&gt;// 系统属性&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;private final Map&amp;lt;String, String&amp;gt; &lt;b style=&quot;font-size: 10px;&quot;&gt;systemProperties&lt;/b&gt; = new HashMap&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;b style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;// Quarkus build阶段需要用到的系统属性&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;private final Map&amp;lt;String, String&amp;gt; buildSystemProperties = new HashMap&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;private String sourceEncoding;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;private final List&amp;lt;URL&amp;gt; additionalClassPathElements = new ArrayList&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;private File &lt;b style=&quot;font-size: 10px;&quot;&gt;cacheDir&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;private File &lt;b style=&quot;font-size: 10px;&quot;&gt;projectDir&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;private boolean test;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;private boolean abortOnFailedStart;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;// the jar file which is used to launch the DevModeMain&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;private File &lt;b style=&quot;font-size: 10px;&quot;&gt;devModeRunnerJarFile&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;private boolean localProjectDiscovery = true;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;// args of the main-method&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;private String[] &lt;b style=&quot;font-size: 10px;&quot;&gt;args&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;private Map&amp;lt;String, Set&amp;lt;String&amp;gt;&amp;gt; compilerOptions;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;private String &lt;b style=&quot;font-size: 10px;&quot;&gt;releaseJavaVersion&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;private String sourceJavaVersion;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;private String targetJvmVersion;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;private List&amp;lt;String&amp;gt; compilerPluginArtifacts;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;private List&amp;lt;String&amp;gt; compilerPluginsOptions;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;private String alternateEntryPoint;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;// 共有6种模式&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;private QuarkusBootstrap.Mode &lt;b style=&quot;font-size: 10px;&quot;&gt;mode&lt;/b&gt; = QuarkusBootstrap.Mode.DEV;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;private String baseName;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;private final Set&amp;lt;ArtifactKey&amp;gt; localArtifacts = new HashSet&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;private Set&amp;lt;File&amp;gt; processorPaths;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;private List&amp;lt;String&amp;gt; processors;&lt;/p&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="-1040" y="120" width="480" height="560" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-14" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="JILRKh1KAr4Q8uxwXJQX-7" target="JILRKh1KAr4Q8uxwXJQX-13" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-7" value="2" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="JILRKh1KAr4Q8uxwXJQX-14" vertex="1" connectable="0">
          <mxGeometry x="0.6584" y="-3" relative="1" as="geometry">
            <mxPoint y="-3" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-3" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="JILRKh1KAr4Q8uxwXJQX-7" target="qXlFPTfgbzIKhoeTkRCt-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-7" value="&lt;div&gt;public void start() throws Exception {&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; // 将开发模式上下文中的系统属性传递给系统属性&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; // DevModeContext.systemProperties -&amp;gt; System.setProperty&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; try {&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // 1 获取 DevModeMain.class 所在的归档文件路径即jar路径&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; URL thisArchive = getClass().getResource(DevModeMain.class.getSimpleName() + &quot;.class&quot;);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; int endIndex = thisArchive.getPath().indexOf(&quot;!&quot;);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; Path path;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // 获取 DevModeMain.class 所在 Jar 包路径, 比如&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;font color=&quot;#007fff&quot;&gt;/home/arvin/.m2/repository/io/quarkus/quarkus-core-deployment/3.17.6/quarkus-core-deployment-3.17.6.jar&lt;/font&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; final PathList.Builder appRootsBuilder = PathList.builder();&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; final Path classesPath = Path.of(context.getApplicationRoot().getMain().getClassesPath());&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ... 获取 src/main 编译资源路径信息, 加到 appRootsBuilder ...&lt;/font&gt;&lt;/div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // 比如：/home/arvin/mywork/java/quarkus-labs/quarkus-010-smallest-system/target/classes&lt;/font&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; final PathList appRoots = appRootsBuilder.build();&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;QuarkusBootstrap.Builder&lt;/b&gt; &lt;b&gt;bootstrapBuilder&lt;/b&gt; = QuarkusBootstrap.builder()&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .setApplicationRoot(appRoots)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .setIsolateDeployment(true)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .setLocalProjectDiscovery(context.isLocalProjectDiscovery())&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .addAdditionalDeploymentArchive(path)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .setBaseName(context.getBaseName())&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .setMode(context.getMode());&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ... 将 DevModeContext 中的部分属性复制到 bootstrapBuilder ...&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // 构造 QuarkusBootstrap 实例并启动，返回 CruratedApplication&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;curatedApplication&lt;/b&gt; = bootstrapBuilder.setTest(context.isTest()).&lt;b&gt;build&lt;/b&gt;().&lt;b&gt;bootstrap&lt;/b&gt;();&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;// 2&amp;nbsp; 默认执行开发模式启动入口&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; realCloseable = (Closeable) curatedApplication.&lt;b&gt;runInAugmentClassLoader&lt;/b&gt;(&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; context.getAlternateEntryPoint() == null ? &lt;b&gt;IsolatedDevModeMain&lt;/b&gt;.class.getName()&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; : context.&lt;b&gt;getAlternateEntryPoint&lt;/b&gt;(),&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; map);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; } catch (Throwable t) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; log.error(&quot;Quarkus dev mode failed to start&quot;, t);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; throw (t instanceof RuntimeException ? (RuntimeException) t : new RuntimeException(t));&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; //System.exit(1);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;arcSize=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="760" y="120" width="440" height="520" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-9" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center; font-size: 11px;&quot;&gt;&lt;span style=&quot;font-size: 11px;&quot;&gt;DevModeContext$&lt;/span&gt;&lt;b style=&quot;background-color: initial;&quot;&gt;ModuleInfo&lt;/b&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ArtifactKey appArtifactKey;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final String name;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final String projectDirectory;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;// main 编译资源路径信息&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final CompilationUnit &lt;b&gt;main&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;// test 编译资源路径信息&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final CompilationUnit &lt;b&gt;test&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final String preBuildOutputDir;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final PathCollection sourceParents;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final String targetDir;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 11px;&quot;&gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;" parent="1" vertex="1">
          <mxGeometry x="-1560" y="120" width="480" height="200" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-10" value="&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;applicationRoot&lt;/b&gt; = {DevModeContext$ModuleInfo@1413}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp;appArtifactKey = {GACT@1433} &quot;top.kwseeker:quarkus-010-smallest-system::jar&quot;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp;name = &quot;top.kwseeker:quarkus-010-smallest-system&quot;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp;projectDirectory = &quot;/home/arvin/mywork/java/quarkus-labs/quarkus-010-smallest-system&quot;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp;main = {DevModeContext$CompilationUnit@1436}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp;test = {DevModeContext$CompilationUnit@1437}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp;preBuildOutputDir = &quot;/home/arvin/mywork/java/quarkus-labs/quarkus-010-smallest-system/target/generated-sources&quot;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp;sourceParents = {PathList@1439} &quot;[paths: /home/arvin/mywork/java/quarkus-labs/quarkus-010-smallest-system/src/main;]&quot;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp;targetDir = &quot;/home/arvin/mywork/java/quarkus-labs/quarkus-010-smallest-system/target&quot;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="-2140" y="120" width="570" height="120" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-12" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;QuarkusBootstrap&lt;/b&gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;Qurakus 应用启动器，里面大部分属性拷贝自应用模式上下文，比如 DevModeContext&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final PathCollection applicationRoot;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Path projectRoot;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final List&amp;lt;AdditionalDependency&amp;gt; additionalApplicationArchives;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final List&amp;lt;Path&amp;gt; additionalDeploymentArchives;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final List&amp;lt;Path&amp;gt; excludeFromClassPath;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Properties buildSystemProperties;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Properties runtimeProperties;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final String baseName;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final String originalBaseName;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Path targetDirectory;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Mode mode;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Boolean offline;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final boolean test;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Boolean localProjectDiscovery;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ClassLoader baseClassLoader;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final AppModelResolver appModelResolver;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ResolvedDependency appArtifact;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final boolean isolateDeployment;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final MavenArtifactResolver mavenArtifactResolver;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ArtifactCoords managingProject;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final List&amp;lt;Dependency&amp;gt; forcedDependencies;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final boolean disableClasspathCache;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ApplicationModel existingModel;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final boolean rebuild;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Set&amp;lt;ArtifactKey&amp;gt; localArtifacts;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final List&amp;lt;ClassLoaderEventListener&amp;gt; classLoadListeners;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final boolean auxiliaryApplication;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final boolean hostApplicationIsTestOnly;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final boolean assertionsEnabled;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final boolean defaultFlatTestClassPath;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Collection&amp;lt;ArtifactKey&amp;gt; parentFirstArtifacts;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Supplier&amp;lt;DependencyInfoProvider&amp;gt; depInfoProvider;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 11px;&quot;&gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="-520" y="440" width="480" height="520" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-18" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="JILRKh1KAr4Q8uxwXJQX-13" target="JILRKh1KAr4Q8uxwXJQX-17" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-13" value="&lt;div&gt;public Object &lt;b&gt;runInAugmentClassLoader&lt;/b&gt;(String consumerName, Map&amp;lt;String, Object&amp;gt; params) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; return this.&lt;b&gt;runInCl&lt;/b&gt;(consumerName, params, this.getOrCreateAugmentClassLoader());&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;arcSize=9;" parent="1" vertex="1">
          <mxGeometry x="1240.5" y="400" width="440" height="60" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-4" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;strokeColor=none;endArrow=open;endFill=0;" parent="1" source="JILRKh1KAr4Q8uxwXJQX-15" target="JILRKh1KAr4Q8uxwXJQX-12" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-5" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;endArrow=open;endFill=0;" parent="1" source="JILRKh1KAr4Q8uxwXJQX-15" target="JILRKh1KAr4Q8uxwXJQX-12" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-15" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;CuratedApplication&lt;/b&gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private static final String &lt;b&gt;AUGMENTOR&lt;/b&gt; = &quot;io.quarkus.runner.bootstrap.AugmentActionImpl&quot;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Map&amp;lt;ArtifactKey, ClassPathElement&amp;gt; augmentationElements = new HashMap();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile QuarkusClassLoader augmentClassLoader;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile QuarkusClassLoader baseRuntimeClassLoader;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final &lt;b&gt;QuarkusBootstrap&lt;/b&gt; &lt;b&gt;quarkusBootstrap&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;// 只包含一个 ApplicationModel 字段，默认是从&amp;nbsp;quarkus/bootstrap/dev-app-model.dat 反序列化获取&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final &lt;b&gt;CurationResult&lt;/b&gt; &lt;b&gt;curationResult&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;// 包含类加载配置，比如依赖的需要先加载的 jar包&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ConfiguredClassLoading &lt;b&gt;configuredClassLoading&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;// 应用模型&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;final ApplicationModel &lt;b&gt;appModel&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;final AtomicInteger runtimeClassLoaderCount = new AtomicInteger();&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 11px;&quot;&gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="-1040" y="720" width="480" height="240" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-16" value="CuratedApplication" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="1400.5" y="370" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-22" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="JILRKh1KAr4Q8uxwXJQX-17" target="JILRKh1KAr4Q8uxwXJQX-21" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-17" value="&lt;div&gt;&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;// 测试中是动态加载 IsolatedDevModeMain 并实例化，然后执行其 accept 方法（继承了 BiConsumer）&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;Class&amp;lt;? extends BiConsumer&amp;lt;CuratedApplication, Map&amp;lt;String, Object&amp;gt;&amp;gt;&amp;gt; clazz = &lt;br&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;(Class&amp;lt;? extends BiConsumer&amp;lt;CuratedApplication, Map&amp;lt;String, Object&amp;gt;&amp;gt;&amp;gt;) cl&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;.&lt;b&gt;loadClass&lt;/b&gt;(consumerName);&lt;/div&gt;&lt;div&gt;BiConsumer&amp;lt;CuratedApplication, Map&amp;lt;String, Object&amp;gt;&amp;gt; biConsumer = &lt;br&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;clazz.getDeclaredConstructor().&lt;b&gt;newInstance&lt;/b&gt;();&lt;/div&gt;&lt;div&gt;biConsumer.&lt;b&gt;accept&lt;/b&gt;(this, params);&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;arcSize=9;" parent="1" vertex="1">
          <mxGeometry x="1719.5" y="380" width="440" height="100" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-19" value="&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#007fff&quot;&gt;consumerName = &quot;io.quarkus.deployment.dev.&lt;b&gt;IsolatedDevModeMain&lt;/b&gt;&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#007fff&quot;&gt;params = {HashMap@1612}&amp;nbsp; size = 2&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#007fff&quot;&gt;&amp;nbsp;&quot;io.quarkus.deployment.dev.DevModeContext&quot; -&amp;gt; {DevModeContext@1407}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#007fff&quot;&gt;&amp;nbsp;&quot;io.quarkus.dev.spi.DevModeType&quot; -&amp;gt; {DevModeType@1862} &quot;LOCAL&quot;&lt;/font&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1719.5" y="485" width="370" height="60" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-20" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;IsolatedDevModeMain&lt;/b&gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;开发模式的启动入口&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;public static final String APP_ROOT = &quot;app-root&quot;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile DevModeContext &lt;b&gt;context&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final List&amp;lt;HotReplacementSetup&amp;gt; hotReplacementSetups = new ArrayList&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile RunningQuarkusApplication runner;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;final AtomicReference&amp;lt;Throwable&amp;gt; deploymentProblem = new AtomicReference&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile &lt;b&gt;CuratedApplication&lt;/b&gt; &lt;b&gt;curatedApplication&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile &lt;b&gt;AugmentAction&lt;/b&gt; &lt;b&gt;augmentAction&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile boolean restarting;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile boolean firstStartCompleted;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final CountDownLatch shutdownLatch = new CountDownLatch(1);&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private Thread shutdownThread;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private CodeGenWatcher codeGenWatcher;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile ConsoleStateManager.ConsoleContext consoleContext;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final List&amp;lt;DevModeListener&amp;gt; listeners = new ArrayList&amp;lt;&amp;gt;();&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;public void accept(CuratedApplication o, Map&amp;lt;String, Object&amp;gt; params)&amp;nbsp;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="-520" y="1000" width="480" height="320" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-25" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="JILRKh1KAr4Q8uxwXJQX-21" target="JILRKh1KAr4Q8uxwXJQX-24" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-21" value="&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;public void &lt;b&gt;accept&lt;/b&gt;(CuratedApplication o, Map&amp;lt;String, Object&amp;gt; params) {&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; System.setProperty(&quot;java.nio.channels.DefaultThreadPool.threadFactory&quot;,&amp;nbsp;&lt;span style=&quot;background-color: initial;&quot;&gt;&quot;io.quarkus.dev.io.NioThreadPoolThreadFactory&quot;);&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; Timing.staticInitStarted(o.getOrCreateBaseRuntimeClassLoader(), false);&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; // 这个线程有什么意义？默认是非守护线程，应该是在shutdownLatch==0之前，用它避免进程退出&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; new Thread(new Runnable() {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; @Override&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; public void run() {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; try {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; shutdownLatch.await();&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; } catch (InterruptedException ignore) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }, &quot;Quarkus Devmode keep alive thread&quot;).start();&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; try {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; curatedApplication = o;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; Object potentialContext = params.get(DevModeContext.class.getName());&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if (potentialContext instanceof DevModeContext) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; context = (DevModeContext) potentialContext;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; } else {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; //this was from the external class loader we need to copy it into this one&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // 这里相当于实现深拷贝&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ByteArrayOutputStream out = new ByteArrayOutputStream();&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ObjectOutputStream oo = new ObjectOutputStream(out);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; oo.writeObject(potentialContext);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; context = (DevModeContext) new ObjectInputStream(new ByteArrayInputStream(out.toByteArray())).readObject();&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;augmentAction&lt;/b&gt; = new &lt;b&gt;AugmentActionImpl&lt;/b&gt;(curatedApplication,&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; List.of(new AddApplicationClassPredicateBuildStep()),&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; List.of());&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // code generators should be initialized before the runtime compilation is setup to properly configure the sources directories&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // 这块应该是为了支持热部署，比如修改了代码、资源、配置文件后能立即生效&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; codeGenWatcher = new CodeGenWatcher(curatedApplication, context);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; RuntimeUpdatesProcessor.INSTANCE = setupRuntimeCompilation(context, (Path) params.get(APP_ROOT),&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; (DevModeType) params.get(DevModeType.class.getName()));&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if (RuntimeUpdatesProcessor.INSTANCE != null) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; RuntimeUpdatesProcessor.INSTANCE.checkForFileChange();&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; RuntimeUpdatesProcessor.INSTANCE.checkForChangedClasses(true);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // 1 启动应用主线程（Quarkus Main Thread）&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;firstStart&lt;/b&gt;();&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;shutdownThread&lt;/b&gt; = new Thread(new Runnable() {&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ... 内部就是 shutdownLatch.countDown() 让前面的非守护线程退出；然后调用 close() 进行资源释放 ...&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }, &quot;Quarkus Shutdown Thread&quot;);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; Runtime.getRuntime().&lt;b&gt;addShutdownHook&lt;/b&gt;(shutdownThread);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; } catch (Exception e) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; RuntimeException toThrow = (e instanceof RuntimeException ? (RuntimeException) e : new RuntimeException(e));&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; try {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; close();&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; } catch (IllegalStateException x) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // not sure which is the most important, but let&#39;s not silence the original exception&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; toThrow.addSuppressed(x);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; throw toThrow;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;arcSize=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2200" y="120" width="680" height="740" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-23" value="&lt;b&gt;IsolatedDevModeMain&lt;/b&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="2465" y="90" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-27" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="JILRKh1KAr4Q8uxwXJQX-24" target="JILRKh1KAr4Q8uxwXJQX-26" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="3410" y="320" />
              <mxPoint x="3410" y="540" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-18" value="2" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="JILRKh1KAr4Q8uxwXJQX-27" vertex="1" connectable="0">
          <mxGeometry x="0.8513" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-19" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="JILRKh1KAr4Q8uxwXJQX-24" target="qXlFPTfgbzIKhoeTkRCt-17" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="3410" y="320" />
              <mxPoint x="3410" y="200" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-20" value="1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="qXlFPTfgbzIKhoeTkRCt-19" vertex="1" connectable="0">
          <mxGeometry x="0.7479" y="-1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-24" value="&lt;div&gt;private synchronized void &lt;b&gt;firstStart&lt;/b&gt;() {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ClassLoader old = Thread.currentThread().getContextClassLoader();&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; try {&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; //ok, we have resolved all the deps&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; try {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;font color=&quot;#007fff&quot;&gt;//this is a bit yuck, but we need replace the default&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; //exit handler in the runtime class loader&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; //TODO: look at implementing a common core classloader, that removes the need for this sort of crappy hack&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; curatedApplication.getOrCreateBaseRuntimeClassLoader()&lt;br&gt;&amp;nbsp;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;&amp;nbsp; &amp;nbsp; .loadClass(&lt;b&gt;ApplicationLifecycleManager&lt;/b&gt;.class.getName())&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .getMethod(&quot;setDefaultExitCodeHandler&quot;, Consumer.class)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .invoke(null, getExitCodeHandler());&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;font color=&quot;#007fff&quot;&gt;// 1 执行引导阶段 并 创建 StartupActionImpl 实例&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; StartupAction start = augmentAction.&lt;b&gt;createInitialRuntimeApplication&lt;/b&gt;();&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;&amp;nbsp; &amp;nbsp; // 2 开一个新线程（线程名：Quarkus Main Thread）执行用户自定义的 main() 方法或自动生成的 main() 方法&lt;/font&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; runner = start.&lt;b&gt;runMainClass&lt;/b&gt;(context.getArgs());&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; RuntimeUpdatesProcessor.INSTANCE&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .setConfiguredInstrumentationEnabled(&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; runner.getConfigValue(&quot;quarkus.live-reload.instrumentation&quot;, Boolean.class).orElse(false))&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .setLiveReloadEnabled(&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; runner.getConfigValue(&quot;quarkus.live-reload.enabled&quot;, Boolean.class).orElse(false));&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; firstStartCompleted = true;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;notifyListenersAfterStart&lt;/b&gt;();&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; } catch (Throwable t) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; } finally {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; Thread.currentThread().setContextClassLoader(old);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;arcSize=2;" parent="1" vertex="1">
          <mxGeometry x="2920" y="120" width="480" height="400" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-26" value="&lt;div&gt;&lt;font color=&quot;#330033&quot;&gt;,,,&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;// Quarkus应用“主类”默认是 io.quarkus.runner.&lt;b&gt;GeneratedMain&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;final String className = mainClassName;&amp;nbsp;&lt;/div&gt;&lt;div&gt;try {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; Class&amp;lt;?&amp;gt; appClass = Class.forName(className, true, runtimeClassLoader);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; Method &lt;b&gt;start&lt;/b&gt; = appClass.getMethod(&quot;&lt;b&gt;main&lt;/b&gt;&quot;, String[].class);&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; // 开新线程执行Quarkus应用&quot;主类&quot;的 main() 方法&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; Thread t = new Thread(new Runnable() {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; @Override&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; public void run() {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; Thread.currentThread().setContextClassLoader(runtimeClassLoader);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; try {&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // 执行main方法&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;start&lt;/b&gt;.&lt;b&gt;invoke&lt;/b&gt;(null, (Object) (args == null ? new String[0] : args));&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; } catch (Throwable e) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ApplicationStateNotification.notifyStartupFailed(e);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; } finally {&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ... 执行 runtimeApplicationShutdownBuildItems runtimeCloseTasks 中定义的关闭任务 ...&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }, &quot;&lt;b&gt;Quarkus Main Thread&lt;/b&gt;&quot;);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; t.&lt;b&gt;start&lt;/b&gt;();&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ApplicationStateNotification.&lt;b&gt;waitForApplicationStart&lt;/b&gt;();&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; return new RunningQuarkusApplicationImpl(new Closeable() {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }, runtimeClassLoader);&lt;/div&gt;&lt;div&gt;} catch (Throwable t) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; throw t;&lt;/div&gt;&lt;div&gt;} finally {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;arcSize=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="3440" y="320" width="440" height="440" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-57" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;endArrow=open;endFill=0;" parent="1" source="JILRKh1KAr4Q8uxwXJQX-33" target="POQSeShFetzR28v93gBQ-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-33" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;ApplicationLifecycleManager&lt;/b&gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;public static volatile ShutdownEvent.ShutdownReason shutdownReason;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private static final BiConsumer&amp;lt;Integer, Throwable&amp;gt; MAIN_EXIT_CODE_HANDLER;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private static final Consumer&amp;lt;Boolean&amp;gt; NOOP_ALREADY_STARTED_CALLBACK;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private static volatile BiConsumer&amp;lt;Integer, Throwable&amp;gt; defaultExitCodeHandler;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private static final String DISABLE_SIGNAL_HANDLERS = &quot;DISABLE_SIGNAL_HANDLERS&quot;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private static final Lock stateLock;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private static final Condition stateCond;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private static ShutdownHookThread shutdownHookThread;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private static int exitCode;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private static volatile boolean shutdownRequested;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private static volatile Application &lt;b&gt;currentApplication&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private static boolean vmShuttingDown;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private static Consumer&amp;lt;Boolean&amp;gt; alreadyStartedCallback;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private static final boolean IS_WINDOWS;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private static final boolean IS_MAC;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;public static final String QUARKUS_APPCDS_GENERATE_PROP = &quot;quarkus.appcds.generate&quot;;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="-520" y="1800" width="480" height="280" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-37" value="DevModeMain" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="450" y="90" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-38" value="&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;通过 @QuarkusMain 指定的主类的main方法&lt;br&gt;其实是一个假的程序入口，本身其实是一个普通方法&lt;br&gt;如果没有手动指定&quot;主类&quot;的话，Quarkus 会自动生成一个&lt;br&gt;&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="40" y="190" width="270" height="60" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-39" value="StartupActionImpl" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="3600" y="290" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-43" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;" parent="1" source="JILRKh1KAr4Q8uxwXJQX-40" target="JILRKh1KAr4Q8uxwXJQX-42" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-40" value="&lt;b style=&quot;font-size: 11px;&quot;&gt;GeneratedMain#main&lt;/b&gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;&lt;b&gt;Quarkus Main Thread 线程&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/b&gt;这个类在&lt;b style=&quot;font-size: 11px;&quot;&gt;MainClassBuildStep&lt;/b&gt; 中借助&lt;b style=&quot;font-size: 11px;&quot;&gt;ASM&lt;/b&gt;生成&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="280" y="920" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-49" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;" parent="1" source="JILRKh1KAr4Q8uxwXJQX-42" target="JILRKh1KAr4Q8uxwXJQX-48" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-50" value="..." style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=11;" parent="JILRKh1KAr4Q8uxwXJQX-49" vertex="1" connectable="0">
          <mxGeometry x="-0.0087" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-42" value="&lt;font color=&quot;#330033&quot; style=&quot;font-size: 11px;&quot;&gt;run(null, args);&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="520" y="920" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-45" value="&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;DevModeMain#main&lt;span style=&quot;background-color: initial; font-size: 11px;&quot;&gt;到 GeneratedMain#main&lt;/span&gt;&lt;span style=&quot;background-color: initial; font-size: 11px;&quot;&gt;之间的代码都是做一些组件初始化的工作，需要结合后面的处理逻辑才能理解清楚，&lt;br style=&quot;font-size: 11px;&quot;&gt;这部分代码不需要仔细看，后面用到什么组件再回头看。&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/span&gt;&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="40" y="360" width="360" height="60" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-46" value="&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;从源码看 GeneratedMain 中仅仅是生成了一个&lt;br&gt;&lt;b&gt;public static void main(String[] args)&lt;/b&gt; 方法，&lt;br&gt;&lt;b&gt;方法内部调用 Quarkus#run(String... args)&lt;/b&gt; 方法&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="280" y="980" width="240" height="60" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-47" value="Quarkus" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="586" y="890" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-52" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="JILRKh1KAr4Q8uxwXJQX-48" target="JILRKh1KAr4Q8uxwXJQX-51" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1240" y="2470" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1210" y="1120" />
              <mxPoint x="1210" y="2320" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-113" value="2" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="JILRKh1KAr4Q8uxwXJQX-52" vertex="1" connectable="0">
          <mxGeometry x="0.9501" relative="1" as="geometry">
            <mxPoint x="10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-111" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="JILRKh1KAr4Q8uxwXJQX-48" target="qXlFPTfgbzIKhoeTkRCt-110" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1210" y="1120" />
              <mxPoint x="1210" y="1140" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-112" value="1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="qXlFPTfgbzIKhoeTkRCt-111" vertex="1" connectable="0">
          <mxGeometry x="0.4098" y="-2" relative="1" as="geometry">
            <mxPoint y="-2" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-48" value="&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#330033&quot; style=&quot;font-size: 10px;&quot;&gt;public static void &lt;b&gt;run&lt;/b&gt;(Class&amp;lt;? extends QuarkusApplication&amp;gt; &lt;b&gt;quarkusApplication&lt;/b&gt;, &lt;br&gt;&amp;nbsp; &amp;nbsp; &lt;span style=&quot;&quot;&gt;&lt;span style=&quot;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;BiConsumer&amp;lt;Integer, Throwable&amp;gt; exitHandler,&lt;/font&gt;&lt;span style=&quot;color: rgb(51, 0, 51); background-color: initial;&quot;&gt;&amp;nbsp;String... args) {&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#330033&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; try {&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#330033&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/font&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt; &amp;nbsp; ... 设置三个系统属性: &quot;jboss.log-version&quot;、&quot;java.util.logging.manager&quot;、&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &quot;java.util.concurrent.ForkJoinPool.common.threadFactory&quot; ...&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#330033&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp;&lt;/font&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt; &amp;nbsp; &amp;nbsp; //production and common dev mode path&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; //we already have an application, run it directly&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; //加载 io.quarkus.runner.ApplicationImpl 并实例化，ApplicationImpl 同样是Gizmo生成的&lt;br&gt;&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; //在 MainClassBuildStep#build() 方法中生成，这个类内容相对就复杂一些&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#330033&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; Class&amp;lt;? extends Application&amp;gt; appClass = (Class&amp;lt;? extends Application&amp;gt;) Class.forName(&lt;br&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;&amp;nbsp; &amp;nbsp; Application.&lt;b&gt;APP_CLASS_NAME&lt;/b&gt;,&lt;/font&gt;&lt;span style=&quot;color: rgb(51, 0, 51); background-color: initial;&quot;&gt;&amp;nbsp;false, Thread.currentThread().getContextClassLoader());&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#330033&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/font&gt;&lt;b style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;// 1&lt;/font&gt;&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#330033&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; Application &lt;b&gt;application&lt;/b&gt; = appClass.getDeclaredConstructor().&lt;b&gt;newInstance&lt;/b&gt;();&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // 2&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#330033&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;ApplicationLifecycleManager&lt;/b&gt;.&lt;b&gt;run&lt;/b&gt;(&lt;b&gt;application&lt;/b&gt;, &lt;b&gt;quarkusApplication&lt;/b&gt;, exitHandler, args);&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#330033&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; return;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#330033&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; } catch (ClassNotFoundException e) {&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#330033&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; } catch (Exception e) {&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#330033&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if (exitHandler != null) {&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#330033&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; exitHandler.accept(1, e);&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#330033&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; } else {&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#330033&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; Logger.getLogger(Quarkus.class).error(&quot;Error running Quarkus&quot;, e);&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#330033&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ApplicationLifecycleManager.getDefaultExitCodeHandler().accept(1, e);&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#330033&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#330033&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; return;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#330033&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; }&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#330033&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp;&lt;/font&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt; &amp;nbsp; //dev mode path, i.e. launching from the IDE&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; //this is not the quarkus:dev path as it will augment before&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; //calling this method&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#330033&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; launchFromIDE(quarkusApplication, args);&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#330033&quot; style=&quot;font-size: 10px;&quot;&gt;}&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;fontSize=10;arcSize=2;" parent="1" vertex="1">
          <mxGeometry x="760" y="920" width="440" height="400" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-54" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#007FFF;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="JILRKh1KAr4Q8uxwXJQX-51" target="JILRKh1KAr4Q8uxwXJQX-53" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1689" y="2320" />
              <mxPoint x="1689" y="2381" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="POQSeShFetzR28v93gBQ-57" value="1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="JILRKh1KAr4Q8uxwXJQX-54" vertex="1" connectable="0">
          <mxGeometry x="-0.9772" y="-2" relative="1" as="geometry">
            <mxPoint x="18" y="69" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-14" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="JILRKh1KAr4Q8uxwXJQX-51" target="qXlFPTfgbzIKhoeTkRCt-73" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1689" y="2321" />
              <mxPoint x="1689" y="3291" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-15" value="4" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="qXlFPTfgbzIKhoeTkRCt-14" vertex="1" connectable="0">
          <mxGeometry x="-0.036" y="2" relative="1" as="geometry">
            <mxPoint x="8" y="493" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-64" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="JILRKh1KAr4Q8uxwXJQX-51" target="qXlFPTfgbzIKhoeTkRCt-63" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1689" y="2320" />
              <mxPoint x="1689" y="2871" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-65" value="2" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="qXlFPTfgbzIKhoeTkRCt-64" vertex="1" connectable="0">
          <mxGeometry x="0.9539" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-74" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="JILRKh1KAr4Q8uxwXJQX-51" target="qXlFPTfgbzIKhoeTkRCt-13" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1689" y="2320" />
              <mxPoint x="1689" y="3051" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-75" value="3" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="qXlFPTfgbzIKhoeTkRCt-74" vertex="1" connectable="0">
          <mxGeometry x="0.9512" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-51" value="&lt;div style=&quot;&quot;&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;public static void run(Application &lt;b&gt;application&lt;/b&gt;, &lt;br&gt;&lt;span style=&quot;&quot;&gt;&lt;span style=&quot;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;Class&amp;lt;? extends QuarkusApplication&amp;gt;&amp;nbsp;quarkusApplication, &lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;//通过@QuarkusMain指定的主类&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; BiConsumer&amp;lt;Integer, Throwable&amp;gt; exitCodeHandler, String... args) {&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; boolean alreadyStarted;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ... 检查 currentApplication 是否已经启动已经启动的话抛异常 ...&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; try {&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // 1 这里 application 是 ApplicationImpl 实例，实际是调用 Application#start() 方法&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // start() 方法内部调用 ApplicationImpl doStart() 方法&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;application&lt;/b&gt;.&lt;b&gt;start&lt;/b&gt;(args);&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;if&lt;/b&gt; (quarkusApplication != null &amp;amp;&amp;amp; !&lt;b&gt;isAppCDSGeneration&lt;/b&gt;()) {&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; BeanManager beanManager = CDI.current().getBeanManager();&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;span style=&quot;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;// 2 从 BeanManager 获取 @QuarkusMain 指定的主类对应的 Bean&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; Set&amp;lt;Bean&amp;lt;?&amp;gt;&amp;gt; &lt;b&gt;beans&lt;/b&gt; = &lt;b&gt;beanManager&lt;/b&gt;.getBeans(&lt;b&gt;quarkusApplication&lt;/b&gt;, Any.Literal.INSTANCE);&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ... 从beans中获取第一个bean ...&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; QuarkusApplication instance;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if (bean == null) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; instance = quarkusApplication.getDeclaredConstructor().newInstance();&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; } else {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; CreationalContext&amp;lt;?&amp;gt; ctx = beanManager.createCreationalContext(bean);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;// 3 通过 BeanManager 获取Bean实际对象的代理引用，这里实际是返回的第一层代理&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;instance&lt;/b&gt; = (QuarkusApplication) beanManager.&lt;b&gt;getReference&lt;/b&gt;(bean, quarkusApplication, ctx);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; int result = -1;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; try {&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // 4 执行 @QuarkusMain 指定的主类方法&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; result = &lt;b&gt;instance&lt;/b&gt;.&lt;b&gt;run&lt;/b&gt;(args);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; } finally {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&amp;nbsp;&lt;b&gt;else&lt;/b&gt; {&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;longLivedPostBootCleanup();&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; stateLock.lock();&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; try {&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;while&lt;/b&gt; (!&lt;b&gt;shutdownRequested&lt;/b&gt;) { &lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;// Quarkus Main Thread 进入轮询等待&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; Thread.interrupted();&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; stateCond.&lt;b&gt;awaitUninterruptibly&lt;/b&gt;();&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; } finally {&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; stateLock.unlock();&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; } catch (Exception e) {&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; return;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; } finally {&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ...&lt;br&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;span style=&quot;&quot;&gt;&lt;span style=&quot;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;Runtime.getRuntime().removeShutdownHook(sh);&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if (!alreadyStarted) {&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; application.stop(); //this could have already been called&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; currentApplication = null;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; (exitCodeHandler == null ? defaultExitCodeHandler : exitCodeHandler)&lt;br&gt;&lt;span style=&quot;&quot;&gt;&lt;span style=&quot;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&amp;nbsp; &amp;nbsp; .accept(getExitCode(), null);&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;fontSize=10;arcSize=2;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="1240" y="1960" width="440" height="721" as="geometry" />
        </mxCell>
        <mxCell id="JILRKh1KAr4Q8uxwXJQX-53" value="&lt;div style=&quot;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;div style=&quot;&quot;&gt;protected final void doStart(String[] var1) {&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; System.setProperty(&quot;logging.initial-configurator.min-level&quot;, &quot;500&quot;);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; System.setProperty(&quot;java.util.concurrent.ForkJoinPool.common.threadFactory&quot;,&amp;nbsp;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &quot;io.quarkus.bootstrap.forkjoin.QuarkusForkJoinWorkerThreadFactory&quot;);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; System.setProperty(&quot;java.util.logging.manager&quot;, &quot;org.jboss.logmanager.LogManager&quot;);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; //&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;b&gt;NativeImageRuntimePropertiesRecorder&lt;/b&gt;.doRuntime();&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; //&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; ExecutionModeManager.runtimeInit();&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; Timing.mainStarted();&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; StartupContext var2 = STARTUP_CONTEXT;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; var2.setCommandLineArguments(var1);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; // 通过 StepTiming 记录每一步的耗时&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; StepTiming.configureEnabled();&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; try {&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; StepTiming.configureStart();&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;font color=&quot;#007fff&quot;&gt; //&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ((StartupTask)(new RuntimeConfigSetup())).deploy(var2);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; StepTiming.printStepTime(var2);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; //&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ((StartupTask)(new ConfigGenerationBuildStep.releaseConfigOnShutdown561040398())).deploy(var2);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; StepTiming.printStepTime(var2);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; //&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ((StartupTask)(new ConfigGenerationBuildStep.checkForBuildTimeConfigChange1532146938())).deploy(var2);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; StepTiming.printStepTime(var2);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ((StartupTask)(new BannerProcessor.recordBanner921118789())).deploy(var2);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; StepTiming.printStepTime(var2);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; //&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ((StartupTask)(new ThreadPoolSetup.createExecutor2117483448())).deploy(var2);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; StepTiming.printStepTime(var2);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; //&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ((StartupTask)(new ArcProcessor.setupExecutor1831044820())).deploy(var2);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; StepTiming.printStepTime(var2);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; //&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ((StartupTask)(new ConfigGenerationBuildStep.unknownConfigFiles604069353())).deploy(var2);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; StepTiming.printStepTime(var2);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ((StartupTask)(new LoggingResourceProcessor.setupLoggingRuntimeInit1041640541())).deploy(var2);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; StepTiming.printStepTime(var2);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ((StartupTask)(new ShutdownListenerBuildStep.setupShutdown1533204416())).deploy(var2);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; StepTiming.printStepTime(var2);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; //&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ((StartupTask)(new SyntheticBeansProcessor.initRuntime975230615())).deploy(var2);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; StepTiming.printStepTime(var2);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; //&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ((StartupTask)(new InitializationTaskProcessor.startApplicationInitializer180820092())).deploy(var2);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; StepTiming.printStepTime(var2);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; //&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ((StartupTask)(new ConfigBuildStep.validateRuntimeConfigProperty1282080724())).deploy(var2);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; StepTiming.printStepTime(var2);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ((StartupTask)(new ConfigBuildStep.registerConfigClasses1377682816())).deploy(var2);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; StepTiming.printStepTime(var2);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ((StartupTask)(new LifecycleEventsBuildStep.startupEvent1144526294())).deploy(var2);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; StepTiming.printStepTime(var2);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; //&amp;nbsp;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ExecutionModeManager.running();&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; List var3 = ConfigUtils.getProfiles();&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; Timing.printStartupTime(&quot;quarkus-010-smallest-system&quot;, &quot;1.0-SNAPSHOT&quot;, &quot;3.17.6&quot;, &quot;cdi&quot;, var3, false, false);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; //&amp;nbsp;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; QuarkusConsole.start();&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; } catch (PreventFurtherStepsException var8) {&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; var2.close();&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; } catch (Throwable var9) {&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; QuarkusDelayedHandler var6 = InitialConfigurator.DELAYED_HANDLER;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if (!var6.isActivated()) {&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; Handler[] var4 = new Handler[1];&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ConsoleHandler var5 = new ConsoleHandler();&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; var4[0] = (Handler)var5;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; var6.setHandlers(var4);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; var2.close();&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; throw (Throwable)(new RuntimeException(&quot;Failed to start quarkus&quot;, var9));&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div style=&quot;&quot;&gt;}&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;fontSize=9;arcSize=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="1718.5" y="1961" width="440" height="840" as="geometry" />
        </mxCell>
        <mxCell id="POQSeShFetzR28v93gBQ-1" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;ApplicationImpl&amp;nbsp;&lt;/b&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;extends Application&lt;/span&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;真正的应用实例，是在 MainClassBuildStep#build() 中生成的类，&lt;br&gt;&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;Files.write(Path.of(&quot;/tmp/&quot; + &quot;ApplicationImpl&quot; +&quot;.class&quot;),getClass().getClassLoader()&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;.getResourceAsStream(getClass().getName().replace(&quot;.&quot;,&quot;/&quot;)+&quot;.class&quot;).readAllBytes())&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;public static StartupContext STARTUP_CONTEXT;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private static final String __QUARKUS_ANALYTICS_QUARKUS_VERSION;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;protected final void &lt;b&gt;doStart&lt;/b&gt;(String[] var1)&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;protected final void &lt;b&gt;doStop&lt;/b&gt;()&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#fad7ac;strokeColor=#b46504;" parent="1" vertex="1">
          <mxGeometry x="-1040" y="1800" width="480" height="160" as="geometry" />
        </mxCell>
        <mxCell id="POQSeShFetzR28v93gBQ-3" value="ApplicationImpl" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="1888.5" y="1930" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-72" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;endArrow=blockThin;endFill=1;dashed=1;" parent="1" source="POQSeShFetzR28v93gBQ-27" target="POQSeShFetzR28v93gBQ-28" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="POQSeShFetzR28v93gBQ-27" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;ArcContainerImpl&lt;/b&gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;Quarkus Bean 容器, Qurakus Bean 并不是原类型的实例而是一个代理&lt;/font&gt;&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private static final AtomicInteger ID_GENERATOR = new AtomicInteger();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final String id;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final AtomicBoolean running;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;// 所有可注入Bean实例&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final List&amp;lt;InjectableBean&amp;lt;?&amp;gt;&amp;gt; &lt;b&gt;beans&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;// 通过类型分类的 Bean Map&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Map&amp;lt;String, List&amp;lt;InjectableBean&amp;lt;?&amp;gt;&amp;gt;&amp;gt; &lt;b&gt;beansByRawType&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final LazyValue&amp;lt;List&amp;lt;RemovedBean&amp;gt;&amp;gt; &lt;b&gt;removedBeans&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final List&amp;lt;InjectableInterceptor&amp;lt;?&amp;gt;&amp;gt; &lt;b&gt;interceptors&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final List&amp;lt;InjectableDecorator&amp;lt;?&amp;gt;&amp;gt; &lt;b&gt;decorators&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final List&amp;lt;InjectableObserverMethod&amp;lt;?&amp;gt;&amp;gt; observers;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Contexts &lt;b&gt;contexts&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ComputingCache&amp;lt;Resolvable, Set&amp;lt;InjectableBean&amp;lt;?&amp;gt;&amp;gt;&amp;gt; &lt;b&gt;resolved&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;// Bean ID -&amp;gt; Bean&lt;/font&gt;&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ComputingCache&amp;lt;String, InjectableBean&amp;lt;?&amp;gt;&amp;gt; &lt;b&gt;beansById&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ComputingCache&amp;lt;String, Set&amp;lt;InjectableBean&amp;lt;?&amp;gt;&amp;gt;&amp;gt; &lt;b&gt;beansByName&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ArrayList&amp;lt;ResourceReferenceProvider&amp;gt; resourceProviders;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;final InstanceImpl&amp;lt;Object&amp;gt; &lt;b&gt;instance&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;final Qualifiers registeredQualifiers;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;final InterceptorBindings registeredInterceptorBindings;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile ExecutorService executorService;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final CurrentContextFactory currentContextFactory;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final boolean strictMode;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#fad7ac;strokeColor=#b46504;" parent="1" vertex="1">
          <mxGeometry x="-1560" y="1920" width="480" height="380" as="geometry" />
        </mxCell>
        <mxCell id="POQSeShFetzR28v93gBQ-28" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;ArcContainer&lt;/b&gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="-1560" y="1800" width="480" height="80" as="geometry" />
        </mxCell>
        <mxCell id="POQSeShFetzR28v93gBQ-58" value="&lt;b&gt;ApplicationLifecycleManager&lt;/b&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="885" y="890" width="190" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-2" value="&lt;div&gt;public CuratedApplication bootstrap() throws BootstrapException {&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; // existingModel 默认为 null, 这是会加载应用目录 quarkus/bootstrap/dev-app-model.dat&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; // 将其反序列化为 ApplicationModel&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; final CurationResult curationResult = existingModel != null&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ? new CurationResult(existingModel)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; : newAppModelFactory().resolveAppModel();&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; // 从 ApplicationModel 拷贝两个 build 系统属性到 buildSystemProperties&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; final ConfiguredClassLoading classLoadingConfig = ConfiguredClassLoading.builder()&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .setApplicationRoot(applicationRoot)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .setDefaultFlatTestClassPath(defaultFlatTestClassPath)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .setMode(mode)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .addParentFirstArtifacts(parentFirstArtifacts)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .setApplicationModel(curationResult.getApplicationModel())&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .build();&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; return new &lt;b&gt;CuratedApplication&lt;/b&gt;(this, curationResult, classLoadingConfig);&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;arcSize=4;" parent="1" vertex="1">
          <mxGeometry x="1240.5" y="120" width="440" height="220" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-6" value="&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;b style=&quot;font-size: 11px;&quot;&gt;curatedApplication&lt;/b&gt; = {CuratedApplication@2035}&amp;nbsp;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp;augmentationElements = {HashMap@2038}&amp;nbsp; size = 0&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp;augmentClassLoader = null&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp;baseRuntimeClassLoader = null&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp;quarkusBootstrap = {QuarkusBootstrap@1761}&amp;nbsp;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp;curationResult = {CurationResult@1892}&amp;nbsp;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp; appModel = {DefaultApplicationModel@1889}&amp;nbsp;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp;configuredClassLoading = {ConfiguredClassLoading@1964}&amp;nbsp;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp; parentFirstArtifacts = {HashSet@1968}&amp;nbsp; size = 28&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp; &amp;nbsp;0 = {GACT@1974} &quot;io.smallrye.common:smallrye-common-expression::jar&quot;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp; &amp;nbsp;1 = {GACT@1975} &quot;org.graalvm.sdk:word::jar&quot;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp; &amp;nbsp;2 = {GACT@1976} &quot;io.smallrye.common:smallrye-common-constraint::jar&quot;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp; &amp;nbsp;3 = {GACT@1977} &quot;org.junit.jupiter:junit-jupiter-params::jar&quot;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp; &amp;nbsp;4 = {GACT@1978} &quot;io.smallrye.common:smallrye-common-ref::jar&quot;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp; &amp;nbsp;5 = {GACT@1979} &quot;org.slf4j:slf4j-api::jar&quot;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp; &amp;nbsp;6 = {GACT@1980} &quot;io.quarkus:quarkus-class-change-agent::jar&quot;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp; &amp;nbsp;...&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp; reloadableArtifacts = {HashSet@1969}&amp;nbsp; size = 0&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp; removedArtifacts = {HashSet@1970}&amp;nbsp; size = 0&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp; removedResources = {HashMap@1971}&amp;nbsp; size = 0&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp; flatTestClassPath = false&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp; additionalPaths = {ImmutableCollections$ListN@1972}&amp;nbsp; size = 0&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp;appModel = {DefaultApplicationModel@1889}&amp;nbsp;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp; appArtifact = {ResolvedArtifactDependency@1918}&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp; dependencies = {ArrayList@1919}&amp;nbsp; size = 77&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp; platformImports = {PlatformImportsImpl@1920}&amp;nbsp;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp; capabilityContracts = {ImmutableCollections$List12@1921}&amp;nbsp; size = 1&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp; localProjectArtifacts = {ImmutableCollections$Set12@1922}&amp;nbsp; size = 1&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp; excludedResources = {ConcurrentHashMap@1923}&amp;nbsp; size = 0&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp;runtimeClassLoaderCount = {AtomicInteger@2039} &quot;0&quot;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontColor=#007FFF;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="-1480" y="550" width="400" height="410" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-11" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;endArrow=blockThin;endFill=1;strokeColor=none;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-8" target="qXlFPTfgbzIKhoeTkRCt-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-12" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;dashed=1;endArrow=blockThin;endFill=1;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-8" target="qXlFPTfgbzIKhoeTkRCt-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-8" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;StartupActionImpl&lt;/b&gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;定义 Quarkus 应用启动操作&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final CuratedApplication &lt;b&gt;curatedApplication&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final QuarkusClassLoader runtimeClassLoader;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final String &lt;b&gt;mainClassName&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final String &lt;b&gt;applicationClassName&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Map&amp;lt;String, String&amp;gt; devServicesProperties;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final List&amp;lt;RuntimeApplicationShutdownBuildItem&amp;gt; runtimeApplicationShutdownBuildItems;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final List&amp;lt;Closeable&amp;gt; runtimeCloseTasks = new ArrayList&amp;lt;&amp;gt;();&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="-1040" y="1160" width="480" height="200" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-9" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;StartupAction&lt;/b&gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;void overrideConfig(Map&amp;lt;String, String&amp;gt; config);&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;RunningQuarkusApplication run(String... args) throws Exception;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;RunningQuarkusApplication runMainClass(String... args) throws Exception;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;int runMainClassBlocking(String... args) throws Exception;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;void addRuntimeCloseTask(Closeable closeTask);&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="-1040" y="1000" width="480" height="120" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-77" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-13" target="qXlFPTfgbzIKhoeTkRCt-76" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-80" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-13" target="qXlFPTfgbzIKhoeTkRCt-79" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2179" y="3051" />
              <mxPoint x="2179" y="3201" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-13" value="&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;div&gt;&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;获取Bean代理的类的实例引用&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;public Object &lt;b&gt;getReference&lt;/b&gt;(Bean&amp;lt;?&amp;gt; bean, Type beanType, CreationalContext&amp;lt;?&amp;gt; ctx) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; if (!BeanTypeAssignabilityRules.instance().matches(beanType, bean.getTypes())) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; throw new IllegalArgumentException(...);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; if (bean instanceof InjectableBean &amp;amp;&amp;amp; ctx instanceof CreationalContextImpl) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; InjectionPoint prev = InjectionPointProvider.setCurrent(ctx, null);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; try {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; return &lt;b&gt;ArcContainerImpl&lt;/b&gt;.&lt;b&gt;beanInstanceHandle&lt;/b&gt;((InjectableBean) &lt;b&gt;bean&lt;/b&gt;, &lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(CreationalContextImpl) ctx,&amp;nbsp;&lt;span style=&quot;background-color: initial;&quot;&gt;false, null, true).&lt;b&gt;get&lt;/b&gt;();&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; } finally {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; InjectionPointProvider.setCurrent(ctx, prev);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; throw new IllegalArgumentException(...);&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;fontSize=10;arcSize=3;" parent="1" vertex="1">
          <mxGeometry x="1719" y="2941" width="440" height="220" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-52" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;endArrow=open;endFill=0;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-16" target="qXlFPTfgbzIKhoeTkRCt-51" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-16" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;BuildContext&lt;/b&gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ClassLoader classLoader;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final StepInfo &lt;b&gt;stepInfo&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Execution &lt;b&gt;execution&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final AtomicInteger dependencies;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile boolean running;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="-520" y="1440" width="480" height="160" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-22" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-17" target="qXlFPTfgbzIKhoeTkRCt-25" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="3920" y="200" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-17" value="&lt;div&gt;public StartupActionImpl createInitialRuntimeApplication() {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; if (launchMode == LaunchMode.NORMAL) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; throw new IllegalStateException(&quot;Cannot launch a runtime application with NORMAL launch mode&quot;);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; try (QuarkusClassLoader classLoader = curatedApplication.createDeploymentClassLoader()) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; @SuppressWarnings(&quot;unchecked&quot;)&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // 执行增强&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; BuildResult result = &lt;b&gt;runAugment&lt;/b&gt;(true, Collections.emptySet(), null, classLoader, &lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; NON_NORMAL_MODE_OUTPUTS);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; return new &lt;b&gt;StartupActionImpl&lt;/b&gt;(curatedApplication, result);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;arcSize=3;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="3440" y="120" width="440" height="160" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-24" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-25" target="qXlFPTfgbzIKhoeTkRCt-31" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-25" value="&lt;div&gt;QuarkusAugmentor.Builder builder = QuarkusAugmentor.builder()&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; .setRoot(quarkusBootstrap.getApplicationRoot())&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; .setClassLoader(classLoader)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; .setTargetDir(quarkusBootstrap.getTargetDirectory())&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; .setDeploymentClassLoader(deploymentClassLoader)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; .setBuildSystemProperties(quarkusBootstrap.getBuildSystemProperties())&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; .setRuntimeProperties(quarkusBootstrap.getRuntimeProperties())&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; .setEffectiveModel(curatedApplication.getApplicationModel())&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; .setDependencyInfoProvider(quarkusBootstrap.getDependencyInfoProvider());&lt;/div&gt;&lt;div&gt;...&lt;/div&gt;&lt;div&gt;builder.&lt;b&gt;build&lt;/b&gt;().&lt;b&gt;run&lt;/b&gt;();&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;arcSize=4;" parent="1" vertex="1">
          <mxGeometry x="3920" y="130" width="440" height="140" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-26" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-31" target="qXlFPTfgbzIKhoeTkRCt-34" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="5100" y="640" />
              <mxPoint x="5100" y="480" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-27" value="..." style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="qXlFPTfgbzIKhoeTkRCt-26" vertex="1" connectable="0">
          <mxGeometry x="0.0848" y="-1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-28" value="2" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="qXlFPTfgbzIKhoeTkRCt-26" vertex="1" connectable="0">
          <mxGeometry x="0.9273" relative="1" as="geometry">
            <mxPoint x="-3" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-29" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-31" target="qXlFPTfgbzIKhoeTkRCt-41" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="5090" y="640" />
              <mxPoint x="5090" y="190" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-30" value="1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="qXlFPTfgbzIKhoeTkRCt-29" vertex="1" connectable="0">
          <mxGeometry x="0.9148" y="-3" relative="1" as="geometry">
            <mxPoint x="-450" y="-3" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-31" value="&lt;div&gt;public BuildResult run() throws Exception {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;QuarkusBuildCloseablesBuildItem buildCloseables = new QuarkusBuildCloseablesBuildItem();&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; // 加载所有 BuildItem 创建 BuildChain&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; final BuildChainBuilder &lt;b&gt;chainBuilder&lt;/b&gt; = BuildChain.builder();&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; chainBuilder.setClassLoader(deploymentClassLoader);&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; // 1&amp;nbsp;&lt;/font&gt;&lt;font color=&quot;#007fff&quot;&gt;先加载 BuildStep， 然后 accept() 中执行 produce() 后生成 BuildItem 实例，并存储到 BuildContext .execution，&lt;/font&gt;&lt;span style=&quot;color: rgb(0, 127, 255); background-color: initial;&quot;&gt;ItemId -&amp;gt; BuildItem&lt;/span&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ExtensionLoader.&lt;b&gt;loadStepsFrom&lt;/b&gt;(deploymentClassLoader,&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; buildSystemProperties == null ? new Properties() : buildSystemProperties,&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; runtimeProperties == null ? new Properties() : runtimeProperties,&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; effectiveModel, launchMode, devModeType)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .accept(chainBuilder);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; Thread.currentThread().setContextClassLoader(classLoader);&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; // 2 SPI 加载 BuildProvider 然后从 BuildProvider 中加载 BuildStep&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;b&gt;chainBuilder&lt;/b&gt;.&lt;b&gt;loadProviders&lt;/b&gt;(classLoader);&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; // 3 一些固化的 BuildItem&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;b&gt;chainBuilder&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .&lt;b&gt;addInitial&lt;/b&gt;(QuarkusBuildCloseablesBuildItem.class)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .addInitial(ArchiveRootBuildItem.class)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .addInitial(ShutdownContextBuildItem.class)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .addInitial(RawCommandLineArgumentsBuildItem.class)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .addInitial(LaunchModeBuildItem.class)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .addInitial(LiveReloadBuildItem.class)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .addInitial(AdditionalApplicationArchiveBuildItem.class)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .addInitial(CuratedApplicationShutdownBuildItem.class)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .addInitial(BuildSystemTargetBuildItem.class)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .addInitial(AppModelProviderBuildItem.class);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;// 4&amp;nbsp;&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; for (Class&amp;lt;? extends BuildItem&amp;gt; i : &lt;b&gt;finalResults&lt;/b&gt;) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;chainBuilder&lt;/b&gt;.addFinal(i);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; // 5&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; for (Consumer&amp;lt;BuildChainBuilder&amp;gt; i : &lt;b&gt;buildChainCustomizers&lt;/b&gt;) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; i.accept(&lt;b&gt;chainBuilder&lt;/b&gt;);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;font color=&quot;#007fff&quot;&gt;// 6&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; if (launchMode.isDevOrTest()) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;chainBuilder&lt;/b&gt;.addFinal(&lt;b&gt;RuntimeApplicationShutdownBuildItem&lt;/b&gt;.class);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; final ArchiveRootBuildItem.Builder rootBuilder = ArchiveRootBuildItem.builder();&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; if (root != null) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; rootBuilder.addArchiveRoots(root);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; rootBuilder.setExcludedFromIndexing(excludedFromIndexing);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; BuildChain &lt;b&gt;chain&lt;/b&gt; = chainBuilder.&lt;b&gt;build&lt;/b&gt;();&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;b&gt;BuildExecutionBuilder&lt;/b&gt; &lt;b&gt;execBuilder&lt;/b&gt; = &lt;b&gt;chain&lt;/b&gt;.createExecutionBuilder(baseName)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .produce(buildCloseables)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .produce(liveReloadBuildItem)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .produce(&lt;b&gt;rootBuilder&lt;/b&gt;.build(buildCloseables))&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .produce(new ShutdownContextBuildItem())&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .produce(new RawCommandLineArgumentsBuildItem())&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .produce(new CuratedApplicationShutdownBuildItem((QuarkusClassLoader) deploymentClassLoader.getParent(),&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; !liveReloadBuildItem.isLiveReload()))&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .produce(new LaunchModeBuildItem(launchMode,&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; devModeType == null ? Optional.empty() : Optional.of(devModeType), auxiliaryApplication,&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; auxiliaryDevModeType, test))&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .produce(new BuildSystemTargetBuildItem(targetDir, baseName, originalBaseName, rebuild,&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; buildSystemProperties == null ? new Properties() : buildSystemProperties))&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .produce(new AppModelProviderBuildItem(effectiveModel, depInfoProvider));&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; for (PathCollection i : additionalApplicationArchives) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; execBuilder.produce(new AdditionalApplicationArchiveBuildItem(i));&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;font style=&quot;&quot; color=&quot;#007fff&quot;&gt;&lt;b&gt;// 7 使用 EnhancedQueueExecutor 线程池执行BuildChain中 startSteps 任务，注册 BuildItem&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; BuildResult &lt;b&gt;buildResult&lt;/b&gt; = &lt;b&gt;execBuilder&lt;/b&gt;.&lt;b&gt;execute&lt;/b&gt;();&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; String message = &quot;Quarkus augmentation completed in &quot; + TimeUnit.NANOSECONDS.toMillis(System.nanoTime() - start)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; + &quot;ms&quot;;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; if (launchMode == LaunchMode.NORMAL) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; log.info(message);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if (Boolean.parseBoolean(System.getProperty(&quot;quarkus.debug.dump-build-metrics&quot;))) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; buildResult.getMetrics().dumpTo(targetDir.resolve(&quot;build-metrics.json&quot;));&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; } else {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; //test and dev mode already report the total startup time, no need to add noise to the logs&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; log.debug(message);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // Dump the metrics in the dev mode but not remote-dev (as it could cause issues with container permissions)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if ((launchMode == LaunchMode.DEVELOPMENT) &amp;amp;&amp;amp; !LaunchMode.isRemoteDev()) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; buildResult.getMetrics().dumpTo(targetDir.resolve(&quot;build-metrics.json&quot;));&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; return buildResult;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;arcSize=1;" parent="1" vertex="1">
          <mxGeometry x="4400" y="120" width="680" height="1040" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-32" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-34" target="qXlFPTfgbzIKhoeTkRCt-38" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-33" value="..." style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="qXlFPTfgbzIKhoeTkRCt-32" vertex="1" connectable="0">
          <mxGeometry x="-0.3" y="-3" relative="1" as="geometry">
            <mxPoint x="6" y="-3" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-34" value="&lt;div&gt;BuildResult run() throws BuildException {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; final List&amp;lt;StepInfo&amp;gt; startSteps = chain.getStartSteps();&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; for (StepInfo startStep : &lt;b&gt;startSteps&lt;/b&gt;) {&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; // 执行增强任务（BuildStep），通过 executor 线程池中 build-x 线程执行&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // execute() 内部将 BuildContext#run() 任务封装了，不过最终还是要执行到这个run方法的&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; executor.&lt;b&gt;execute&lt;/b&gt;(getBuildContext(startStep)::run);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; //主线程阻塞等待所有构建线程执行完毕&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; executor.shutdown();&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div&gt;}&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;arcSize=3;" parent="1" vertex="1">
          <mxGeometry x="5120" y="380" width="440" height="200" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-35" value="QuarkusAugmentor" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="4675" y="90" width="130" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-36" value="Execution" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="5300" y="350" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-37" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-38" target="qXlFPTfgbzIKhoeTkRCt-41" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="6060" y="480" />
              <mxPoint x="6060" y="280" />
              <mxPoint x="5580" y="280" />
              <mxPoint x="5580" y="225" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-38" value="&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;// build-x 线程中执行&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;void run() {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; final Execution execution = this.execution;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; final StepInfo stepInfo = this.stepInfo;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; final BuildStep buildStep = stepInfo.getBuildStep();&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; log.tracef(&quot;Starting step \&quot;%s\&quot;&quot;, buildStep);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; try {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if (!execution.isErrorReported()) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;buildStep&lt;/b&gt;.&lt;b&gt;execute&lt;/b&gt;(this);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; } finally {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; execution.removeBuildContext(stepInfo, this);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; final Set&amp;lt;StepInfo&amp;gt; dependents = stepInfo.getDependents();&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; if (!dependents.isEmpty()) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; for (StepInfo info : &lt;b&gt;dependents&lt;/b&gt;) {&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;&amp;nbsp; &amp;nbsp; // 如果这个构建步骤依赖其他构建步骤，则加载依赖的步骤&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; execution.getBuildContext(info).depFinished();&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; } else {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; execution.depFinished();&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;arcSize=2;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="5600" y="310" width="440" height="340" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-39" value="BuildContext" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="5775" y="280" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-41" value="&lt;font color=&quot;#007fff&quot;&gt;// loadStepsFrom() 加载的 BuildStep 来源有 &lt;b&gt;META-INF/quarkus-build-steps.list&lt;/b&gt;、还有&lt;b&gt;固化到程序中的BuildStep &lt;/b&gt;(比如ConfigurationBuildItem、BytecodeRecorderObjectLoaderBuildItem 等等)&lt;br&gt;// loadStepsFromClass()&amp;nbsp;&amp;nbsp;&lt;br&gt;&lt;/font&gt;&lt;br&gt;...&lt;br&gt;&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;// 通过 MethodHandle 调用 @BuildStep 方法&lt;/font&gt;&lt;br&gt;&lt;/b&gt;result = methodHandle.bindTo(instance).&lt;b&gt;invokeWithArguments&lt;/b&gt;(methodArgs);&lt;br&gt;...&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;// 有些 @BuildStep 方法会返回 BuildItem 实例，存储到 BuildContext .execution&lt;br&gt;&lt;/font&gt;resultConsumer.accept(bc, result);" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;arcSize=2;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="5600" y="120" width="440" height="140" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-42" value="ExtensionLoader" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="5765" y="90" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-43" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-44" target="qXlFPTfgbzIKhoeTkRCt-47" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-44" value="&lt;b&gt;一些重要BuildStep 与 BuildItem&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#007fff&quot;&gt;BuildStep 有上百个，BuildItem则有几百个&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="6080" y="160" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-45" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-47" target="qXlFPTfgbzIKhoeTkRCt-48" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-46" value="..." style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="qXlFPTfgbzIKhoeTkRCt-45" vertex="1" connectable="0">
          <mxGeometry x="-0.0375" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-47" value="&lt;b&gt;MainClassBuildStep&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="6560" y="160" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-48" value="&lt;font color=&quot;#007fff&quot;&gt;内部定义了3个 BuildStep：&lt;/font&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#330033&quot;&gt;1. &lt;b style=&quot;&quot;&gt;build(...)&lt;/b&gt;&lt;/font&gt;&lt;font color=&quot;#007fff&quot;&gt; : 创建 ApplicationClassNameBuildItem，并通过 Gizmo 生成 ApplicationImpl 字节码；&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#330033&quot;&gt;2. &lt;b style=&quot;&quot;&gt;mainClassBuildStep(...)&lt;/b&gt;&lt;/font&gt;&lt;font color=&quot;#007fff&quot;&gt; : 创建 &lt;/font&gt;&lt;b style=&quot;color: rgb(0, 127, 255);&quot;&gt;MainClassBuildItem&lt;/b&gt;&lt;font color=&quot;#007fff&quot;&gt;；&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#330033&quot;&gt;3. &lt;b style=&quot;&quot;&gt;applicationReflection()&lt;/b&gt;&lt;/font&gt;&lt;font color=&quot;#007fff&quot;&gt; : 创建 &lt;/font&gt;&lt;b style=&quot;color: rgb(0, 127, 255);&quot;&gt;ReflectiveClassBuildItem&lt;/b&gt;&lt;font color=&quot;#007fff&quot;&gt;。&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="6800" y="160" width="440" height="60" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-49" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;QuarkusAugmentor&lt;/b&gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;Quarkus 增强器&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ClassLoader classLoader;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ClassLoader deploymentClassLoader;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final PathCollection root;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;//&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Set&amp;lt;Class&amp;lt;? extends BuildItem&amp;gt;&amp;gt; &lt;b&gt;finalResults&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;//&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final List&amp;lt;Consumer&amp;lt;BuildChainBuilder&amp;gt;&amp;gt; &lt;b&gt;buildChainCustomizers&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final LaunchMode &lt;b&gt;launchMode&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final DevModeType &lt;b&gt;devModeType&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final List&amp;lt;PathCollection&amp;gt; additionalApplicationArchives;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Collection&amp;lt;Path&amp;gt; excludedFromIndexing;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final LiveReloadBuildItem liveReloadBuildItem;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Properties &lt;b&gt;buildSystemProperties&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Properties runtimeProperties;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Path targetDir;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ApplicationModel effectiveModel;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Supplier&amp;lt;DependencyInfoProvider&amp;gt; depInfoProvider;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final String baseName;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final String originalBaseName;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final boolean rebuild;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final boolean auxiliaryApplication;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Optional&amp;lt;DevModeType&amp;gt; auxiliaryDevModeType;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final boolean test;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;public BuildResult &lt;b&gt;run&lt;/b&gt;() throws Exception&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="-1560" y="1000" width="480" height="400" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-50" value="&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;classLoader = {QuarkusClassLoader@1945}&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;deploymentClassLoader = {QuarkusClassLoader@1943}&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;root = {PathList@1964} &quot;[paths: /home/arvin/mywork/java/quarkus-labs/quarkus-010-smallest-system/target/classes;]&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;finalResults = {HashSet@1995}&amp;nbsp; size = 6&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp;0 = {Class@2067} &quot;class io.quarkus.deployment.builditem.ApplicationClassNameBuildItem&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp;1 = {Class@2068} &quot;class io.quarkus.deployment.builditem.MainClassBuildItem&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp;2 = {Class@2069} &quot;class io.quarkus.deployment.builditem.GeneratedClassBuildItem&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp;3 = {Class@2070} &quot;class io.quarkus.deployment.builditem.GeneratedFileSystemResourceHandledBuildItem&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp;4 = {Class@2071} &quot;class io.quarkus.deployment.builditem.GeneratedResourceBuildItem&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp;5 = {Class@2072} &quot;class io.quarkus.deployment.builditem.TransformedClassesBuildItem&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;buildChainCustomizers = {ArrayList@1998}&amp;nbsp; size = 1&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp;0 = {IsolatedDevModeMain$AddApplicationClassPredicateBuildStep@2065}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;launchMode = {LaunchMode@1955} &quot;DEVELOPMENT&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;devModeType = {DevModeType@1956} &quot;LOCAL&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;additionalApplicationArchives = {ArrayList@2003}&amp;nbsp; size = 0&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;excludedFromIndexing = {Collections$UnmodifiableRandomAccessList@1963}&amp;nbsp; size = 0&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;liveReloadBuildItem = {LiveReloadBuildItem@1968}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;buildSystemProperties = {Properties@1969}&amp;nbsp; size = 6&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;runtimeProperties = {Properties@1970}&amp;nbsp; size = 0&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;targetDir = {UnixPath@1965} &quot;/home/arvin/mywork/java/quarkus-labs/quarkus-010-smallest-system/target&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;effectiveModel = {DefaultApplicationModel@1971}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;depInfoProvider = null&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;baseName = &quot;quarkus-010-smallest-system-1.0-SNAPSHOT&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;originalBaseName = &quot;quarkus-application&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;rebuild = false&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;auxiliaryApplication = false&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;auxiliaryDevModeType = {Optional@2039} &quot;Optional.empty&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;test = false&lt;/font&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="-2170" y="1000" width="600" height="380" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-55" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;endArrow=open;endFill=0;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-51" target="qXlFPTfgbzIKhoeTkRCt-54" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-51" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;Execution&lt;/b&gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final BuildChain &lt;b&gt;chain&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;//&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ConcurrentHashMap&amp;lt;ItemId, BuildItem&amp;gt; &lt;b&gt;singles&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;//&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ConcurrentHashMap&amp;lt;ItemId, List&amp;lt;BuildItem&amp;gt;&amp;gt; &lt;b&gt;multis&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Set&amp;lt;ItemId&amp;gt; finalIds;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ConcurrentHashMap&amp;lt;StepInfo, BuildContext&amp;gt; contextCache = new ConcurrentHashMap&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final EnhancedQueueExecutor executor;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final List&amp;lt;Diagnostic&amp;gt; diagnostics = Collections.synchronizedList(new ArrayList&amp;lt;&amp;gt;());&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final String buildTargetName;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final AtomicBoolean errorReported = new AtomicBoolean();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final AtomicInteger lastStepCount = new AtomicInteger();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile Thread runningThread;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile boolean done;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final BuildMetrics metrics;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="-1040" y="1440" width="480" height="320" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-53" value="&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&lt;b style=&quot;font-size: 9px;&quot;&gt;META-INF/quarkus-build-steps.list&lt;/b&gt;&lt;br style=&quot;font-size: 9px;&quot;&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;result = {Collections$UnmodifiableRandomAccessList@3377}&amp;nbsp; size = 97&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;0 = {Class@2870} &quot;class io.quarkus.deployment.logging.LoggingWithPanacheProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;1 = {Class@2872} &quot;class io.quarkus.deployment.SecureRandomProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;2 = {Class@2873} &quot;class io.quarkus.deployment.recording.AnnotationProxyBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;3 = {Class@2874} &quot;class io.quarkus.deployment.dev.testing.TestTracingProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;4 = {Class@2875} &quot;class io.quarkus.deployment.JniProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;5 = {Class@2876} &quot;class io.quarkus.deployment.steps.DeprecatedRuntimePropertiesBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;6 = {Class@2877} &quot;class io.quarkus.deployment.steps.NativeImageSerializationConfigStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;7 = {Class@2878} &quot;class io.quarkus.deployment.pkg.steps.NativeImageBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;8 = {Class@2879} &quot;class io.quarkus.deployment.steps.ClassPathSystemPropBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;9 = {Class@2880} &quot;class io.quarkus.deployment.steps.ClassTransformingBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;10 = {Class@2881} &quot;class io.quarkus.deployment.dev.ConfigureDisableInstrumentationBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;11 = {Class@2882} &quot;class io.quarkus.deployment.steps.ThreadPoolSetup&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;12 = {Class@2883} &quot;class io.quarkus.deployment.steps.NativeImageResourcesStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;13 = {Class@2884} &quot;class io.quarkus.deployment.steps.ApplicationInfoBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;14 = {Class@2885} &quot;class io.quarkus.deployment.steps.ReflectionDiagnosticProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;15 = {Class@2886} &quot;class io.quarkus.deployment.ide.IdeProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;16 = {Class@2894} &quot;class io.quarkus.deployment.steps.DevModeBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;17 = {Class@2895} &quot;class io.quarkus.deployment.ConstructorPropertiesProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;18 = {Class@2896} &quot;class io.quarkus.deployment.steps.AdditionalClassLoaderResourcesBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;19 = {Class@2897} &quot;class io.quarkus.deployment.steps.RegisterForProxyBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;20 = {Class@2898} &quot;class io.quarkus.deployment.PodmanStatusProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;21 = {Class@2899} &quot;class io.quarkus.deployment.pkg.steps.FileSystemResourcesBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;22 = {Class@2900} &quot;class io.quarkus.deployment.steps.NativeImageJNIConfigStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;23 = {Class@2901} &quot;class io.quarkus.deployment.pkg.steps.AppCDSBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;24 = {Class@2902} &quot;class io.quarkus.deployment.steps.ShutdownListenerBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;25 = {Class@2903} &quot;class io.quarkus.deployment.steps.NativeImageFeatureStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;26 = {Class@2905} &quot;class io.quarkus.deployment.steps.NativeImageProxyConfigStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;27 = {Class@2906} &quot;class io.quarkus.deployment.steps.RuntimeConfigSetupBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;28 = {Class@2907} &quot;class io.quarkus.deployment.cmd.DeployCommandProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;29 = {Class@2908} &quot;class io.quarkus.deployment.console.ConsoleProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;30 = {Class@2909} &quot;class io.quarkus.deployment.pkg.steps.UpxCompressionBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;31 = {Class@2910} &quot;class io.quarkus.deployment.steps.ApplyNativeImageAgentConfigStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;32 = {Class@2911} &quot;class io.quarkus.deployment.steps.ChangedClassesBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;33 = {Class@2912} &quot;class io.quarkus.deployment.steps.ReflectiveHierarchyStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;34 = {Class@2913} &quot;class io.quarkus.deployment.execannotations.ExecutionModelAnnotationsProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;35 = {Class@2914} &quot;class io.quarkus.deployment.steps.ConfigBuildSteps&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;36 = {Class@2915} &quot;class io.quarkus.deployment.steps.NativeImageConfigBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;37 = {Class@2916} &quot;class io.quarkus.deployment.CollectionClassProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;38 = {Class@2917} &quot;class io.quarkus.deployment.cmd.RunCommandProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;39 = {Class@2918} &quot;class io.quarkus.deployment.steps.BannerProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;40 = {Class@2919} &quot;class io.quarkus.deployment.steps.LocaleProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;41 = {Class@2920} &quot;class io.quarkus.deployment.InetAddressProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;42 = {Class@2921} &quot;class io.quarkus.deployment.steps.DevServicesConfigBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;43 = {Class@2922} &quot;class io.quarkus.deployment.logging.LoggingResourceProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;44 = {Class@2923} &quot;class io.quarkus.deployment.steps.ConfigDescriptionBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;45 = {Class@2924} &quot;class io.quarkus.deployment.steps.ResourceBundleStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;46 = {Class@2925} &quot;class io.quarkus.deployment.JBossThreadsProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;47 = {Class@2926} &quot;class io.quarkus.deployment.steps.ApplicationIndexBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;48 = {Class@2927} &quot;class io.quarkus.deployment.steps.&lt;b&gt;MainClassBuildStep&lt;/b&gt;&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;49 = {Class@2936} &quot;class io.quarkus.deployment.index.ApplicationArchiveBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;50 = {Class@2937} &quot;class io.quarkus.deployment.steps.CapabilityAggregationStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;51 = {Class@2938} &quot;class io.quarkus.deployment.recording.substitutions.AdditionalSubstitutionsBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;52 = {Class@2939} &quot;class io.quarkus.deployment.SnapStartProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;53 = {Class@2940} &quot;class io.quarkus.deployment.dev.HotDeploymentWatchedFileBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;54 = {Class@2941} &quot;class io.quarkus.deployment.steps.RegisterForReflectionBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;55 = {Class@2942} &quot;class io.quarkus.deployment.steps.ProfileBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;56 = {Class@2943} &quot;class io.quarkus.deployment.SslProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;57 = {Class@2944} &quot;class io.quarkus.deployment.dev.io.NioThreadPoolDevModeProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;58 = {Class@2945} &quot;class io.quarkus.deployment.steps.CombinedIndexBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;59 = {Class@2946} &quot;class io.quarkus.deployment.steps.ConfigGenerationBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;60 = {Class@2947} &quot;class io.quarkus.deployment.DockerStatusProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;61 = {Class@2948} &quot;class io.quarkus.deployment.steps.PreloadClassesBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;62 = {Class@2949} &quot;class io.quarkus.deployment.ForkJoinPoolProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;63 = {Class@2950} &quot;class io.quarkus.deployment.steps.BlockingOperationControlBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;64 = {Class@2951} &quot;class io.quarkus.deployment.steps.NativeImageReflectConfigStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;65 = {Class@2952} &quot;class io.quarkus.deployment.steps.NativeImageResourceConfigStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;66 = {Class@2953} &quot;class io.quarkus.deployment.steps.CompiledJavaVersionBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;67 = {Class@2954} &quot;class io.quarkus.deployment.steps.NativeImageAllowIncompleteClasspathAggregateStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;68 = {Class@2955} &quot;class io.quarkus.deployment.steps.CurateOutcomeBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;69 = {Class@2956} &quot;class io.quarkus.deployment.pkg.steps.JarResultBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;70 = {Class@2961} &quot;class io.quarkus.arc.deployment.ConfigStaticInitBuildSteps&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;71 = {Class@2962} &quot;class io.quarkus.arc.deployment.SyntheticBeansProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;72 = {Class@2963} &quot;class io.quarkus.arc.deployment.AutoInjectFieldProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;73 = {Class@2964} &quot;class io.quarkus.arc.deployment.CommandLineArgumentsProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;74 = {Class@2965} &quot;class io.quarkus.arc.deployment.init.InitializationTaskProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;75 = {Class@2966} &quot;class io.quarkus.arc.deployment.ReflectiveBeanClassesProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;76 = {Class@2967} &quot;class io.quarkus.arc.deployment.AutoProducerMethodsProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;77 = {Class@2968} &quot;class io.quarkus.arc.deployment.&lt;b&gt;BeanArchiveProcessor&lt;/b&gt;&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;78 = {Class@2969} &quot;class io.quarkus.arc.deployment.HotDeploymentConfigBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;79 = {Class@2970} &quot;class io.quarkus.arc.deployment.LoggingBeanSupportProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;80 = {Class@2971} &quot;class io.quarkus.arc.deployment.UnremovableAnnotationsProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;81 = {Class@2972} &quot;class io.quarkus.arc.deployment.SplitPackageProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;82 = {Class@2974} &quot;class io.quarkus.arc.deployment.staticmethods.InterceptedStaticMethodsProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;83 = {Class@2975} &quot;class io.quarkus.arc.deployment.ExecutorServiceProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;84 = {Class@2976} &quot;class io.quarkus.arc.deployment.ObserverValidationProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;85 = {Class@2977} &quot;class io.quarkus.arc.deployment.LookupConditionsProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;86 = {Class@2978} &quot;class io.quarkus.arc.deployment.StartupBuildSteps&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;87 = {Class@2979} &quot;class io.quarkus.arc.deployment.AutoAddScopeProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;88 = {Class@2980} &quot;class io.quarkus.arc.deployment.ShutdownBuildSteps&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;89 = {Class@2981} &quot;class io.quarkus.arc.deployment.BuildTimeEnabledProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;90 = {Class@2982} &quot;class io.quarkus.arc.deployment.devui.ArcDevModeApiProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;91 = {Class@2983} &quot;class io.quarkus.arc.deployment.WrongAnnotationUsageProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;92 = {Class@2984} &quot;class io.quarkus.arc.deployment.TestsAsBeansProcessor&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;93 = {Class@2985} &quot;class io.quarkus.arc.deployment.&lt;b&gt;ArcProcessor&lt;/b&gt;&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;94 = {Class@2986} &quot;class io.quarkus.arc.deployment.LifecycleEventsBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;95 = {Class@2987} &quot;class io.quarkus.arc.deployment.ConfigBuildStep&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;96 = {Class@2988} &quot;class io.quarkus.arc.deployment.devui.ArcDevUIProcessor&quot;&lt;/font&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=9;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="6080" y="230" width="470" height="1080" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-54" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;BuildChain&lt;/b&gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;//&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Set&amp;lt;&lt;b&gt;ItemId&lt;/b&gt;&amp;gt; &lt;b&gt;initialIds&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;//&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Set&amp;lt;&lt;b&gt;ItemId&lt;/b&gt;&amp;gt; &lt;b&gt;finalIds&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;//&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final List&amp;lt;&lt;b&gt;StepInfo&lt;/b&gt;&amp;gt; &lt;b&gt;startSteps&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final List&amp;lt;BuildProvider&amp;gt; providers;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final int endStepCount;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ClassLoader classLoader;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="-1560" y="1440" width="480" height="200" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-58" value="&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;b&gt;关键问题：&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;b style=&quot;font-size: 11px;&quot;&gt;1. BuildItem 生成 ApplicationImpl 等类以及 StartupTask 的原理？&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp; &amp;nbsp; ApplicationImpl 是在 MainClassBuildStep#build() 中生成的， StartupTask 是借助一些 &lt;b&gt;BuildItem&lt;/b&gt; 生成，比如 &lt;br&gt;&amp;nbsp; &amp;nbsp; StaticBytecodeRecorderBuildItem、MainBytecodeRecorderBuildItem&lt;/font&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;；&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp; &amp;nbsp; 这些 BuildItem 在引导阶段由 ExtensionLoader 通过解析 BuildStep 创建。&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;b style=&quot;font-size: 11px;&quot;&gt;2. Bean 创建流程、存储位置？&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;b&gt;创建流程&lt;/b&gt;：&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp; &amp;nbsp; 2.1 @Record 注解&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; 2.2 @ApplicationScoped 等注解&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp; &amp;nbsp; Bean 的创建是在 ArcContainer 初始化时通过 new 自动生成的类（&amp;lt;Xxx&amp;gt;_Bean）创建，创建完成后会注册到 ArcContainer 实例中&lt;br&gt;&amp;nbsp; &amp;nbsp; Bean实例只是一个代理，这时 Bean 代理的类型还没有创建实例，默认在首次使用时会实例化被代理的类型。&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#330033&quot; style=&quot;font-size: 11px;&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &lt;/b&gt;现在问题转化成了&lt;b&gt;&amp;nbsp;&lt;/b&gt;&lt;/font&gt;&lt;b&gt;&amp;lt;Xxx&amp;gt;&lt;/b&gt;&lt;font color=&quot;#330033&quot; style=&quot;font-weight: bold; font-size: 11px;&quot;&gt;_Bean、&lt;/font&gt;&lt;b&gt;&amp;lt;Xxx&amp;gt;&lt;/b&gt;&lt;font color=&quot;#330033&quot; style=&quot;font-weight: bold; font-size: 11px;&quot;&gt;_ClientProxy 类型是怎么生成的？&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp; &amp;nbsp; TODO： 参考 &lt;b&gt;BeanProcessor&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;b&gt;存储位置&lt;/b&gt;：&lt;span style=&quot;background-color: initial; font-size: 11px;&quot;&gt;ArcContainerImpl&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;span style=&quot;background-color: initial; font-size: 11px;&quot;&gt;&lt;b style=&quot;font-size: 11px;&quot;&gt;&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;span style=&quot;background-color: initial; font-size: 11px;&quot;&gt;&lt;b style=&quot;font-size: 11px;&quot;&gt;3. 依赖注入原理？@Inject 是如何处理的？&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; @Inject 依赖注入实现是借助生成&amp;nbsp;&amp;lt;Xxx&amp;gt;_Bean 带参数的构造器实现注入的，创建Bean实例的时候会通过构造器传参注入依赖的Bean实例，&lt;br&gt;&amp;nbsp; &amp;nbsp; 比如此DEMO中会生成 public &lt;b&gt;Main_Bean&lt;/b&gt;(Supplier var), 这里 var 就是 @Inject 注释的字段类型的 Bean。&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; 依赖是有顺序的，Quarkus 会通过生成&amp;nbsp;&lt;/font&gt;&lt;span style=&quot;color: rgb(0, 127, 255); background-color: initial;&quot;&gt;&lt;b&gt;Default_ComponentsProvider&lt;/b&gt; 按依赖顺序创建 Bean 实例。&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;font color=&quot;#330033&quot;&gt;&amp;nbsp; &amp;nbsp; 现在问题转化为了&amp;nbsp;&lt;b style=&quot;&quot;&gt;Default_ComponentsProvider 是怎么生成的，即怎么发现Bean定义、解析依赖顺序并按依赖顺序创建 Bean&lt;br&gt;&amp;nbsp; &amp;nbsp; 的&amp;nbsp;&lt;/b&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;？&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;b&gt;4. BuildStep 与 BuildItem 在引导阶段的工作原理&lt;/b&gt;&lt;/div&gt;&lt;font style=&quot;&quot; color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; 引导阶段执行时 QuarkusAugmentor 先加载所有 BuildStep 项，然后在线程池(build-&amp;lt;x&amp;gt;线程)中执行构建方法（@BuildStep注释的方法），&lt;br&gt;&amp;nbsp; &amp;nbsp; &lt;b&gt;构建方法可能返回 BuildItem 也可能不返回 BuildItem, 具体看构建方法的执行结果其他 BuildStep 是否需要复用&lt;/b&gt;（有些构建逻辑需要多个&lt;br&gt;&amp;nbsp; &amp;nbsp; BuildStep协作完成，比如 &amp;lt;Xxx&amp;gt;_bean的生成流程）&lt;b&gt;，BuildItem 是某个&amp;nbsp;BuildStep 构建方法执行结果传给其他 BuildStep 构建方法的中间&lt;br&gt;&amp;nbsp; &amp;nbsp; 载体&lt;/b&gt;；&lt;br&gt;&amp;nbsp; &amp;nbsp; TODO:&amp;nbsp;&lt;br&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;b&gt;5. Bean生命周期管理&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 11px;&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="40" y="440" width="700" height="420" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-59" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;BeanManager&lt;/b&gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;重要方法：&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;public &amp;lt;T&amp;gt; Bean&amp;lt;T&amp;gt; createBean(BeanAttributes&amp;lt;T&amp;gt; attributes, Class&amp;lt;T&amp;gt; beanClass,&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; InjectionTargetFactory&amp;lt;T&amp;gt; injectionTargetFactory);&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;public &amp;lt;T, X&amp;gt; Bean&amp;lt;T&amp;gt; createBean(BeanAttributes&amp;lt;T&amp;gt; attributes, Class&amp;lt;X&amp;gt; beanClass, &lt;br&gt;&amp;nbsp; &amp;nbsp; ProducerFactory&amp;lt;X&amp;gt; producerFactory);&lt;br&gt;&lt;/span&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="-2080" y="1800" width="480" height="120" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-71" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;endArrow=blockThin;endFill=1;dashed=1;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-60" target="qXlFPTfgbzIKhoeTkRCt-59" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-60" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;BeanManagerImpl&lt;/b&gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;static final LazyValue&amp;lt;BeanManagerImpl&amp;gt; INSTANCE = new LazyValue&amp;lt;&amp;gt;(BeanManagerImpl::new);&lt;br&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="-2080" y="1960" width="480" height="120" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-62" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;endArrow=open;endFill=0;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-61" target="POQSeShFetzR28v93gBQ-27" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-61" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;Arc&lt;/b&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;ArcContainerImpl 单例&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private static final AtomicReference&amp;lt;&lt;b&gt;ArcContainerImpl&lt;/b&gt;&amp;gt; &lt;b&gt;INSTANCE&lt;/b&gt; = new AtomicReference();&lt;br&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;public static ArcContainer container()&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;" parent="1" vertex="1">
          <mxGeometry x="-1040" y="2000" width="480" height="120" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-67" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-63" target="qXlFPTfgbzIKhoeTkRCt-66" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-63" value="&lt;font style=&quot;font-size: 10px;&quot;&gt;return ArcContainerImpl.&lt;b&gt;instance&lt;/b&gt;().&lt;b&gt;getBeans&lt;/b&gt;((Type)Objects.requireNonNull(beanType), qualifiers);&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;arcSize=11;align=left;fontSize=10;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="1718.5" y="2841" width="440.5" height="60" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-69" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-66" target="qXlFPTfgbzIKhoeTkRCt-68" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-70" value="..." style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="qXlFPTfgbzIKhoeTkRCt-69" vertex="1" connectable="0">
          <mxGeometry x="-0.0616" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-66" value="&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;// 先通过类型获取所有潜在的Bean, 然后通过 qualifiers 过滤，生成的类中创建的Bean其实是空壳代理，可以看到 proxy 是 null, 在首次使用时会创建 ClientProxy&lt;/b&gt;&lt;/font&gt;&lt;br&gt;return Set.of((Bean[])this.&lt;b&gt;getMatchingBeans&lt;/b&gt;(new Resolvable(requiredType, qualifiers))&lt;br&gt;.toArray(new Bean[0]));" style="rounded=1;whiteSpace=wrap;html=1;arcSize=11;align=left;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="2199" y="2841" width="440.5" height="60" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-68" value="&lt;div&gt;Iterable&amp;lt;InjectableBean&amp;lt;?&amp;gt;&amp;gt; &lt;b&gt;potentialBeans&lt;/b&gt;(Type type) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; if (!Object.class.equals(type)) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; Class&amp;lt;?&amp;gt; rawType = Types.getRawType(type);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if (rawType != null) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; List&amp;lt;InjectableBean&amp;lt;?&amp;gt;&amp;gt; match = &lt;b&gt;beansByRawType&lt;/b&gt;.get(&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; Types.boxedClass(rawType).getName());&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; return match == null ? List.of() : match;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; return beans;&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;arcSize=3;align=left;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="2679" y="2801" width="440.5" height="140" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-102" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-73" target="qXlFPTfgbzIKhoeTkRCt-101" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-73" value="&lt;div style=&quot;font-size: 10px;&quot;&gt;return this.bean != null ? this.arc$delegate().&lt;b&gt;run&lt;/b&gt;(var1) : super.run(var1);&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1718.5" y="3261" width="440" height="60" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-85" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-76" target="qXlFPTfgbzIKhoeTkRCt-84" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-76" value="&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;static &amp;lt;T&amp;gt; InstanceHandle&amp;lt;T&amp;gt; beanInstanceHandle(InjectableBean&amp;lt;T&amp;gt; bean,&lt;br style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; &amp;nbsp; CreationalContextImpl&amp;lt;T&amp;gt; parentContext, boolean resetCurrentInjectionPoint,&lt;br style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; &amp;nbsp; Consumer&amp;lt;T&amp;gt; destroyLogic, boolean useParentCreationalContextDirectly) {&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; &amp;nbsp; EagerInstanceHandle var7;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;font style=&quot;border-color: var(--border-color);&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; &amp;nbsp; // bean 只是类真正实例的第二层代理，&lt;/b&gt;&lt;/font&gt;bean.&lt;b style=&quot;background-color: initial; border-color: var(--border-color);&quot;&gt;get&lt;/b&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;(creationalContext) 可以获取第一层代理&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; &amp;nbsp; var7 = new&amp;nbsp;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;EagerInstanceHandle&lt;/b&gt;(bean, bean.&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;get&lt;/b&gt;(creationalContext), creationalContext,&lt;br style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; parentContext, destroyLogic);&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; &amp;nbsp; return var7;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;}&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;fontSize=10;arcSize=3;" parent="1" vertex="1">
          <mxGeometry x="2199.5" y="2971" width="440" height="160" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-82" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-79" target="qXlFPTfgbzIKhoeTkRCt-81" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-79" value="&lt;div style=&quot;&quot;&gt;return instanceInternal();&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="2199" y="3171" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-81" value="&lt;div style=&quot;&quot;&gt;return instance;&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="2439" y="3171" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-83" value="EagerInstanceHandle&amp;lt;T&amp;gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="2464" y="3141" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-95" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-84" target="qXlFPTfgbzIKhoeTkRCt-94" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-84" value="&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;public Main get(CreationalContext var1) {&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; // 获取第一层代理（ClientProxy），没有则创建&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; &amp;nbsp; return (Main)this.proxy();&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;}&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;fontSize=10;arcSize=13;" parent="1" vertex="1">
          <mxGeometry x="2679" y="3021" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-86" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;endArrow=blockThin;endFill=1;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-87" target="qXlFPTfgbzIKhoeTkRCt-92" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-87" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;InstanceHandle&amp;lt;T&amp;gt; &lt;/b&gt;extends AutoCloseable, Instance.Handle&amp;lt;T&amp;gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;主要是重写了 getBean() 方法&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;default &lt;b&gt;InjectableBean&lt;/b&gt;&amp;lt;T&amp;gt; getBean() {&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&amp;nbsp; &amp;nbsp; return null;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;}&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="-2600" y="2560" width="480" height="120" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-88" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;endArrow=blockThin;endFill=1;dashed=1;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-89" target="qXlFPTfgbzIKhoeTkRCt-87" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-89" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;AbstractInstanceHandle&amp;lt;T&amp;gt;&lt;/b&gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private static final AtomicIntegerFieldUpdater&amp;lt;AbstractInstanceHandle&amp;gt; &lt;br&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; DESTROYED_UPDATER = AtomicIntegerFieldUpdater&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&amp;nbsp; &amp;nbsp; .newUpdater(AbstractInstanceHandle.class, &quot;destroyed&quot;);&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;protected final InjectableBean&amp;lt;T&amp;gt; &lt;b&gt;bean&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final CreationalContext&amp;lt;T&amp;gt; creationalContext;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final CreationalContext&amp;lt;?&amp;gt; parentCreationalContext;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Consumer&amp;lt;T&amp;gt; destroyLogic;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile int destroyed;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;" parent="1" vertex="1">
          <mxGeometry x="-2600" y="2720" width="480" height="160" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-90" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;endArrow=blockThin;endFill=1;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-91" target="qXlFPTfgbzIKhoeTkRCt-89" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-91" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;EagerInstanceHandle&lt;/b&gt;&lt;b style=&quot;background-color: initial;&quot;&gt;&amp;lt;T&amp;gt;&lt;/b&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;static final EagerInstanceHandle&amp;lt;Object&amp;gt; UNAVAILABLE = new EagerInstanceHandle(&lt;br&gt;&amp;nbsp; &amp;nbsp; (InjectableBean)null, (Object)null, (CreationalContext)null, (CreationalContext)null, &lt;br&gt;&amp;nbsp; &amp;nbsp; (Consumer)null);&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;// bean 代理类型的实例&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final T &lt;b&gt;instance&lt;/b&gt;;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="-2600" y="2920" width="480" height="120" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-92" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;Instance.Handle&amp;lt;T&amp;gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;Jakarta CDI 规范中的接口&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;b style=&quot;color: rgb(0, 127, 255); background-color: initial;&quot;&gt;Instance&lt;/b&gt;&lt;span style=&quot;color: rgb(0, 127, 255); background-color: initial;&quot;&gt; 接口允许应用程序动态获取具有指定类型和限定符组合的 bean 实例；&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;Instance.&lt;b&gt;Handle&lt;/b&gt; 接口&lt;/font&gt;&lt;font color=&quot;#007fff&quot;&gt;代表一个上下文引用句柄；&lt;/font&gt;&lt;span style=&quot;color: rgb(0, 127, 255); background-color: initial;&quot;&gt;它允许在解析相关的上下文引用之前检查该 bean 的元数据，并且可以销毁底层的上下文实例&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;span style=&quot;color: rgb(0, 127, 255); background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;重要方法：&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#330033&quot;&gt;T get();&lt;/font&gt;&lt;br&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#330033&quot;&gt;Bean&amp;lt;T&amp;gt; getBean();&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="-2600" y="2360" width="480" height="160" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-93" value="BeanManagerImpl" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="1878.5" y="2911" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-104" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-94" target="qXlFPTfgbzIKhoeTkRCt-103" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-94" value="&lt;div style=&quot;&quot;&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;private Main_ClientProxy proxy() {&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; &amp;nbsp; Main_ClientProxy var1 = this.proxy;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; &amp;nbsp; if (var1 == null) {&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // 第一层代理， ClientProxy 继承 Main 类&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; var1 = &lt;b&gt;new&lt;/b&gt; &lt;b&gt;Main_ClientProxy&lt;/b&gt;(&quot;DoXr47yc7YGMSTHjBSfLvjY3LrY&quot;);&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; this.&lt;b&gt;proxy&lt;/b&gt; = &lt;b&gt;var1&lt;/b&gt;;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; &amp;nbsp; return &lt;b&gt;var1&lt;/b&gt;;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;}&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;fontSize=10;arcSize=5;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2919" y="2991" width="440" height="120" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-98" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;endArrow=open;endFill=0;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-96" target="qXlFPTfgbzIKhoeTkRCt-97" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-100" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;endArrow=blockThin;endFill=1;dashed=1;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-96" target="qXlFPTfgbzIKhoeTkRCt-99" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-96" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;&amp;lt;Xxx&amp;gt;_Bean&lt;/b&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Set types;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile &lt;b&gt;&amp;lt;Xxx&amp;gt;_ClientProxy&lt;/b&gt; &lt;b&gt;proxy&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;// 依赖Bean&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Supplier &lt;b&gt;injectProviderSupplier1&lt;/b&gt;;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;" parent="1" vertex="1">
          <mxGeometry x="-520" y="2520" width="480" height="120" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-97" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;&amp;lt;Xxx&amp;gt;_ClientProxy &lt;/b&gt;extends &amp;lt;Xxx&amp;gt; implements ClientProxy&lt;br&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final &lt;b&gt;InjectableBean&lt;/b&gt; &lt;b&gt;bean&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final &lt;b&gt;InjectableContext&lt;/b&gt; &lt;b&gt;context&lt;/b&gt;;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;" parent="1" vertex="1">
          <mxGeometry x="-1040" y="2520" width="480" height="120" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-99" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;InjectableBean&amp;lt;T&amp;gt; &lt;/b&gt;extends Bean&amp;lt;T&amp;gt;, InjectableReferenceProvider&amp;lt;T&amp;gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&amp;nbsp;Bean&amp;lt;T&amp;gt; extends &lt;b&gt;Contextual&lt;/b&gt;&amp;lt;T&amp;gt;, BeanAttributes&amp;lt;T&amp;gt;&lt;br&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;定义用于创建和销毁特定类型上下文实例的操作&lt;br&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;Set&amp;lt;Type&amp;gt; getTypes();&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;default Set&amp;lt;Annotation&amp;gt; getQualifiers()&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;default InjectableBean&amp;lt;?&amp;gt; getDeclaringBean()&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;default Set&amp;lt;InjectionPoint&amp;gt; getInjectionPoints()&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="-520" y="2360" width="480" height="120" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-107" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-101" target="qXlFPTfgbzIKhoeTkRCt-106" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-101" value="&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;div&gt;private Main arc$delegate() {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; InjectableBean var1 = this.bean;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; return (Main)&lt;b&gt;ClientProxies&lt;/b&gt;.&lt;b&gt;getApplicationScopedDelegate&lt;/b&gt;(this.context, var1);&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="2199.5" y="3261" width="440" height="60" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-103" value="&lt;div style=&quot;&quot;&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;public Main_ClientProxy(String var1) {&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; &amp;nbsp; ArcContainer var3 = Arc.container();&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; &amp;nbsp; InjectableBean var2 = var3.bean(var1);&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; &amp;nbsp; this.&lt;b&gt;bean&lt;/b&gt; = var2;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; &amp;nbsp; Class var4 = var2.getScope();&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; // 获取对应生命周期范围的上下文，比如 ApplicationContext&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; &amp;nbsp; Object &lt;b&gt;var5&lt;/b&gt; = var3.&lt;b&gt;getContexts&lt;/b&gt;(var4).&lt;b&gt;get&lt;/b&gt;(0);&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; &amp;nbsp; this.&lt;b&gt;context&lt;/b&gt; = (InjectableContext)&lt;b&gt;var5&lt;/b&gt;;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;}&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;fontSize=10;arcSize=5;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="3399" y="2991" width="440" height="120" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-142" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;endArrow=open;endFill=0;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-105" target="qXlFPTfgbzIKhoeTkRCt-127" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-105" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;Contexts&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;封装容器中使用的所有上下文&lt;/font&gt;&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;final ManagedContext &lt;b&gt;requestContext&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;final InjectableContext &lt;b&gt;applicationContext&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;final InjectableContext &lt;b&gt;singletonContext&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;final InjectableContext &lt;b&gt;dependentContext&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;// Used to optimize the getContexts(Class&amp;lt;? extends Annotation&amp;gt;)&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;// 用于 @ApplicationScoped, 其实是上面的 applicationContext&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final List&amp;lt;InjectableContext&amp;gt; &lt;b&gt;applicationContextSingleton&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;border-color: var(--border-color); margin: 0px 0px 0px 4px;&quot;&gt;&lt;b style=&quot;border-color: var(--border-color); color: rgb(0, 127, 255);&quot;&gt;// 用于 @Singleton&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final List&amp;lt;InjectableContext&amp;gt; &lt;b&gt;singletonContextSingleton&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;// 用于 @Dependent&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final List&amp;lt;InjectableContext&amp;gt; &lt;b&gt;dependentContextSingleton&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;b style=&quot;border-color: var(--border-color); color: rgb(0, 127, 255);&quot;&gt;// 用于 @RequestScoped&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;private final List&amp;lt;InjectableContext&amp;gt; &lt;/span&gt;&lt;b style=&quot;background-color: initial;&quot;&gt;requestContextSingleton&lt;/b&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;// Lazily computed list of contexts for a scope&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ClassValue&amp;lt;List&amp;lt;InjectableContext&amp;gt;&amp;gt; unoptimizedContexts;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;// Precomputed values&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;final Set&amp;lt;Class&amp;lt;? extends Annotation&amp;gt;&amp;gt; scopes;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="-520" y="2680" width="480" height="360" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-138" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-106" target="qXlFPTfgbzIKhoeTkRCt-137" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-147" value="..." style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="qXlFPTfgbzIKhoeTkRCt-138" vertex="1" connectable="0">
          <mxGeometry x="0.0658" y="1" relative="1" as="geometry">
            <mxPoint x="-1" y="-6" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-106" value="&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;div&gt;public static &amp;lt;T&amp;gt; T getApplicationScopedDelegate(InjectableContext applicationContext, &lt;br&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;InjectableBean&amp;lt;T&amp;gt; bean) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; T result = applicationContext.get(bean);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; if (result == null) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; result = &lt;b&gt;applicationContext&lt;/b&gt;.&lt;b&gt;get&lt;/b&gt;(bean, newCreationalContext(bean));&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; return result;&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;fontSize=10;arcSize=9;" parent="1" vertex="1">
          <mxGeometry x="2679.5" y="3261" width="440" height="119" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-109" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;endArrow=blockThin;endFill=1;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-108" target="qXlFPTfgbzIKhoeTkRCt-91" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-143" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.75;exitY=0;exitDx=0;exitDy=0;entryX=0.25;entryY=1;entryDx=0;entryDy=0;endArrow=block;endFill=1;dashed=1;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-108" target="qXlFPTfgbzIKhoeTkRCt-140" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-2240" y="3060" />
              <mxPoint x="-2100" y="3060" />
              <mxPoint x="-2100" y="2820" />
              <mxPoint x="-1960" y="2820" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-108" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;ContextInstanceHandleImpl&amp;lt;T&amp;gt;&lt;/b&gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="-2600" y="3080" width="480" height="80" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-115" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-110" target="qXlFPTfgbzIKhoeTkRCt-114" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-110" value="&lt;div style=&quot;font-size: 9px;&quot;&gt;static {&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; DisabledInitialContextManager.&lt;b&gt;register&lt;/b&gt;();&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; System.setProperty(&quot;logging.initial-configurator.min-level&quot;, &quot;500&quot;);&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; System.setProperty(&quot;java.util.concurrent.ForkJoinPool.common.threadFactory&quot;, &lt;br style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &quot;io.quarkus.bootstrap.forkjoin.QuarkusForkJoinWorkerThreadFactory&quot;);&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; System.setProperty(&quot;java.util.logging.manager&quot;, &quot;org.jboss.logmanager.LogManager&quot;);&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; LaunchMode.set(LaunchMode.NORMAL);&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; StepTiming.configureEnabled();&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; ExecutionModeManager.&lt;b&gt;staticInit&lt;/b&gt;();&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; Timing.staticInitStarted(false);&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; Config.ensureInitialized();&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; LOG = Logger.getLogger(&quot;io.quarkus.application&quot;);&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; __QUARKUS_ANALYTICS_QUARKUS_VERSION = &quot;__quarkus_analytics__quarkus.version=3.17.6&quot;;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; StartupContext var0 = new StartupContext();&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; STARTUP_CONTEXT = var0;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; try {&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // Try 块中的启动任务都是由&amp;nbsp;StaticBytecodeRecorderBuildItem 生成的&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;    &lt;/span&gt;&lt;/span&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;// 是 @Record(ExecutionTime.STATIC_INIT) 类型的 BuildStep&lt;/b&gt;&lt;/font&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; StepTiming.configureStart();&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ((StartupTask)(new LoggingResourceProcessor.setupLoggingStaticInit2062061316())).deploy(var0);&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; StepTiming.printStepTime(var0);&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ((StartupTask)(new BlockingOperationControlBuildStep.blockingOP558072755())).deploy(var0);&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; StepTiming.printStepTime(var0);&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ((StartupTask)(new NativeImageConfigBuildStep.build282698227())).deploy(var0);&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; StepTiming.printStepTime(var0);&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ((StartupTask)(new SyntheticBeansProcessor.initStatic1190120725())).deploy(var0);&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; StepTiming.printStepTime(var0);&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ((StartupTask)(new ConfigBuildStep.validateStaticInitConfigProperty682828288())).deploy(var0);&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; StepTiming.printStepTime(var0);&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // 初始化 ArcContainerImpl&amp;nbsp;&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ((StartupTask)(new &lt;b&gt;ArcProcessor&lt;/b&gt;.&lt;b&gt;initializeContainer1770303700&lt;/b&gt;())).&lt;b&gt;deploy&lt;/b&gt;(var0);&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; StepTiming.printStepTime(var0);&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ((StartupTask)(new ArcProcessor.notifyBeanContainerListeners1304312071())).deploy(var0);&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; StepTiming.printStepTime(var0);&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; } catch (Throwable var2) {&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ApplicationStateNotification.notifyStartupFailed(var2);&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; var0.close();&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; throw (Throwable)(new RuntimeException(&quot;Failed to start quarkus&quot;, var2));&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;}&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;arcSize=2;align=left;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="1240" y="920" width="440" height="440" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-117" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-114" target="qXlFPTfgbzIKhoeTkRCt-116" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-118" value="..." style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="qXlFPTfgbzIKhoeTkRCt-117" vertex="1" connectable="0">
          <mxGeometry x="-0.35" y="-4" relative="1" as="geometry">
            <mxPoint x="4" y="-110" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-114" value="&lt;div&gt;public void deploy_0(StartupContext var1, Object[] var2) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ArcRecorder var3 = new ArcRecorder();&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; Object var4 = var1.getValue(&quot;io.quarkus.runtime.ShutdownContext&quot;);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ArcContainer var5 = var3.initContainer((ShutdownContext)var4, (RuntimeValue)null, false);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; var1.putValue(&quot;proxykey27&quot;, var5);&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=11;align=left;arcSize=6;" parent="1" vertex="1">
          <mxGeometry x="1719.31" y="920" width="440.69" height="100" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-120" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-116" target="qXlFPTfgbzIKhoeTkRCt-119" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-116" value="&lt;div style=&quot;font-size: 10px;&quot;&gt;public ArcContainerImpl(CurrentContextFactory currentContextFactory, boolean strictMode) {&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; // 默认会生成一个 Default_ComponentsProvider, 此生成类中 getComponents() 方法中会明确指定需要创建哪些Bean实例&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; for (ComponentsProvider componentsProvider : ServiceLoader.load(ComponentsProvider.class)) {&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;components&lt;/b&gt;.add(componentsProvider.&lt;b&gt;getComponents&lt;/b&gt;(this.currentContextFactory));&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; for (Components c : components) {&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; for (InjectableBean&amp;lt;?&amp;gt; bean : c.&lt;b&gt;getBeans&lt;/b&gt;()) {&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if (bean instanceof InjectableInterceptor) {&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; interceptors.add((InjectableInterceptor&amp;lt;?&amp;gt;) bean);&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; } else if (bean instanceof InjectableDecorator) {&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; decorators.add((InjectableDecorator&amp;lt;?&amp;gt;) bean);&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; } else {&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;beans&lt;/b&gt;.add(bean);&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; precomputeBeanRawTypes(beansByRawType, bean);&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if (applicationContextInstances == null) {&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; applicationContextInstances = c.getContextInstances().get(ApplicationScoped.class);&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if (requestContextInstances == null) {&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; requestContextInstances = c.getContextInstances().get(RequestScoped.class);&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; // 注册内置的Bean,&amp;nbsp;&lt;/b&gt;BeanManagerBean、EventBean、InstanceBean&lt;span style=&quot;background-color: initial;&quot;&gt;、InjectionPointBean&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;b&gt;addBuiltInBeans&lt;/b&gt;(&lt;b&gt;beans&lt;/b&gt;, beansByRawType);&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;b&gt;resolved&lt;/b&gt; = new ComputingCache&amp;lt;&amp;gt;(this::resolve);&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;b&gt;beansById&lt;/b&gt; = new ComputingCache&amp;lt;&amp;gt;(this::findById);&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;b&gt;beansByName&lt;/b&gt; = new ComputingCache&amp;lt;&amp;gt;(this::resolve);&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; resourceProviders = new ArrayList&amp;lt;&amp;gt;();&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; for (ResourceReferenceProvider resourceProvider : ServiceLoader.load(ResourceReferenceProvider.class)) {&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; resourceProviders.add(resourceProvider);&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; resourceProviders.trimToSize();&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; instance = InstanceImpl.forGlobalEntrypoint(Object.class, Collections.emptySet());&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; this.&lt;b&gt;beans&lt;/b&gt; = List.copyOf(&lt;b&gt;beans&lt;/b&gt;);&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; this.beansByRawType = Map.copyOf(beansByRawType);&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; ...&amp;nbsp;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; ApplicationContext applicationContext = applicationContextInstances != null&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ? new ApplicationContext(applicationContextInstances.get())&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; : new ApplicationContext();&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; RequestContext requestContext = new RequestContext(this.currentContextFactory.create(RequestScoped.class),&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; notifierOrNull(Set.of(Initialized.Literal.REQUEST, Any.Literal.INSTANCE)),&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; notifierOrNull(Set.of(BeforeDestroyed.Literal.REQUEST, Any.Literal.INSTANCE)),&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; notifierOrNull(Set.of(Destroyed.Literal.REQUEST, Any.Literal.INSTANCE)),&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; requestContextInstances != null ? requestContextInstances : ComputingCacheContextInstances::new);&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; Contexts.Builder contextsBuilder = new Contexts.Builder(&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; requestContext,&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; applicationContext,&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; new SingletonContext(),&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; new DependentContext());&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; // Add custom contexts&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; for (Components c : components) {&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; for (InjectableContext context : c.getContexts()) {&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; contextsBuilder.putContext(context);&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; this.contexts = contextsBuilder.build();&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;}&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;arcSize=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2200" y="920" width="680" height="840" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-119" value="&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;private void &lt;/span&gt;&lt;b style=&quot;background-color: initial;&quot;&gt;addBeans1&lt;/b&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;(Map var1) {&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; GreetingService_Bean var2 = new &lt;b&gt;GreetingService_Bean&lt;/b&gt;();&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; var1.put(&quot;kC9VumtQ054lxN4U3FwV4Ql9S_0&quot;, var2);&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; Object var3 = var1.get(&quot;kC9VumtQ054lxN4U3FwV4Ql9S_0&quot;);&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; Greeter_Bean &lt;b&gt;var4&lt;/b&gt; = new &lt;b&gt;Greeter_Bean&lt;/b&gt;((Supplier)var3);&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; var1.put(&quot;4a_CCvwa_DwjRriTbJZ_n6dBU48&quot;, &lt;b&gt;var4&lt;/b&gt;);&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; ConfigStaticInitValues_Bean var5 = new ConfigStaticInitValues_Bean();&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; var1.put(&quot;sFcr9mrnyYy49t0Q7Q7gcCprles&quot;, var5);&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; DefaultAsyncObserverExceptionHandler_Bean var6 = new &lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;DefaultAsyncObserverExceptionHandler_Bean();&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; var1.put(&quot;vmlVrSfe_RSd4mIFvYr3iOrqX5U&quot;, var6);&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; Object &lt;b&gt;var7&lt;/b&gt; = var1.get(&quot;4a_CCvwa_DwjRriTbJZ_n6dBU48&quot;); &lt;font color=&quot;#007fff&quot;&gt;// var7 其实就是 var4&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; Main_Bean var8 = new &lt;b&gt;Main_Bean&lt;/b&gt;((Supplier)&lt;b&gt;var7&lt;/b&gt;);&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; var1.put(&quot;DoXr47yc7YGMSTHjBSfLvjY3LrY&quot;, var8);&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; Object_c7JBSkuQ1C2M2pz0aBMoQPtOQ5Y_Synthetic_Bean var9 = new &lt;br&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;Object_c7JBSkuQ1C2M2pz0aBMoQPtOQ5Y_Synthetic_Bean();&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; var1.put(&quot;c7JBSkuQ1C2M2pz0aBMoQPtOQ5Y&quot;, var9);&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;}&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;fontSize=10;arcSize=2;" parent="1" vertex="1">
          <mxGeometry x="2919" y="920" width="441" height="240" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-121" value="Default_ComponentsProvider （生成的类）" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="3009" y="890" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-122" value="&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;Default_ComponentsProvider 是哪里生成的？&lt;/font&gt;&lt;/b&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="3365" y="920" width="280" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-123" value="Main_ClientProxy" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="1878.5" y="3231" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-134" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;endArrow=open;endFill=0;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-124" target="qXlFPTfgbzIKhoeTkRCt-130" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-124" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;AbstractSharedContext&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;// 上下文实例&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;protected final &lt;b&gt;ContextInstances&lt;/b&gt; &lt;b&gt;instances&lt;/b&gt;;&lt;br&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="-1040" y="2840" width="480" height="120" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-126" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;endArrow=block;endFill=1;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-125" target="qXlFPTfgbzIKhoeTkRCt-124" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-125" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;ApplicationContext&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;专门用于 @ApplicationScoped 的上下文&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="-1040" y="3000" width="480" height="80" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-127" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;InjectableContext &lt;/b&gt;extends AlterableContext&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;AlterableContext extends Context&lt;br&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;用于捕获和查看上下文状态以及销毁该上下文中所有上下文实例&lt;/font&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="-1040" y="2680" width="480" height="120" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-131" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;endArrow=block;endFill=1;dashed=1;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-128" target="qXlFPTfgbzIKhoeTkRCt-130" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-128" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;ComputingCacheContextInstances&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;上下文实例缓存&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;protected final ComputingCache&amp;lt;String, ContextInstanceHandle&amp;lt;?&amp;gt;&amp;gt; instances;&lt;br&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;" parent="1" vertex="1">
          <mxGeometry x="-1560" y="2881" width="480" height="120" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-144" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;endArrow=open;endFill=0;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-130" target="qXlFPTfgbzIKhoeTkRCt-140" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-130" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;ContextInstances&lt;/b&gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;上下文实例，ContextInstanceHandle 的容器&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#330033&quot;&gt;&lt;b&gt;ContextInstanceHandle&lt;/b&gt;&amp;lt;?&amp;gt; &lt;b&gt;computeIfAbsent&lt;/b&gt;(String id, Supplier&amp;lt;ContextInstanceHandle&amp;lt;?&amp;gt;&amp;gt; supplier);&lt;/font&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#330033&quot;&gt;&lt;b&gt;ContextInstanceHandle&lt;/b&gt;&amp;lt;?&amp;gt; &lt;b&gt;getIfPresent&lt;/b&gt;(String id);&lt;br&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#330033&quot;&gt;&lt;b&gt;ContextInstanceHandle&lt;/b&gt;&amp;lt;?&amp;gt; &lt;b&gt;remove&lt;/b&gt;(String id);&lt;br&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#330033&quot;&gt;Set&amp;lt;&lt;b&gt;ContextInstanceHandle&lt;/b&gt;&amp;lt;?&amp;gt;&amp;gt; &lt;b&gt;getAllPresent&lt;/b&gt;();&lt;br&gt;void removeEach(Consumer&amp;lt;? super ContextInstanceHandle&amp;lt;?&amp;gt;&amp;gt; action);&lt;br&gt;&lt;/font&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="-1560" y="2681" width="480" height="160" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-132" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=1;dashed=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-124" target="qXlFPTfgbzIKhoeTkRCt-127" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-790" y="2830" as="sourcePoint" />
            <mxPoint x="-800" y="2800" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-135" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;endArrow=block;endFill=1;dashed=1;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-133" target="qXlFPTfgbzIKhoeTkRCt-130" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-133" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;Default_jakarta_enterprise_context_ApplicationScoped_ContextInstances&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;用于 @ApplicationScoped 的上下文实例，是生成的类&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile &lt;b&gt;ContextInstanceHandle&lt;/b&gt; 0;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile Lock 0l;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private static final AtomicReferenceFieldUpdater LAZY_0L_UPDATER = ...;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile &lt;b&gt;ContextInstanceHandle&lt;/b&gt; 1;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile Lock 1l;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private static final AtomicReferenceFieldUpdater LAZY_1L_UPDATER = ...;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile &lt;b&gt;ContextInstanceHandle&lt;/b&gt; 2;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile Lock 2l;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private static final AtomicReferenceFieldUpdater LAZY_2L_UPDATER = ...;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="-2080" y="2880" width="480" height="240" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-146" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-137" target="qXlFPTfgbzIKhoeTkRCt-145" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-137" value="&lt;div style=&quot;&quot;&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;div&gt;public &amp;lt;T&amp;gt; T get(Contextual&amp;lt;T&amp;gt; contextual, CreationalContext&amp;lt;T&amp;gt; creationalContext) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; InjectableBean&amp;lt;T&amp;gt; bean = (InjectableBean&amp;lt;T&amp;gt;) contextual;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; // 从上下文实例获取 Bean 代理类型的实例，不存在则创建 ContextInstanceHandle 通过它获取&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; return (T) instances.&lt;b&gt;computeIfAbsent&lt;/b&gt;(bean.getIdentifier(), new Supplier&amp;lt;&lt;b&gt;ContextInstanceHandle&lt;/b&gt;&amp;lt;?&amp;gt;&amp;gt;()&amp;nbsp; &lt;br&gt;&amp;nbsp; &amp;nbsp; {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; @Override&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; public ContextInstanceHandle&amp;lt;?&amp;gt; get() {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; return &lt;b&gt;createInstanceHandle&lt;/b&gt;(bean, creationalContext);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }).&lt;b&gt;get&lt;/b&gt;();&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;fontSize=10;arcSize=2;" parent="1" vertex="1">
          <mxGeometry x="3160" y="3261" width="440" height="139" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-141" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;endArrow=block;endFill=1;entryX=0.75;entryY=1;entryDx=0;entryDy=0;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-140" target="qXlFPTfgbzIKhoeTkRCt-87" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-1840" y="2700" />
              <mxPoint x="-2240" y="2700" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-140" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;ContextInstanceHandle&amp;lt;T&amp;gt;&lt;/b&gt;&lt;br style=&quot;font-size: 11px;&quot;&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 11px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;void destroy();&lt;/span&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="-2080" y="2721" width="480" height="80" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-145" value="&lt;div style=&quot;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot; size=&quot;1&quot;&gt;&lt;b&gt;// bean.create() 调用 Xxx_Bean create() 方法创建 Bean 代理类型的真正实例对象,即 new Xxx()&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;1&quot;&gt;return new ContextInstanceHandleImpl(bean, bean.&lt;b&gt;create&lt;/b&gt;(creationalContext), creationalContext);&lt;/font&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;fontSize=10;arcSize=2;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="3640" y="3300.5" width="440" height="60" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-148" value="StartupActionImpl" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="3600" y="90" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-151" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-149" target="qXlFPTfgbzIKhoeTkRCt-150" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-149" value="&lt;b&gt;ArcProcessor&lt;br&gt;&lt;/b&gt;&lt;font color=&quot;#007fff&quot;&gt;核心BuildStep类&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="6560" y="240" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-150" value="&lt;font color=&quot;#007fff&quot;&gt;内部定义了很多BuildStep&lt;/font&gt;&lt;br&gt;1. &lt;b&gt;registerBeans&lt;/b&gt;()&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;先扫描Bean Class, 创建 BeanInfo 注册到 BeanDeployment&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="6800" y="240" width="440" height="60" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-154" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="qXlFPTfgbzIKhoeTkRCt-152" target="qXlFPTfgbzIKhoeTkRCt-153" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-152" value="&lt;b&gt;BeanArchiveProcessor&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="6560" y="320" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-153" value="&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;span style=&quot;background-color: initial; font-size: 10px;&quot;&gt;1. &lt;b&gt;build(...)&lt;/b&gt; : &lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;先创建应用包中Bean类索引 、再创建拓展包中的Bean类索引，索引数据放到新建的&amp;nbsp;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;BeanArchiveIndexBuildItem&lt;/b&gt;实例中返回&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="6800" y="320" width="440" height="60" as="geometry" />
        </mxCell>
        <mxCell id="qXlFPTfgbzIKhoeTkRCt-155" value="&lt;b&gt;... ...&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="6560" y="400" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="Zjkvj3zQzHno8zV3FjKx-1" value="&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 11px;&quot;&gt;Quarkus 所有构建项：https://cn.quarkus.io/guides/all-builditems&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="6560" y="120" width="340" height="30" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
