<mxfile host="Electron" modified="2024-01-09T11:05:25.732Z" agent="Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/21.6.5 Chrome/114.0.5735.243 Electron/25.3.1 Safari/537.36" etag="h_MkXWay7CgbnftwQKtV" version="21.6.5" type="device">
  <diagram name="第 1 页" id="0Qyq6zLl2fmwNNAztLvH">
    <mxGraphModel dx="3628" dy="1872" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="omU1pgqW6LJjpDUwzffS-109" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.75;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;endArrow=diamondThin;endFill=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-96" target="LEzOs3IW3RDwebMgTtXX-26">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-1" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-86" target="VcwutDj3bW0QsIIaURAk-49" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1029.9999999999995" y="830.1764705882354" as="targetPoint" />
            <Array as="points">
              <mxPoint x="820" y="830" />
              <mxPoint x="820" y="505" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-49" value="1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="LEzOs3IW3RDwebMgTtXX-1" vertex="1" connectable="0">
          <mxGeometry x="-0.9223" y="2" relative="1" as="geometry">
            <mxPoint y="-7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="30zH5Bm8l3Furl-t-DYP-1" value="&lt;h1 style=&quot;font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;Dubbo工作原理 &lt;/font&gt;&lt;font style=&quot;font-size: 16px; font-weight: normal;&quot;&gt;（3.2.9）&lt;/font&gt;&lt;/h1&gt;&lt;p style=&quot;font-size: 10px;&quot;&gt;Dubbo3 是在云原生背景下诞生的，使用 Dubbo 构建的微服务遵循云原生思想，能更好的复用底层云原生基础设施、贴合云原生微服务架构。&lt;br&gt;Spring初始化相关代码流程做了简化，详细参考 spring-context.drawio。&lt;br&gt;官方源码解析：&lt;span style=&quot;background-color: initial;&quot;&gt;https://cn.dubbo.apache.org/zh-cn/blog/java/codeanalysis/3.0.8/ (个人感觉官方源码解析写的东西还是碎片化的，没多大帮助)&lt;/span&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="40" y="10" width="680" height="100" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-8" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-1" target="VcwutDj3bW0QsIIaURAk-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-9" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-1" target="VcwutDj3bW0QsIIaURAk-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-1" value="服务提供者" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="40" y="220" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-11" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-2" target="VcwutDj3bW0QsIIaURAk-10" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="340" y="250" />
              <mxPoint x="340" y="730" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-26" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-2" target="VcwutDj3bW0QsIIaURAk-22" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-27" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-2" target="VcwutDj3bW0QsIIaURAk-24" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-2" value="自动配置&lt;br&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#007fff&quot;&gt;一些自动配置类&lt;br&gt;先看个大概，后面用到再逆向看&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="200" y="220" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-3" value="接口层" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="40" y="120" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-20" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-4" target="VcwutDj3bW0QsIIaURAk-15" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-21" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-4" target="VcwutDj3bW0QsIIaURAk-17" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-29" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-4" target="VcwutDj3bW0QsIIaURAk-28" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-4" value="服务消费者" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="40" y="4000" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-6" value="&lt;font color=&quot;#007fff&quot;&gt;提供接口定义，用于服务提供者和消费者生成远程调用的服务端和客户端Stub&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="170" y="120" width="230" height="60" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-13" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-7" target="VcwutDj3bW0QsIIaURAk-12" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-7" value="系统初始化&lt;br&gt;&lt;font style=&quot;font-size: 9px;&quot; color=&quot;#007fff&quot;&gt;&lt;b&gt;自动配置&lt;/b&gt;属于系统初始化，只不过总是先看自动配置的代码用于提供读源码的切入点&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="200" y="800" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-74" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-10" target="VcwutDj3bW0QsIIaURAk-73" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-10" value="@EnableDubbo" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="360" y="700" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-87" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-12" target="VcwutDj3bW0QsIIaURAk-86" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-88" value="..." style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="VcwutDj3bW0QsIIaURAk-87" vertex="1" connectable="0">
          <mxGeometry x="-0.263" y="-2" relative="1" as="geometry">
            <mxPoint x="5" y="-2" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-65" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-12" target="LEzOs3IW3RDwebMgTtXX-59" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="570" y="830" />
              <mxPoint x="570" y="990" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-66" value="..." style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="LEzOs3IW3RDwebMgTtXX-65" vertex="1" connectable="0">
          <mxGeometry x="0.7415" relative="1" as="geometry">
            <mxPoint x="6" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-98" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-12" target="LEzOs3IW3RDwebMgTtXX-97" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-101" value="..." style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="LEzOs3IW3RDwebMgTtXX-98" vertex="1" connectable="0">
          <mxGeometry x="-0.571" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-106" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-12" target="LEzOs3IW3RDwebMgTtXX-105" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="570" y="830" />
              <mxPoint x="570" y="1770" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-94" value="..." style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="LEzOs3IW3RDwebMgTtXX-106">
          <mxGeometry x="0.9637" y="-2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-115" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-12" target="LEzOs3IW3RDwebMgTtXX-114" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="570" y="830" />
              <mxPoint x="570" y="1070" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-92" value="..." style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="LEzOs3IW3RDwebMgTtXX-115">
          <mxGeometry x="0.8841" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-118" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-12" target="LEzOs3IW3RDwebMgTtXX-116" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="570" y="830" />
              <mxPoint x="570" y="1930" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-95" value="..." style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="LEzOs3IW3RDwebMgTtXX-118">
          <mxGeometry x="0.9594" y="3" relative="1" as="geometry">
            <mxPoint x="3" y="3" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-122" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-12" target="LEzOs3IW3RDwebMgTtXX-121" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="570" y="830" />
              <mxPoint x="570" y="1150" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-93" value="..." style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="LEzOs3IW3RDwebMgTtXX-122">
          <mxGeometry x="0.8799" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-12" value="&lt;b&gt;invokeBeanFactoryPostProcessors&lt;/b&gt;(&lt;br&gt;beanFactory);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;执行BeanFactory后置处理&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;主要是针对 BeanDefinition&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="360" y="800" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-14" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-15" target="VcwutDj3bW0QsIIaURAk-18" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-15" value="自动配置&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;一些自动配置类&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="200" y="4000" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-16" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-17" target="VcwutDj3bW0QsIIaURAk-19" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-17" value="服务发现" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="200" y="4100" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-18" value="@EnableDubbo" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="360" y="4000" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-19" value="&amp;nbsp;@DubboReference" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="360" y="4100" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-31" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-22" target="VcwutDj3bW0QsIIaURAk-30" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-22" value="dubbo-spring-boot-starter&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;核心功能配置&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="360" y="220" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-72" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-24" target="VcwutDj3bW0QsIIaURAk-71" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-24" value="dubbo-nacos-spring-boot-starter&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;服务发现功能配置，支持Nacos、ZK、Consul、ETCD, 这里以Nacos为例&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="360" y="460" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-28" value="远程调用" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="200" y="4200" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-33" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-30" target="VcwutDj3bW0QsIIaURAk-32" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-38" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-30" target="VcwutDj3bW0QsIIaURAk-34" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-39" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-30" target="VcwutDj3bW0QsIIaURAk-36" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-30" value="dubbo-spring-boot-autoconfigure&lt;br&gt;内部依赖&amp;nbsp;&lt;br&gt;dubbo-spring-boot-autoconfigure-compatible" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="600" y="220" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-41" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-32" target="VcwutDj3bW0QsIIaURAk-40" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-44" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-32" target="VcwutDj3bW0QsIIaURAk-42" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1060" y="250" />
              <mxPoint x="1060" y="330" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-32" value="DubboRelaxedBinding2AutoConfiguration&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;@ConditionalOnProperty 属性条件：dubbo.enabled = true, 默认就是true&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="840" y="220" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-46" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-34" target="VcwutDj3bW0QsIIaURAk-45" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-48" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-34" target="VcwutDj3bW0QsIIaURAk-47" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-53" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-34" target="VcwutDj3bW0QsIIaURAk-51" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-34" value="DubboAutoConfiguration" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="840" y="380" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-36" value="DubboRelaxedBindingAutoConfiguration&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;DubboRelaxedBinding2AutoConfiguration&lt;br&gt;存在的话此配置类不会起作用&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="840" y="300" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-59" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.25;entryDx=0;entryDy=0;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-40" target="VcwutDj3bW0QsIIaURAk-51" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1290" y="250" />
              <mxPoint x="1290" y="560" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-40" value="@Bean(name = BASE_PACKAGES_BEAN_NAME)&lt;br style=&quot;font-size: 10px;&quot;&gt;Set&amp;lt;String&amp;gt; dubboBasePackages(...)&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;内部通过PropertyResolver读取base-packages&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="1080" y="220" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-42" value="&lt;div style=&quot;font-size: 9px;&quot;&gt;@Bean(RELAXED_DUBBO_CONFIG&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;_BINDER_BEAN_NAME)&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;span style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; @Scope(scopeName = &lt;/span&gt;&lt;font style=&quot;font-size: 8px;&quot;&gt;SCOPE_PROTOTYPE&lt;/font&gt;)&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;b style=&quot;font-size: 9px;&quot;&gt;ConfigurationBeanBinder&lt;/b&gt; relaxedDubboConfigBinder()&lt;br style=&quot;font-size: 9px;&quot;&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="1080" y="300" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-45" value="@EnableConfigurationProperties({&lt;br&gt;&lt;b&gt;DubboConfigurationProperties&lt;/b&gt;.class})&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;Dubbo配置属性类&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="1080" y="380" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-50" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-47" target="VcwutDj3bW0QsIIaURAk-49" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-3" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-47" target="LEzOs3IW3RDwebMgTtXX-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-47" value="@EnableDubboConfig" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1080" y="460" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-5" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-49" target="LEzOs3IW3RDwebMgTtXX-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-49" value="@Import({&lt;br style=&quot;font-size: 9px;&quot;&gt;&lt;b style=&quot;font-size: 9px;&quot;&gt;DubboConfigConfigurationRegistrar&lt;/b&gt;.class})" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="1320" y="460" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-51" value="创建 &lt;b&gt;ServiceAnnotationPostProcessor&lt;/b&gt;&amp;nbsp;类型Bean通过&amp;nbsp;@Qualifier(BASE_PACKAGES_BEAN_NAME) 注入依赖&amp;nbsp;dubboBasePackages&lt;br&gt;&lt;font style=&quot;font-size: 9px;&quot; color=&quot;#007fff&quot;&gt;如果没有设置 dubbo.scan.base-packages 属性不会创建，测试DEMO没有配置此属性&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="1080" y="540" width="200" height="80" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-58" value="&lt;font color=&quot;#007fff&quot; style=&quot;&quot;&gt;创建了一个Bean dubboBasePackages&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;span style=&quot;font-size: 10px;&quot;&gt;内容是Dubbo base-packages 列表&lt;/span&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1300" y="230" width="190" height="40" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-60" value="&lt;font color=&quot;#007fff&quot; style=&quot;&quot;&gt;创建了一个Bean relaxedDubboConfigBinder&lt;br style=&quot;font-size: 10px;&quot;&gt;TODO 用途&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1300" y="310" width="220" height="40" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-63" value="后面忽略一些ApplicationListener &lt;br style=&quot;font-size: 10px;&quot;&gt;和 应用上下文初始化器" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontColor=#007FFF;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="615" y="280" width="170" height="40" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-68" value="&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&lt;br&gt;&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="1770" y="475" width="20" height="30" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-71" value="依赖 nacos-client" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="600" y="460" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-77" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-73" target="VcwutDj3bW0QsIIaURAk-76" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-73" value="&lt;div&gt;@EnableDubboConfig&lt;/div&gt;&lt;div&gt;&lt;b&gt;@DubboComponentScan&lt;/b&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="600" y="700" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-79" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-76" target="VcwutDj3bW0QsIIaURAk-78" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-76" value="@Import(&lt;br&gt;&lt;b&gt;DubboComponentScanRegistrar&lt;/b&gt;.class)&lt;br&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 9px;&quot;&gt;主要是扫描 @DubboComponentScan basePakcages、basePackageClasses，&lt;/font&gt;&lt;span style=&quot;color: rgb(0, 127, 255); background-color: initial;&quot;&gt;@EnableDubbo scanBasePackages、scanBasePackageClasses 注册Bean定义&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="840" y="690" width="200" height="80" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-52" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-78" target="LEzOs3IW3RDwebMgTtXX-22" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1780" y="730" />
              <mxPoint x="1780" y="505" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-54" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-78" target="LEzOs3IW3RDwebMgTtXX-53" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-63" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.25;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;fillColor=#d5e8d4;strokeColor=#82b366;dashed=1;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-78" target="LEzOs3IW3RDwebMgTtXX-4" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1540" y="715" />
              <mxPoint x="1540" y="505" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-78" value="&lt;div&gt;DubboSpringInitializer.initialize(registry);&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;前面已经执行过一次了，这次就不会再初始化了&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1080" y="700" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-84" value="&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;如果想研究Dubbo服务一步步怎么启动的可以参考&lt;br&gt;日志输出，给对应的类加断点一步步调试，也可以顺着自动配置类一步步深入&lt;br&gt;&lt;br&gt;如果只想看关键点实现原理，可以通过注解类、NacosClient&amp;nbsp;&lt;br&gt;接口等找到相应代码加端点调试&lt;br&gt;&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="200" y="290" width="280" height="90" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-85" value="&lt;b&gt;Spring refresh()&lt;/b&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="405" y="770" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-50" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;rounded=1;" parent="1" source="VcwutDj3bW0QsIIaURAk-86" target="VcwutDj3bW0QsIIaURAk-76" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="830" y="830" />
              <mxPoint x="830" y="750" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-51" value="2" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="LEzOs3IW3RDwebMgTtXX-50" vertex="1" connectable="0">
          <mxGeometry x="-0.346" y="1" relative="1" as="geometry">
            <mxPoint y="-9" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-86" value="&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&lt;b&gt;registrars&lt;/b&gt;.forEach((registrar, metadata) -&amp;gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;registrar.registerBeanDefinitions(metadata, this.registry,this.importBeanNameGenerator));&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 9px;&quot;&gt;遍历所有ImportBeanDefinitionRegistrar实例注册BeanDefinition，这里只关注Dubbo的&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="600" y="800" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="VcwutDj3bW0QsIIaURAk-89" value="&lt;font style=&quot;font-size: 10px;&quot;&gt;ConfigurationClassBeanDefinitionReader&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="595" y="770" width="210" height="30" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-2" value="boolean &lt;b&gt;multiple&lt;/b&gt;() default true;&lt;br&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;用于选择Bean实现 DubboConfigConfiguration.&lt;b&gt;Single&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;或 DubboConfigConfiguration.&lt;b&gt;Multiple&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="1320" y="380" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-7" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-22" target="LEzOs3IW3RDwebMgTtXX-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-4" value="&lt;b&gt;DubboSpringInitializer&lt;/b&gt;.initialize(registry);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;registry是Bean工厂&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="1560" y="460" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-15" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-6" target="LEzOs3IW3RDwebMgTtXX-14" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-17" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-6" target="LEzOs3IW3RDwebMgTtXX-16" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-6" value="customize(context);&lt;br style=&quot;font-size: 10px;&quot;&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="2040" y="460" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-21" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;endArrow=diamondThin;endFill=1;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-12" target="LEzOs3IW3RDwebMgTtXX-13" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-450" y="730" />
              <mxPoint x="-450" y="760" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-12" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center; font-size: 10px;&quot;&gt;&lt;b style=&quot;font-size: 10px;&quot;&gt;DubboSpringInitializer &lt;/b&gt;&lt;span style=&quot;font-size: 10px;&quot;&gt;Dubbo初始化上下文的容器&lt;/span&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;//Dubbo初始化上下文Map&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;private static final Map&amp;lt;BeanDefinitionRegistry, DubboSpringInitContext&amp;gt; &lt;b&gt;contextMap&lt;/b&gt; =&amp;nbsp;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&amp;nbsp; new ConcurrentHashMap&amp;lt;&amp;gt;();&lt;/p&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;public static void initialize(BeanDefinitionRegistry registry)&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="-440" y="680" width="400" height="100" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-27" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;endArrow=diamondThin;endFill=1;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-13" target="LEzOs3IW3RDwebMgTtXX-26" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-13" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;DubboSpringInitContext&lt;/b&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;private BeanDefinitionRegistry registry;&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private ConfigurableListableBeanFactory beanFactory;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private ApplicationContext applicationContext;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;//&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private &lt;b&gt;ModuleModel&lt;/b&gt; moduleModel;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;//&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 9px;&quot;&gt;private final Map&amp;lt;String, Object&amp;gt; &lt;b&gt;moduleAttributes&lt;/b&gt; = new HashMap&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot; color=&quot;#007fff&quot;&gt;//这里绑定的意思是DubboSpringInitContext、ApplicationModel、ModuleModel是否已经注册到Spring Bean容器&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile boolean &lt;b&gt;bound&lt;/b&gt;;&lt;/p&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="-920" y="680" width="440" height="160" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-43" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-14" target="LEzOs3IW3RDwebMgTtXX-42" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-14" value="applicationModel = ApplicationModel.&lt;b&gt;defaultModel&lt;/b&gt;();&lt;br style=&quot;font-size: 10px;&quot;&gt;moduleModel = applicationModel.&lt;b&gt;getDefaultModule&lt;/b&gt;();&lt;br style=&quot;font-size: 10px;&quot;&gt;context.setModuleModel(moduleModel);" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;" parent="1" vertex="1">
          <mxGeometry x="2040" y="620" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-19" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-16" target="LEzOs3IW3RDwebMgTtXX-18" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-41" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-16" target="LEzOs3IW3RDwebMgTtXX-40" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-16" value="&lt;div style=&quot;font-size: 9px;&quot;&gt;Set&amp;lt;DubboSpringInitCustomizer&amp;gt; customizers = FrameworkModel.&lt;b&gt;defaultModel&lt;/b&gt;()&lt;/div&gt;&lt;div style=&quot;&quot;&gt;.getExtensionLoader(&lt;font style=&quot;font-size: 8px;&quot;&gt;&lt;b&gt;DubboSpringInitCustomizer&lt;/b&gt;&lt;/font&gt;.class)&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;.getSupportedExtensionInstances();&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;SPI 加载&amp;nbsp;&lt;b&gt;DubboSpringInitCustomizer&lt;/b&gt; 并遍历执行&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=left;" parent="1" vertex="1">
          <mxGeometry x="2270" y="460" width="220" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-30" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-18" target="LEzOs3IW3RDwebMgTtXX-29" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-18" value="defaultInstance = new &lt;b&gt;FrameworkModel&lt;/b&gt;();&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;初始化了很多内部的组件，TODO 后面用到再回来看，需要结合业务理解&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="2520" y="460" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-25" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;endArrow=block;endFill=0;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-20" target="LEzOs3IW3RDwebMgTtXX-24" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-20" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;FrameworkModel &lt;/b&gt;框架模型, 单例模式&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;public static final String NAME = &quot;FrameworkModel&quot;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private static final AtomicLong index = new AtomicLong(1);&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private static final Object globalLock = new Object();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private &lt;b&gt;static&lt;/b&gt; volatile FrameworkModel &lt;b&gt;defaultInstance&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private &lt;b&gt;static&lt;/b&gt; final List&amp;lt;FrameworkModel&amp;gt; &lt;b&gt;allInstances&lt;/b&gt; = new CopyOnWriteArrayList&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final AtomicLong appIndex = new AtomicLong(0);&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile ApplicationModel &lt;b&gt;defaultAppModel&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;//内部包含的 ApplicationModel&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final List&amp;lt;ApplicationModel&amp;gt; &lt;b&gt;applicationModels&lt;/b&gt; = new CopyOnWriteArrayList&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final List&amp;lt;ApplicationModel&amp;gt; &lt;b&gt;pubApplicationModels&lt;/b&gt; = new CopyOnWriteArrayList&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final FrameworkServiceRepository &lt;b&gt;serviceRepository&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ApplicationModel &lt;b&gt;internalApplicationModel&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ReentrantLock destroyLock = new ReentrantLock();&lt;/p&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;public ApplicationModel getApplicationModel()&amp;nbsp;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="-1400" y="400" width="440" height="220" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-23" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-4" target="LEzOs3IW3RDwebMgTtXX-22" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1760" y="490" as="sourcePoint" />
            <mxPoint x="2040" y="490" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-22" value="创建初始化上下文 &lt;b&gt;DubboSpringInitContext&lt;/b&gt; 实例，然后执行初始化" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="1800" y="460" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-24" value="&lt;div style=&quot;text-align: center;&quot;&gt;&lt;b&gt;ScopeModel &lt;/b&gt;(A)&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private String internalId; &lt;font color=&quot;#007fff&quot;&gt;//模型的层次结构&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private String modelName; &lt;font color=&quot;#007fff&quot;&gt;//公共模型名称&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private String desc;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Set&amp;lt;ClassLoader&amp;gt; classLoaders = new ConcurrentHashSet&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ScopeModel parent;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;//当前模型的所属域ExtensionScope有:FRAMEWORK(框架)，APPLICATION(应用)，MODULE(模块)，SELF(自给自足，为每个作用域创建一个实例，用于特殊的SPI扩展，如ExtensionInjector)&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ExtensionScope &lt;b&gt;scope&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;//&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile ExtensionDirector &lt;b&gt;extensionDirector&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;//&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile ScopeBeanFactory &lt;b&gt;beanFactory&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final List&amp;lt;ScopeModelDestroyListener&amp;gt; destroyListeners = new CopyOnWriteArrayList&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final List&amp;lt;ScopeClassLoaderListener&amp;gt; classLoaderListeners = new CopyOnWriteArrayList&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Map&amp;lt;String, Object&amp;gt; attributes = new ConcurrentHashMap&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final AtomicBoolean destroyed = new AtomicBoolean(false);&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final boolean internalScope;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;protected final Object instLock = new Object();&lt;/p&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="-1400" y="40" width="440" height="280" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-28" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;endArrow=block;endFill=0;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-26" target="LEzOs3IW3RDwebMgTtXX-24" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-26" value="&lt;div style=&quot;text-align: center;&quot;&gt;&lt;b&gt;ModuleModel&amp;nbsp;&lt;/b&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;应用的服务模块，不是对应某个具体的组件，也可能是一组组件的集合&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;public static final String NAME = &quot;ModuleModel&quot;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;//所属的ApplicationModel&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ApplicationModel applicationModel;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;//&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile ModuleServiceRepository serviceRepository;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;//&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile ModuleEnvironment moduleEnvironment;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;// 一组组件配置的容器&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile &lt;b&gt;ModuleConfigManager&lt;/b&gt; &lt;b&gt;moduleConfigManager&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;// 服务模块的起动器&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile &lt;b&gt;ModuleDeployer&lt;/b&gt; &lt;b&gt;deployer&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private boolean lifeCycleManagedExternally = false;&lt;/p&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="-920" y="400" width="440" height="220" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-32" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-29" target="LEzOs3IW3RDwebMgTtXX-31" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-29" value="initialize();" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="2760" y="460" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-34" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-31" target="LEzOs3IW3RDwebMgTtXX-33" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-31" value="TypeDefinitionBuilder.initBuilders(this);" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="2760" y="540" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-36" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-33" target="LEzOs3IW3RDwebMgTtXX-35" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2860" y="690" />
              <mxPoint x="2900" y="690" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-33" value="serviceRepository = new FrameworkServiceRepository(this);" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="2760" y="620" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-38" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-35" target="LEzOs3IW3RDwebMgTtXX-37" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2900" y="790" />
              <mxPoint x="2960" y="790" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-35" value="&lt;div&gt;ExtensionLoader&amp;lt;ScopeModelInitializer&amp;gt; initializerExtensionLoader =&lt;/div&gt;&lt;div&gt;this.getExtensionLoader(&lt;b&gt;ScopeModelInitializer&lt;/b&gt;.class);&lt;/div&gt;&lt;div&gt;Set&amp;lt;ScopeModelInitializer&amp;gt; &lt;b&gt;initializers&lt;/b&gt; = initializerExtensionLoader.getSupportedExtensionInstances();&lt;/div&gt;&lt;div&gt;for (ScopeModelInitializer initializer : &lt;b&gt;initializers&lt;/b&gt;) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; initializer.&lt;b&gt;initializeFrameworkModel&lt;/b&gt;(this);&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=left;arcSize=7;" parent="1" vertex="1">
          <mxGeometry x="2760" y="700" width="280" height="80" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-37" value="&lt;div&gt;internalApplicationModel = new &lt;b&gt;ApplicationModel&lt;/b&gt;(this, true);&lt;/div&gt;&lt;div&gt;internalApplicationModel&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; .getApplicationConfigManager()&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; .setApplication(new &lt;b&gt;ApplicationConfig&lt;/b&gt;(&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; internalApplicationModel, CommonConstants.DUBBO_INTERNAL_APPLICATION));&lt;/div&gt;&lt;div&gt;internalApplicationModel.setModelName(CommonConstants.DUBBO_INTERNAL_APPLICATION);&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=left;arcSize=7;" parent="1" vertex="1">
          <mxGeometry x="2760" y="800" width="400" height="80" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-39" value="initializers = {LinkedHashSet@5781}  size = 14&#xa; 0 = {CertScopeModelInitializer@5784} &#xa; 1 = {ClusterScopeModelInitializer@5788} &#xa; 2 = {CommonScopeModelInitializer@5789} &#xa; 3 = {ConfigScopeModelInitializer@5790} &#xa; 4 = {SpringScopeModelInitializer@5791} &#xa; 5 = {MetadataScopeModelInitializer@5792} &#xa; 6 = {MetricsScopeModelInitializer@5793} &#xa; 7 = {RegistryScopeModelInitializer@5794} &#xa; 8 = {RemotingScopeModelInitializer@5795} &#xa; 9 = {Fastjson2ScopeModelInitializer@5796} &#xa; 10 = {Hessian2ScopeModelInitializer@5797} &#xa; 11 = {QosScopeModelInitializer@5798} &#xa; 12 = {RpcScopeModelInitializer@5799} &#xa; 13 = {XdsScopeModelInitializer@5800}" style="text;whiteSpace=wrap;fontSize=10;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="3050" y="600" width="280" height="190" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-40" value="&lt;div&gt;DubboSpringInitCustomizerHolder customizerHolder = DubboSpringInitCustomizerHolder.get();&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;customizers = customizerHolder.getCustomizers();&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;/div&gt;&lt;font color=&quot;#007fff&quot;&gt;从 DubboSpringInitCustomizerHolder 读取&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;b&gt;DubboSpringInitCustomizer&lt;/b&gt; 并遍历执行&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=left;" parent="1" vertex="1">
          <mxGeometry x="2270" y="540" width="220" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-45" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-42" target="LEzOs3IW3RDwebMgTtXX-44" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-48" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-42" target="LEzOs3IW3RDwebMgTtXX-104" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2280" y="840" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2260" y="730" />
              <mxPoint x="2260" y="840" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-42" value="&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;b style=&quot;font-size: 9px;&quot;&gt;registerContextBeans&lt;/b&gt;(beanFactory, context);&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;context.markAsBound();&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;moduleModel.setLifeCycleManagedExternally(true);&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;DubboBeanUtils.&lt;b style=&quot;font-size: 9px;&quot;&gt;registerCommonBeans&lt;/b&gt;(registry);&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=left;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2030" y="700" width="220" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-44" value="&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;div&gt;registerSingleton(beanFactory, &lt;b&gt;context&lt;/b&gt;);&lt;/div&gt;&lt;div&gt;registerSingleton(beanFactory, &lt;br&gt;&amp;nbsp; context.&lt;b&gt;getApplicationModel&lt;/b&gt;());&lt;/div&gt;&lt;div&gt;registerSingleton(beanFactory, &lt;br&gt;&amp;nbsp; context.&lt;b&gt;getModuleModel&lt;/b&gt;());&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="2280" y="700" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-46" value="&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;将DubboSpringInitContext、ApplicationModel、&lt;br&gt;ModuleModel 实例注册到Spring容器&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="2481" y="710" width="240" height="40" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-56" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-53" target="LEzOs3IW3RDwebMgTtXX-55" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-53" value="Set&amp;lt;String&amp;gt; packagesToScan = getPackagesToScan(&lt;br&gt;importingClassMetadata);&lt;br&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 9px;&quot;&gt;从注解中提取需要扫描的包路径，测试DEMO中就是“org.apache.dubbo.springboot.demo.provider”&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1080" y="780" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-58" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-55" target="LEzOs3IW3RDwebMgTtXX-57" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-55" value="registerServiceAnnotationPostProcessor(&lt;br&gt;packagesToScan, registry);" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1080" y="860" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-60" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-57" target="LEzOs3IW3RDwebMgTtXX-59" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1420" y="950" />
              <mxPoint x="705" y="950" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-57" value="BeanDefinitionBuilder builder = rootBeanDefinition(&lt;br&gt;&lt;b&gt;&amp;nbsp; ServiceAnnotationPostProcessor&lt;/b&gt;.class);&lt;br&gt;AbstractBeanDefinition beanDefinition = &lt;br&gt;&amp;nbsp; builder.getBeanDefinition();&lt;br style=&quot;font-size: 9px;&quot;&gt;BeanDefinitionReaderUtils.registerWithGeneratedName(&lt;br&gt;&amp;nbsp; beanDefinition, registry);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;注册了ServiceAnnotationPostProcessor 这个后置处理器BeanDefinition&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=left;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="1300" y="840" width="240" height="100" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-68" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-59" target="LEzOs3IW3RDwebMgTtXX-67" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-72" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-59" target="LEzOs3IW3RDwebMgTtXX-71" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-96" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-59" target="LEzOs3IW3RDwebMgTtXX-95" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-59" value="&lt;b style=&quot;font-size: 10px;&quot;&gt;ServiceAnnotationPostProcessor&lt;/b&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;实现 BeanDefinitionRegistryPostProcessor 接口，用于扫描Dubbo服务的BeanDefinition&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="600" y="960" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-70" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-67" target="LEzOs3IW3RDwebMgTtXX-69" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-67" value="&lt;font style=&quot;font-size: 10px;&quot;&gt;ServiceAnnotationPostProcessor#&lt;br&gt;&lt;b&gt;afterPropertiesSet&lt;/b&gt;()&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;前面定义了此后置处理器的Bean定义，此后置处理器也需要先创建自身的Bean，然后为其他Bean执行后置处理，自身的Bean初始化后执行此方法&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="840" y="960" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-69" value="this.&lt;b style=&quot;font-size: 10px;&quot;&gt;resolvedPackagesToScan&lt;/b&gt; = resolvePackagesToScan(packagesToScan);" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" parent="1" vertex="1">
          <mxGeometry x="1080" y="960" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-74" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-71" target="LEzOs3IW3RDwebMgTtXX-73" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-71" value="ServiceAnnotationPostProcessor#&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;b style=&quot;font-size: 10px;&quot;&gt;postProcessBeanDefinitionRegistry&lt;/b&gt;(&lt;br style=&quot;font-size: 10px;&quot;&gt;BeanDefinitionRegistry registry)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="840" y="1200" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-79" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-73" target="LEzOs3IW3RDwebMgTtXX-78" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1340" y="1230" />
              <mxPoint x="1340" y="990" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-73" value="this.registry = registry;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;b style=&quot;font-size: 10px;&quot;&gt;scanServiceBeans&lt;/b&gt;(&lt;br style=&quot;font-size: 10px;&quot;&gt;resolvedPackagesToScan, registry);" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" parent="1" vertex="1">
          <mxGeometry x="1080" y="1200" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-5" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;dashed=1;endArrow=block;endFill=0;fontSize=11;rounded=1;" edge="1" parent="1" source="LEzOs3IW3RDwebMgTtXX-75" target="omU1pgqW6LJjpDUwzffS-2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-75" value="&lt;div style=&quot;text-align: center;&quot;&gt;&lt;b&gt;ServiceAnnotationPostProcessor&lt;/b&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;/p&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp;此后置处理器用于扫描Dubbo服务（@DubboService @Service）并注册BeanDefinition&lt;br&gt;&lt;br&gt;&lt;/font&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;public static final String BEAN_NAME = &quot;dubboServiceAnnotationPostProcessor&quot;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;// 扫描的注解类型，Dubbo服务定义注解是 @DubboService @Service (不是Spring的 @Service)&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private static final List&amp;lt;Class&amp;lt;? extends Annotation&amp;gt;&amp;gt; &lt;b&gt;serviceAnnotationTypes&lt;/b&gt; = &lt;br&gt;&amp;nbsp; loadServiceAnnotationTypes();&lt;/p&gt;&amp;nbsp; &lt;font color=&quot;#007fff&quot;&gt;//原始需要扫描的包路径，可以通过配置文件、注解修改&lt;/font&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;protected final Set&amp;lt;String&amp;gt; &lt;b&gt;packagesToScan&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;//经过处理后最终需要扫描的包路径（比如原始包路径可能有多个使用分隔符连接）&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private Set&amp;lt;String&amp;gt; &lt;b&gt;resolvedPackagesToScan&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private Environment environment;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private ResourceLoader resourceLoader;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private ClassLoader classLoader;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private BeanDefinitionRegistry &lt;b&gt;registry&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;//已经扫描过的包和类的记录器，用于ExcludeFilter防止重复扫描&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private ServicePackagesHolder &lt;b&gt;servicePackagesHolder&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;//是否已经开始扫描BeanDefinition&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile boolean &lt;b&gt;scanned&lt;/b&gt; = false;&lt;/p&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="-480" y="1120" width="440" height="280" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-81" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-78" target="LEzOs3IW3RDwebMgTtXX-80" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-78" value="&lt;div&gt;DubboClassPathBeanDefinitionScanner scanner =&amp;nbsp;&lt;span style=&quot;background-color: initial;&quot;&gt;new&amp;nbsp;&lt;b&gt;DubboClassPathBeanDefinitionScanner&lt;/b&gt;(&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;registry, environment, resourceLoader);&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;Dubbo 重写了BeanDefinition扫描器用于扫描Dubbo服务&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="1361" y="960" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-83" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-80" target="LEzOs3IW3RDwebMgTtXX-82" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-80" value="&lt;div&gt;for (Class&amp;lt;? extends Annotation&amp;gt; annotationType &lt;br&gt;&amp;nbsp; &amp;nbsp; : &lt;b&gt;serviceAnnotationTypes&lt;/b&gt;) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; scanner.&lt;b&gt;addIncludeFilter&lt;/b&gt;(new &lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;AnnotationTypeFilter(annotationType));&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;给每个注解类型注册了一个过滤器&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;即用于过滤 &lt;b&gt;@DubboService&lt;/b&gt; &lt;b&gt;@Service&lt;/b&gt;注解的类&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=left;arcSize=9;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="1360" y="1040" width="200" height="80" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-85" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-82" target="LEzOs3IW3RDwebMgTtXX-84" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-82" value="&lt;div&gt;&lt;div&gt;ScanExcludeFilter scanExcludeFilter = new ScanExcludeFilter();&lt;/div&gt;&lt;div&gt;scanner.addExcludeFilter(scanExcludeFilter);&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;还注册了一个排除过滤器，看实现是防止重复扫描的&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=left;arcSize=9;" parent="1" vertex="1">
          <mxGeometry x="1361" y="1140" width="200" height="80" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-87" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-84" target="LEzOs3IW3RDwebMgTtXX-86" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-84" value="&lt;div&gt;for (String packageToScan : packagesToScan)：&lt;br&gt;&lt;/div&gt;&lt;div&gt;scanner.&lt;b&gt;scan&lt;/b&gt;(packageToScan);&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;遍历所有包路径执行扫描，扫描到的类的BeanDefinition 注册到Spring Bean容器，在 &lt;b&gt;beanDefinitionMap&lt;/b&gt; 中可以查到&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=left;arcSize=9;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="1361" y="1240" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-89" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-86" target="LEzOs3IW3RDwebMgTtXX-88" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-86" value="&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;Set&amp;lt;BeanDefinitionHolder&amp;gt; beanDefinitionHolders =&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;findServiceBeanDefinitionHolders(scanner, packageToScan, registry, beanNameGenerator);&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 9px;&quot;&gt;又扫描了一次，这次将BeanDefinition和BeanName封装成了BeanDefinitionHolder&lt;br style=&quot;font-size: 9px;&quot;&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=left;arcSize=9;" parent="1" vertex="1">
          <mxGeometry x="1356" y="1320" width="210" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-91" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-88" target="LEzOs3IW3RDwebMgTtXX-90" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-88" value="&lt;div style=&quot;&quot;&gt;&lt;div style=&quot;&quot;&gt;for &lt;b&gt;beanDefinitionHolders&lt;/b&gt;:&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;b&gt;processScannedBeanDefinition&lt;/b&gt;(&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; beanDefinitionHolder);&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;遍历第二次扫描获取的BeanDefinitionHolder，依次&lt;b&gt;创建&lt;/b&gt;并注册RootBeanDefinition实例到Spring容器&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=left;arcSize=9;" parent="1" vertex="1">
          <mxGeometry x="1356" y="1400" width="210" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-90" value="&lt;div style=&quot;&quot;&gt;&lt;div style=&quot;&quot;&gt;registry.&lt;b&gt;registerBeanDefinition&lt;/b&gt;(&lt;/div&gt;&lt;div style=&quot;&quot;&gt;serviceBeanName, serviceBeanDefinition);&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;如果已经注册且是同一BeanDefinition就直接返回，不是同一个就抛异常，没有注册就重新注册&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;arcSize=9;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="1601" y="1400" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-51" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" edge="1" parent="1" source="LEzOs3IW3RDwebMgTtXX-95" target="omU1pgqW6LJjpDUwzffS-50">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-95" value="&lt;font style=&quot;font-size: 10px;&quot;&gt;ServiceAnnotationPostProcessor#&lt;br style=&quot;&quot;&gt;&lt;/font&gt;&lt;b style=&quot;font-size: 9px;&quot;&gt;postProcessBeanFactory&lt;/b&gt;(&lt;br style=&quot;font-size: 9px;&quot;&gt;ConfigurableListableBeanFactory beanFactory)&lt;br style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-weight: bold; font-size: 9px;&quot; color=&quot;#007fff&quot;&gt;处理配置类中 @Bean方法的 Dubbo Service注解&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="840" y="1640" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-100" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-97" target="LEzOs3IW3RDwebMgTtXX-99" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-109" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-97" target="LEzOs3IW3RDwebMgTtXX-107" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="580" y="2230" />
              <mxPoint x="580" y="2410" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-123" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-97" target="LEzOs3IW3RDwebMgTtXX-120" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-97" value="&lt;div&gt;&lt;b&gt;finishBeanFactoryInitialization&lt;/b&gt;(&lt;/div&gt;&lt;div&gt;beanFactory)&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;Bean实例化与初始化&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="360" y="2200" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-111" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontSize=11;rounded=1;" parent="1" source="LEzOs3IW3RDwebMgTtXX-99" target="LEzOs3IW3RDwebMgTtXX-110" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="560" y="2790" />
              <mxPoint x="560" y="2790" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-99" value="&lt;div&gt;&lt;b&gt;finishRefresh()&lt;/b&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="360" y="2760" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-104" value="&lt;div style=&quot;&quot;&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;又往Spring容器注册了几个&lt;b&gt;BeanDefinition&lt;/b&gt;:&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;ServicePackagesHolder&lt;br style=&quot;font-size: 9px;&quot;&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;b&gt;ReferenceBeanManager&lt;/b&gt;&lt;br style=&quot;font-size: 9px;&quot;&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;ReferenceAnnotationBeanPostProcessor&lt;br style=&quot;font-size: 9px;&quot;&gt;DubboConfigAliasPostProcessor&lt;br style=&quot;font-size: 9px;&quot;&gt;DubboDeployApplicationListener&lt;br style=&quot;font-size: 9px;&quot;&gt;DubboConfigApplicationListener&lt;br style=&quot;font-size: 9px;&quot;&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 8px;&quot;&gt;DubboConfigDefaultPropertyValueBeanPostProcessor&lt;/font&gt;&lt;br style=&quot;font-size: 9px;&quot;&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;DubboConfigBeanInitializer&lt;br style=&quot;font-size: 9px;&quot;&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;DubboInfraBeanRegisterPostProcessor&lt;br style=&quot;font-size: 9px;&quot;&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;fillColor=#ffe6cc;strokeColor=#d79b00;arcSize=4;" parent="1" vertex="1">
          <mxGeometry x="2280" y="780" width="201" height="120" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-20" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" edge="1" parent="1" source="LEzOs3IW3RDwebMgTtXX-105" target="omU1pgqW6LJjpDUwzffS-19">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-105" value="&lt;b style=&quot;font-size: 10px;&quot;&gt;ReferenceAnnotationBeanPostProcessor&lt;/b&gt;&lt;font color=&quot;#007fff&quot;&gt;实现了BeanDefinitionRegistryPostProcessor接口，用于扫描Dubbo消费者&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="600" y="1740" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-34" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" edge="1" parent="1" source="LEzOs3IW3RDwebMgTtXX-107" target="omU1pgqW6LJjpDUwzffS-33">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-107" value="&lt;span style=&quot;font-size: 10px;&quot;&gt;&lt;b&gt;DubboConfigBeanInitializer&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;&quot; color=&quot;#007fff&quot;&gt;这是一个普通Bean&lt;/font&gt;&lt;br&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="600" y="2380" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-189" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="LEzOs3IW3RDwebMgTtXX-110" target="omU1pgqW6LJjpDUwzffS-188">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-110" value="&lt;span style=&quot;font-size: 10px;&quot;&gt;DubboDeployApplicationListener#&lt;/span&gt;&lt;br&gt;onApplicationEvent(ApplicationContextEvent event)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="600" y="2760" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-38" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" edge="1" parent="1" source="LEzOs3IW3RDwebMgTtXX-114" target="omU1pgqW6LJjpDUwzffS-37">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="780" y="1070" />
              <mxPoint x="780" y="1070" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-114" value="&lt;b style=&quot;font-size: 10px;&quot;&gt;DubboConfigAliasPostProcessor&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#007fff&quot;&gt;别名处理，就是在Bean初始化后往&lt;br&gt;&lt;/font&gt;&lt;font color=&quot;#007fff&quot;&gt;BeanDefinitionRegistry中给Bean注册一下别名&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="600" y="1040" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-116" value="&lt;span style=&quot;font-size: 10px;&quot;&gt;&lt;b&gt;DubboConfigDefaultPropertyValue&lt;/b&gt;&lt;br&gt;&lt;b&gt;BeanPostProcessor&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;&quot; color=&quot;#007fff&quot;&gt;在Bean初始化之前给Bean设置属性，TODO&lt;/font&gt;&lt;br&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="600" y="1900" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-36" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=11;rounded=1;" edge="1" parent="1" source="LEzOs3IW3RDwebMgTtXX-120" target="omU1pgqW6LJjpDUwzffS-35">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-89" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=11;rounded=1;" edge="1" parent="1" source="LEzOs3IW3RDwebMgTtXX-120" target="omU1pgqW6LJjpDUwzffS-88">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-120" value="&lt;span style=&quot;font-size: 10px;&quot;&gt;&lt;b&gt;ReferenceAnnotationBeanPostProcessor&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;&quot; color=&quot;#007fff&quot;&gt;同时实现了 BeanPostProcessor及其子接口&lt;br&gt;&lt;/font&gt;&lt;font color=&quot;#007fff&quot;&gt;TODO 分析消费者时再细看&lt;/font&gt;&lt;br&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="600" y="2200" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-42" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" edge="1" parent="1" source="LEzOs3IW3RDwebMgTtXX-121" target="omU1pgqW6LJjpDUwzffS-41">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-47" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=11;rounded=1;" edge="1" parent="1" source="LEzOs3IW3RDwebMgTtXX-121" target="omU1pgqW6LJjpDUwzffS-45">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="810" y="1150" />
              <mxPoint x="810" y="1430" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="LEzOs3IW3RDwebMgTtXX-121" value="&lt;b&gt;DubboInfraBeanRegisterPostProcessor&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="600" y="1120" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-1" value="Dubbo注册了很多各种类型后置处理器，&lt;br&gt;最好先梳理下各类型后置处理器及方法的执行时机" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="200" y="880" width="240" height="90" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-4" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;endArrow=block;endFill=0;fontSize=11;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-2" target="omU1pgqW6LJjpDUwzffS-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-2" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;BeanDefinitionRegistryPostProcessor (I)&lt;/b&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;void &lt;/span&gt;&lt;b style=&quot;background-color: initial;&quot;&gt;postProcessBeanDefinitionRegistry&lt;/b&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;(BeanDefinitionRegistry var1) throws BeansException;&lt;/span&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="-480" y="980" width="440" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-3" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;BeanFactoryPostProcessor （I）&lt;/b&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;void &lt;/span&gt;&lt;b style=&quot;background-color: initial;&quot;&gt;postProcessBeanFactory&lt;/b&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;(ConfigurableListableBeanFactory beanFactory) throws BeansException;&lt;/span&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="-480" y="880" width="440" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-8" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.75;exitY=0;exitDx=0;exitDy=0;entryX=0.25;entryY=1;entryDx=0;entryDy=0;dashed=1;endArrow=block;endFill=0;fontSize=11;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-6" target="omU1pgqW6LJjpDUwzffS-3">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-630" y="1360" />
              <mxPoint x="-500" y="1360" />
              <mxPoint x="-500" y="970" />
              <mxPoint x="-370" y="970" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-15" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;endArrow=block;endFill=0;fontSize=11;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-6" target="omU1pgqW6LJjpDUwzffS-11">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-6" value="&lt;div style=&quot;text-align: center;&quot;&gt;&lt;b&gt;ReferenceAnnotationBeanPostProcessor&lt;/b&gt;&lt;br&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;/p&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp;此后置处理器可扫描Dubbo消费者（@DubboReference&amp;nbsp;@Reference）并注册BeanDefinition&lt;br&gt;&lt;br&gt;&lt;/font&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;public static final String BEAN_NAME = &quot;referenceAnnotationBeanPostProcessor&quot;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private static final int CACHE_SIZE = Integer.getInteger(BEAN_NAME + &quot;.cache.size&quot;, 32);&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;//已经解析的注释（创建BeanDefinition并注册到Spring容器和referenceBeanManager&lt;/font&gt;&lt;span style=&quot;color: rgb(0, 127, 255); background-color: initial;&quot;&gt;）有@DubboReference @Reference的&lt;b&gt;字段&lt;/b&gt;的名称&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ConcurrentMap&amp;lt;InjectionMetadata.InjectedElement, String&amp;gt; &lt;b&gt;injectedFieldReferenceBeanCache&lt;/b&gt; =&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; new ConcurrentHashMap&amp;lt;&amp;gt;(CACHE_SIZE);&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;//已经解析的注释（创建BeanDefinition并注册到Spring容器和referenceBeanManager）有@DubboReference @Reference的&lt;b&gt;@Bean方法&lt;/b&gt;的名称&lt;/font&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ConcurrentMap&amp;lt;InjectionMetadata.InjectedElement, String&amp;gt; &lt;b&gt;injectedMethodReferenceBeanCache&lt;/b&gt; =&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; new ConcurrentHashMap&amp;lt;&amp;gt;(CACHE_SIZE);&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private ApplicationContext applicationContext;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private ReferenceBeanManager &lt;b&gt;referenceBeanManager&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private BeanDefinitionRegistry &lt;b&gt;beanDefinitionRegistry&lt;/b&gt;;&lt;/p&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="-960" y="1400" width="440" height="260" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-17" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;endArrow=block;endFill=0;fontSize=11;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-9" target="omU1pgqW6LJjpDUwzffS-16">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-9" value="&lt;div style=&quot;text-align: center;&quot;&gt;&lt;b&gt;MergedBeanDefinitionPostProcessor&lt;/b&gt;&lt;b style=&quot;background-color: initial;&quot;&gt;&amp;nbsp;(I)&lt;/b&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;void postProcessMergedBeanDefinition(RootBeanDefinition beanDefinition, Class&amp;lt;?&amp;gt; beanType, String beanName);&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;void resetBeanDefinition(String beanName)&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="-960" y="980" width="440" height="70" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-13" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;dashed=1;endArrow=block;endFill=0;fontSize=11;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-11" target="omU1pgqW6LJjpDUwzffS-9">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-14" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;dashed=1;endArrow=block;endFill=0;fontSize=11;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-11" target="omU1pgqW6LJjpDUwzffS-12">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-11" value="&lt;div style=&quot;text-align: center;&quot;&gt;&lt;b&gt;AbstractAnnotationBeanPostProcessor&lt;/b&gt;&lt;br&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;/p&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private static final int CACHE_SIZE = Integer.getInteger(&quot;&quot;, 32);&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;//@DubboReference @Reference 还有一个老版本的@Reference&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Class&amp;lt;? extends Annotation&amp;gt;[] &lt;b&gt;annotationTypes&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ConcurrentMap&amp;lt;String, AbstractAnnotationBeanPostProcessor.AnnotatedInjectionMetadata&amp;gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;injectionMetadataCache&lt;/b&gt; = new ConcurrentHashMap&amp;lt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; String, AbstractAnnotationBeanPostProcessor.AnnotatedInjectionMetadata&amp;gt;(CACHE_SIZE);&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private ConfigurableListableBeanFactory &lt;b&gt;beanFactory&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private Environment &lt;b&gt;environment&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private ClassLoader &lt;b&gt;classLoader&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private int order = Ordered.LOWEST_PRECEDENCE;&lt;/p&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="-960" y="1120" width="440" height="200" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-18" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;endArrow=block;endFill=0;fontSize=11;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-12" target="omU1pgqW6LJjpDUwzffS-16">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-12" value="&lt;div style=&quot;text-align: center;&quot;&gt;&lt;b&gt;InstantiationAwareBeanPostProcessor&lt;/b&gt;&lt;b style=&quot;background-color: initial;&quot;&gt;&amp;nbsp;(I)&lt;/b&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;Object postProcessBeforeInstantiation(Class&amp;lt;?&amp;gt; beanClass, String beanName) throws&amp;nbsp;&lt;br&gt;&amp;nbsp; BeansException;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;boolean postProcessAfterInstantiation(Object bean, String beanName) throws BeansException;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;PropertyValues postProcessProperties(PropertyValues pvs, Object bean, String beanName)&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&amp;nbsp; throws BeansException&lt;span style=&quot;&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="-1440" y="980" width="440" height="90" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-16" value="&lt;p style=&quot;margin: 4px 0px 0px; text-align: center;&quot;&gt;&lt;b&gt;BeanFactoryPostProcessor （I）&lt;/b&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;Object postProcessBeforeInitialization(Object bean, String beanName) throws BeansException;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;Object postProcessAfterInitialization(Object bean, String beanName) throws BeansException;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="-960" y="880" width="440" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-22" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-65" target="omU1pgqW6LJjpDUwzffS-21">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-19" value="&lt;span style=&quot;font-size: 10px;&quot;&gt;ReferenceAnnotationBeanPostProcessor#&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;b&gt;postProcessBeanFactory&lt;/b&gt;(&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;ConfigurableListableBeanFactory beanFactory)&lt;/font&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(0, 127, 255); background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;扫描所有Bean定义&lt;/b&gt;，查看内部是否有注解&lt;br&gt;@DubboReference @Reference&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="840" y="1740" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-68" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-21" target="omU1pgqW6LJjpDUwzffS-67">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-71" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fillColor=#dae8fc;strokeColor=#000000;fontSize=11;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-21" target="omU1pgqW6LJjpDUwzffS-70">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-21" value="AnnotatedInjectionMetadata metadata = &lt;b&gt;findInjectionMetadata&lt;/b&gt;(beanName, beanType, null);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;查找类中@DubboReference @Reference注解的字段或@Bean方法，并缓存&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="1080" y="1820" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-26" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-23" target="omU1pgqW6LJjpDUwzffS-25">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-23" value="beanDefinitionRegistry&lt;br&gt;.removeBeanDefinition(BEAN_NAME);&lt;br&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#007fff&quot;&gt;删除后置处理器ReferenceAnnotationBeanPostProcessor，&lt;br&gt;因为到这里这个后置处理器任务就完成了&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="1080" y="1980" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-114" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fillColor=#dae8fc;strokeColor=#6c8ebf;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-25" target="omU1pgqW6LJjpDUwzffS-111">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1300" y="2090" />
              <mxPoint x="1300" y="2590" />
              <mxPoint x="590" y="2590" />
              <mxPoint x="590" y="2630" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-115" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fillColor=#dae8fc;strokeColor=#6c8ebf;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-25" target="omU1pgqW6LJjpDUwzffS-112">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1300" y="2090" />
              <mxPoint x="1300" y="2590" />
              <mxPoint x="590" y="2590" />
              <mxPoint x="590" y="2710" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-25" value="applicationContext.publishEvent(new &lt;b&gt;DubboConfigInitEvent&lt;/b&gt;(applicationContext));" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="1080" y="2060" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-31" style="orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-28" target="omU1pgqW6LJjpDUwzffS-30">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-28" value="&lt;div style=&quot;font-size: 10px;&quot;&gt;这一步注册的是 ScannedGenericBeanDefinition&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;beanName是类名首字母小写，比如 demoServiceImpl&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontColor=#007FFF;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1566" y="1255" width="320" height="30" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-32" style="orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-29" target="omU1pgqW6LJjpDUwzffS-30">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-29" value="&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;div&gt;这一步注册的是 RootBeanDefinition&lt;/div&gt;&lt;div&gt;beanName是 “ServiceBean:&amp;lt;接口全限定名&amp;gt;::” ,&lt;/div&gt;&lt;div&gt;比如 ServiceBean:org.apache.dubbo.springboot.demo.DemoService::&lt;/div&gt;&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontColor=#007FFF;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1811" y="1415" width="320" height="30" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-30" value="&lt;div style=&quot;&quot;&gt;&lt;b&gt;正好对应注册中心里面每个Dubbo服务注册的两个服务实例&lt;/b&gt;&lt;br&gt;&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontColor=#007FFF;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1681" y="1330" width="320" height="30" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-64" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-33" target="omU1pgqW6LJjpDUwzffS-63">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-33" value="&lt;span style=&quot;font-size: 10px;&quot;&gt;DubboConfigBeanInitializer#&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/span&gt;&lt;b style=&quot;font-size: 10px;&quot;&gt;afterPropertiesSet()&lt;/b&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;Bean dubboConfigBeanInitializer 初始化阶段执行&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="840" y="2380" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-35" value="ReferenceAnnotationBeanPostProcessor#&lt;br&gt;postProcessMergedBeanDefinition(...)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="840" y="2200" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-40" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-37" target="omU1pgqW6LJjpDUwzffS-39">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-37" value="DubboConfigAliasPostProcessor#&lt;br&gt;&lt;b&gt;postProcessBeanDefinitionRegistry&lt;/b&gt;(...)&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;仅仅是在后置处理器内保存一下BeanDefinitionRegistry&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="840" y="1040" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-39" value="this.registry = registry;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="1080" y="1040" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-44" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-41" target="omU1pgqW6LJjpDUwzffS-43">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-41" value="DubboInfraBeanRegisterPostProcessor#&lt;div&gt;&lt;b&gt;postProcessBeanDefinitionRegistry(...)&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;&quot; color=&quot;#007fff&quot;&gt;仅仅是在后置处理器内保存一下BeanDefinitionRegistry&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="840" y="1120" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-43" value="&lt;b&gt;this.registry = registry;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="1080" y="1120" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-49" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-45" target="omU1pgqW6LJjpDUwzffS-48">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-45" value="DubboInfraBeanRegisterPostProcessor&lt;br&gt;#&lt;b&gt;postProcessBeanFactory()&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 8px;&quot; color=&quot;#007fff&quot;&gt;前面DubboSpringInitializer注册了ReferenceAnnotationBeanPostProcessor的&lt;b&gt;Bean定义&lt;/b&gt;，但是没有没有创建Bean，这里创建Bean并注册&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="840" y="1400" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-55" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-56" target="omU1pgqW6LJjpDUwzffS-54">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-48" value="referenceAnnotationBeanPostProcessor = beanFactory.&lt;b&gt;getBean&lt;/b&gt;(...);&lt;br&gt;beanFactory.&lt;b&gt;addBeanPostProcessor&lt;/b&gt;(&lt;br&gt;referenceAnnotationBeanPostProcessor);" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="1080" y="1400" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-50" value="&lt;span style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;暂没用到这种方式，暂略&lt;/font&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" vertex="1" parent="1">
          <mxGeometry x="1080" y="1640" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-53" value="&lt;font style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#ea6b66&quot;&gt;执行BeanFactory后置处理的第一步就是读取BeanFactoryPostProcessor&lt;br&gt;Bean定义并创建Bean，看ServiceAnnotationPostProcessor、&lt;br&gt;DubboInfraBeanRegisterPostProcessor等后置处理器的Bean都创建完成了&lt;br&gt;&lt;span style=&quot;&quot;&gt;为何唯独&amp;nbsp;ReferenceAnnotationBeanPostProcessor&lt;/span&gt;&lt;span style=&quot;&quot;&gt;没有创建Bean,&lt;br&gt;以至于还要通过这种方式创建Bean并注册&lt;/span&gt;&lt;br&gt;&lt;span style=&quot;&quot;&gt;TODO&lt;/span&gt;&lt;/font&gt;&lt;br&gt;&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="470" y="1380" width="350" height="100" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-54" value="beanFactory.&lt;b style=&quot;font-size: 10px;&quot;&gt;registerSingleton&lt;/b&gt;(&lt;br style=&quot;font-size: 10px;&quot;&gt;ConfigManager.BEAN_NAME, applicationModel&lt;br style=&quot;font-size: 10px;&quot;&gt;.&lt;b style=&quot;font-size: 10px;&quot;&gt;getApplicationConfigManager&lt;/b&gt;());&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;注册dubboConfigManager&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="1080" y="1560" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-57" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-48" target="omU1pgqW6LJjpDUwzffS-56">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1180" y="1460" as="sourcePoint" />
            <mxPoint x="1180" y="1565" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-59" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-56" target="omU1pgqW6LJjpDUwzffS-58">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-56" value="获取ApplicationModel、ModuleModel Bean实例，然后获取&lt;b&gt;ExtensionInjector&lt;/b&gt;并执行初始化，然后从Spring环境上文读取&lt;b&gt;Dubbo的配置属性，&lt;/b&gt;写入ApplicationModel" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="1080" y="1480" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-58" value="ExtensionInjector&amp;nbsp;&lt;br&gt;TODO" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="1320" y="1480" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-60" value="&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;b style=&quot;font-size: 9px;&quot;&gt;读取的属性：&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&quot;dubbo.application.name&quot; -&amp;gt; &quot;dubbo-springboot-demo-provider&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&quot;dubbo.config.multiple&quot; -&amp;gt; &quot;true&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&quot;dubbo.protocol.host&quot; -&amp;gt; &quot;localhost&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&quot;dubbo.protocol.name&quot; -&amp;gt; &quot;tri&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&quot;dubbo.protocol.port&quot; -&amp;gt; &quot;50052&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&quot;dubbo.registry.address&quot; -&amp;gt; &quot;nacos://127.0.0.1:8848&quot;&lt;/font&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=9;fontColor=#007FFF;" vertex="1" parent="1">
          <mxGeometry x="1286" y="1545" width="280" height="90" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-98" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-63" target="omU1pgqW6LJjpDUwzffS-97">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-100" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-63" target="omU1pgqW6LJjpDUwzffS-99">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-63" value="prepareDubboConfigBeans();&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;用于在@Reference Bean自动注入前初始化Dubbo一些配置Bean&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="1080" y="2380" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-66" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-19" target="omU1pgqW6LJjpDUwzffS-65">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1040" y="1770" as="sourcePoint" />
            <mxPoint x="1180" y="1820" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-65" value="&lt;font style=&quot;font-size: 10px;&quot;&gt;首先从BeanDefinition或BeanFactory中获取Bean类型&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="1080" y="1740" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-67" value="&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp;metadata = buildAnnotatedMetadata(clazz);&lt;span style=&quot;background-color: initial; font-size: 9px;&quot;&gt;&amp;nbsp;&lt;br style=&quot;font-size: 9px;&quot;&gt;this.injectionMetadataCache.put(cacheKey, metadata);&lt;br style=&quot;font-size: 9px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 9px;&quot;&gt;查找类中@DubboReference @Reference注解的&lt;b style=&quot;font-size: 9px;&quot;&gt;字段&lt;/b&gt;或&lt;b style=&quot;font-size: 9px;&quot;&gt;@Bean方法，&lt;/b&gt;&lt;span style=&quot;font-size: 9px;&quot;&gt;并缓存&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" vertex="1" parent="1">
          <mxGeometry x="1320" y="1820" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-72" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;fontSize=11;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-70" target="omU1pgqW6LJjpDUwzffS-23">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-74" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-70" target="omU1pgqW6LJjpDUwzffS-73">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-70" value="prepareInjection(metadata);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;解析上一步查找到的字段或@Bean方法，创建BeanDefinition并注册到Spring容器&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="1080" y="1900" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-76" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-73" target="omU1pgqW6LJjpDUwzffS-75">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-78" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-73" target="omU1pgqW6LJjpDUwzffS-77">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-73" value="&lt;div&gt;String referenceBeanName = &lt;b&gt;registerReferenceBean&lt;/b&gt;(&lt;/div&gt;&lt;div&gt;fieldElement.getPropertyName(), injectedType, attributes, fieldElement.field);&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="1320" y="1900" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-75" value="beanDefinitionRegistry.&lt;b&gt;registerBeanDefinition&lt;/b&gt;(&lt;br&gt;referenceBeanName, beanDefinition);&lt;br&gt;&lt;b&gt;referenceBeanManager&lt;/b&gt;&lt;br&gt;.&lt;b&gt;registerReferenceKeyAndBeanName&lt;/b&gt;(&lt;br&gt;referenceKey, referenceBeanName);" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="1550" y="1900" width="220" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-80" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.75;entryDx=0;entryDy=0;fontSize=11;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-77" target="omU1pgqW6LJjpDUwzffS-75">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1560" y="2010" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1530" y="2010" />
              <mxPoint x="1530" y="1945" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-77" value="&lt;div&gt;String referenceBeanName = &lt;b&gt;registerReferenceBean&lt;/b&gt;(&lt;/div&gt;&lt;div&gt;methodElement.getPropertyName(), injectedType, attributes, methodElement.method);&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="1320" y="1980" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-88" value="ReferenceAnnotationBeanPostProcessor#&lt;br&gt;postProcessProperties(...)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="840" y="2280" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-108" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;endArrow=diamondThin;endFill=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-96" target="omU1pgqW6LJjpDUwzffS-106">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-96" value="&lt;div style=&quot;text-align: center;&quot;&gt;&lt;b&gt;DubboConfigBeanInitializer&lt;/b&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;//是否初始化Dubbo配置Bean&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final AtomicBoolean &lt;b&gt;initialized&lt;/b&gt; = new AtomicBoolean(false);&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private ConfigurableListableBeanFactory &lt;b&gt;beanFactory&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;//Reference Bean 容器&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private ReferenceBeanManager&amp;nbsp;&lt;b&gt;referenceBeanManager&lt;/b&gt;;&lt;/p&gt;&amp;nbsp; &lt;font color=&quot;#007fff&quot;&gt;//此Bean在DubboInfraBeanRegisterPostProcessor中注册&lt;/font&gt;&lt;br&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;@Autowired&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private ConfigManager &lt;b&gt;configManager&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;//此Bean在DubboSpringInitializer 初始化时注册&lt;/font&gt;&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;@Autowired&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;@Qualifier(&quot;org.apache.dubbo.rpc.model.ModuleModel&quot;)&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private ModuleModel &lt;b&gt;moduleModel&lt;/b&gt;;&lt;/p&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="-440" y="1720" width="400" height="220" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-97" value="referenceBeanManager&lt;br&gt;.prepareReferenceBeans();&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;用于初始化所有 reference Bean, 分析消费者时再细看&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="1080" y="2460" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-102" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-99" target="omU1pgqW6LJjpDUwzffS-101">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-105" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-99" target="omU1pgqW6LJjpDUwzffS-104">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-99" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;loadConfigBeansOfType(&lt;b&gt;ApplicationConfig&lt;/b&gt;.class, configManager);&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot;&gt;loadConfigBeansOfType(&lt;b&gt;RegistryConfig&lt;/b&gt;.class, configManager);&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot;&gt;loadConfigBeansOfType(&lt;b&gt;ProtocolConfig&lt;/b&gt;.class, configManager);&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot;&gt;loadConfigBeansOfType(&lt;b&gt;MonitorConfig&lt;/b&gt;.class, configManager);&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot;&gt;loadConfigBeansOfType(&lt;b&gt;ConfigCenterBean&lt;/b&gt;.class, configManager);&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot;&gt;loadConfigBeansOfType(&lt;b&gt;MetadataReportConfig&lt;/b&gt;.class, configManager);&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot;&gt;loadConfigBeansOfType(&lt;b&gt;MetricsConfig&lt;/b&gt;.class, configManager);&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot;&gt;loadConfigBeansOfType(&lt;b&gt;TracingConfig&lt;/b&gt;.class, configManager);&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot;&gt;loadConfigBeansOfType(&lt;b&gt;SslConfig&lt;/b&gt;.class, configManager);&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot;&gt;loadConfigBeansOfType(&lt;b&gt;ModuleConfig&lt;/b&gt;.class, moduleModel.getConfigManager());&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot;&gt;loadConfigBeansOfType(&lt;b&gt;ProviderConfig&lt;/b&gt;.class, moduleModel.getConfigManager());&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot;&gt;loadConfigBeansOfType(&lt;b&gt;ConsumerConfig&lt;/b&gt;.class, moduleModel.getConfigManager());&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=8;align=left;arcSize=5;" vertex="1" parent="1">
          <mxGeometry x="1320" y="2350" width="320" height="120" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-101" value="从 beanFactory 按类型获取所有beanName,&lt;br&gt;然后 beanFactory.getBean(beanName, configClass) 创建所有Bean，并注册到 &lt;b&gt;configManager&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="1680" y="2380" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-103" value="&lt;font color=&quot;#ea6b66&quot;&gt;这一步创建Bean需要BeanDefinition,&amp;nbsp;&lt;br style=&quot;font-size: 10px;&quot;&gt;BeanDefinition 哪里注册的？TODO&lt;br&gt;测试Demo中没有加载到任何一个配置Bean&lt;br&gt;先略&lt;br&gt;&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1886" y="2380" width="210" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-104" value="&lt;font style=&quot;font-size: 9px;&quot;&gt;List&amp;lt;ConfigCenterBean&amp;gt; configCenterBeans = configManager.loadConfigsOfTypeFromProps(&lt;br&gt;ConfigCenterBean.class);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;加载配置中心配置Bean，暂略&lt;/font&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="1380" y="2490" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-106" value="&lt;div style=&quot;text-align: center;&quot;&gt;&lt;b&gt;ReferenceBeanManager&lt;/b&gt;&lt;br&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;Reference Bean实例的容器&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;由于BeanFactoryPostProcessor中需要，很早就创建了其Bean实例&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;// reference key -&amp;gt; reference bean names&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private ConcurrentMap&amp;lt;String, List&amp;lt;String&amp;gt;&amp;gt; &lt;b&gt;referenceKeyMap&lt;/b&gt; = new ConcurrentHashMap&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;// reference alias -&amp;gt; reference bean name&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private ConcurrentMap&amp;lt;String, String&amp;gt; &lt;b&gt;referenceAliasMap&lt;/b&gt; = new ConcurrentHashMap&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;// reference bean name -&amp;gt; ReferenceBean&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private ConcurrentMap&amp;lt;String, ReferenceBean&amp;gt; &lt;b&gt;referenceBeanMap&lt;/b&gt; = new ConcurrentHashMap&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;// reference key -&amp;gt; ReferenceConfig instance&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private ConcurrentMap&amp;lt;String, ReferenceConfig&amp;gt; &lt;b&gt;referenceConfigMap&lt;/b&gt; = new ConcurrentHashMap&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private ApplicationContext &lt;b&gt;applicationContext&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile boolean &lt;b&gt;initialized&lt;/b&gt; = false;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private ModuleModel &lt;b&gt;moduleModel&lt;/b&gt;;&lt;/p&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="-960" y="1720" width="480" height="220" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-117" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-111" target="omU1pgqW6LJjpDUwzffS-116">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-111" value="DubboConfigApplicationListener#&lt;br&gt;onApplicationEvent(&lt;b&gt;DubboConfigInitEvent&lt;/b&gt; event)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="600" y="2600" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-187" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-112" target="omU1pgqW6LJjpDUwzffS-116">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-112" value="DubboBootstrapApplicationListener#&lt;br&gt;onApplicationEvent(ApplicationEvent event)&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;DubboConfigInitEvent 继承&amp;nbsp;ApplicationEvent&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="600" y="2680" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-119" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-116" target="omU1pgqW6LJjpDUwzffS-118">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-116" value="initDubboConfigBeans();&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;Dubbo应用及模块配置初始化&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="840" y="2600" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-121" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-118" target="omU1pgqW6LJjpDUwzffS-120">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-118" value="moduleModel.getDeployer().prepare();&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;这里的moduleModel仅仅作为&lt;b&gt;委托对象&lt;/b&gt;，不对应任何实际的组件，仅&lt;br&gt;用于调用applicationDeployer初始化方法&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="1080" y="2600" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-124" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-120" target="omU1pgqW6LJjpDUwzffS-123">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-128" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-120" target="omU1pgqW6LJjpDUwzffS-127">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-120" value="&lt;b&gt;applicationDeployer&lt;/b&gt;.&lt;b&gt;initialize&lt;/b&gt;();" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#ffcd28;strokeColor=#d79b00;gradientColor=#ffa500;" vertex="1" parent="1">
          <mxGeometry x="1999.97" y="2599.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-122" value="&lt;b&gt;DefaultModuleDeployer&lt;/b&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="2035.97" y="2567.5" width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-176" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-123" target="omU1pgqW6LJjpDUwzffS-175">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-123" value="this.initialize();" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="2001" y="3497.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-126" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;endArrow=block;endFill=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-125" target="LEzOs3IW3RDwebMgTtXX-24">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-700" y="340" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-134" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.75;exitY=0;exitDx=0;exitDy=0;entryX=0.75;entryY=1;entryDx=0;entryDy=0;endArrow=diamondThin;endFill=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-125" target="omU1pgqW6LJjpDUwzffS-133">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-171" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.25;exitDx=0;exitDy=0;entryX=1;entryY=0.25;entryDx=0;entryDy=0;endArrow=diamondThin;endFill=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-125" target="LEzOs3IW3RDwebMgTtXX-26">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-125" value="&lt;div style=&quot;text-align: center;&quot;&gt;&lt;b&gt;ApplicationModel&lt;/b&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;表示正在使用Dubbo的应用程序&lt;/font&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;public static final String NAME = &quot;ApplicationModel&quot;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;// 内部包含的 ModuleModel&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final List&amp;lt;ModuleModel&amp;gt; moduleModels = new CopyOnWriteArrayList&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final List&amp;lt;ModuleModel&amp;gt; pubModuleModels = new CopyOnWriteArrayList&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile Environment environment;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;// 一组组件配置的容器&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile &lt;b&gt;ConfigManager&lt;/b&gt; &lt;b&gt;configManager&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile ServiceRepository serviceRepository;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;//ApplicationModel 的起动器，内部会遍历所有Module 并执行 ModuleDeployer 起动器&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile &lt;b&gt;ApplicationDeployer&lt;/b&gt; &lt;b&gt;deployer&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final &lt;b&gt;FrameworkModel&lt;/b&gt; &lt;b&gt;frameworkModel&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ModuleModel internalModule;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile ModuleModel defaultModule;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;private final AtomicInteger moduleIndex = new AtomicInteger(0);&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;whiteSpace=wrap;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="-440" y="400" width="400" height="260" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-130" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-127" target="omU1pgqW6LJjpDUwzffS-129">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-127" value="registerShutdownHook();" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="2239.97" y="2599.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-132" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-136" target="omU1pgqW6LJjpDUwzffS-131">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-151" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-129" target="omU1pgqW6LJjpDUwzffS-150">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-129" value="startConfigCenter();&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;解析配置中心的配置并从配置中心加载配置数据&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="2239.97" y="2677.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-131" value="1 先从ConfigManager environment 读取属性 PropertiesConfiguration；&lt;span style=&quot;background-color: initial;&quot;&gt;读取以 “dubbo.applications.” 开头的属性，&lt;/span&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;按name分组创建ApplicationConfig并存储到 &lt;b&gt;ConfigManager configCache&lt;/b&gt;&lt;/span&gt;&lt;br&gt;2 再从ConfigManager environment 读取 globalConfigurationMaps，从中查找以 “dubbo.application” 开头的配置; 使用配置创建 ApplicationConfig 实例，存储到 &lt;b&gt;ConfigManager configCache&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;arcSize=4;" vertex="1" parent="1">
          <mxGeometry x="2719.97" y="2667.5" width="319" height="80" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-160" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;endArrow=diamondThin;endFill=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-133" target="omU1pgqW6LJjpDUwzffS-135">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-133" value="&lt;div style=&quot;text-align: center;&quot;&gt;&lt;b&gt;ApplicationDeployer&lt;/b&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ApplicationModel applicationModel;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;//保存有各种类型配置信息&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ConfigManager &lt;b&gt;configManager&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Environment environment;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ReferenceCache referenceCache;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final FrameworkExecutorRepository frameworkExecutorRepository;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ExecutorRepository executorRepository;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final AtomicBoolean hasPreparedApplicationInstance = new AtomicBoolean(false);&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile boolean hasPreparedInternalModule = false;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private ScheduledFuture&amp;lt;?&amp;gt; asyncMetadataFuture;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile CompletableFuture&amp;lt;Boolean&amp;gt; startFuture;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final DubboShutdownHook dubboShutdownHook;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private volatile MetricsServiceExporter metricsServiceExporter;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Object stateLock = new Object();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Object startLock = new Object();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Object destroyLock = new Object();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Object internalModuleLock = new Object();&lt;/p&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="-440" width="400" height="340" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-135" value="&lt;div style=&quot;text-align: center; font-size: 9px;&quot;&gt;&lt;b style=&quot;font-size: 9px;&quot;&gt;AbstractConfigManager &lt;/b&gt;&lt;font style=&quot;font-size: 9px;&quot; color=&quot;#007fff&quot;&gt;Dubbo配置管理器&lt;/font&gt;&lt;br style=&quot;font-size: 9px;&quot;&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 9px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 9px;&quot;&gt;private static final Set&amp;lt;Class&amp;lt;? extends AbstractConfig&amp;gt;&amp;gt; uniqueConfigTypes = new ConcurrentHashSet&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 9px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 9px;&quot;&gt;//用于存储各种类型的配置类，每种类型配置可能还有多组&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 9px;&quot;&gt;final Map&amp;lt;String, Map&amp;lt;String, AbstractConfig&amp;gt;&amp;gt; &lt;b style=&quot;font-size: 9px;&quot;&gt;configsCache&lt;/b&gt; = new ConcurrentHashMap&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 9px;&quot;&gt;private final Map&amp;lt;String, AtomicInteger&amp;gt; configIdIndexes = &lt;font style=&quot;font-size: 9px;&quot;&gt;new ConcurrentHashMap&amp;lt;&amp;gt;();&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 9px;&quot;&gt;protected Set&amp;lt;AbstractConfig&amp;gt; duplicatedConfigs = new ConcurrentHashSet&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 9px;&quot;&gt;&lt;br style=&quot;font-size: 9px;&quot;&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 9px;&quot;&gt;protected final ScopeModel scopeModel;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 9px;&quot;&gt;protected final ApplicationModel applicationModel;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 9px;&quot;&gt;private final Collection&amp;lt;Class&amp;lt;? extends AbstractConfig&amp;gt;&amp;gt; supportedConfigTypes;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 9px;&quot;&gt;private final Environment environment;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 9px;&quot;&gt;private ConfigValidator configValidator;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 9px;&quot;&gt;private final AtomicBoolean initialized = new AtomicBoolean(false);&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 9px;&quot;&gt;protected ConfigMode configMode = ConfigMode.STRICT;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 9px;&quot;&gt;protected boolean ignoreDuplicatedInterface = false;private static final Set&amp;lt;Class&amp;lt;? extends AbstractConfig&amp;gt;&amp;gt; uniqueConfigTypes = new ConcurrentHashSet&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 9px;&quot;&gt;&lt;br style=&quot;font-size: 9px;&quot;&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 9px;&quot;&gt;final Map&amp;lt;String, Map&amp;lt;String, AbstractConfig&amp;gt;&amp;gt; configsCache = new ConcurrentHashMap&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 9px;&quot;&gt;private final Map&amp;lt;String, AtomicInteger&amp;gt; configIdIndexes = &lt;font style=&quot;font-size: 9px;&quot;&gt;new ConcurrentHashMap&amp;lt;&amp;gt;();&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 9px;&quot;&gt;protected Set&amp;lt;AbstractConfig&amp;gt; duplicatedConfigs = new ConcurrentHashSet&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 9px;&quot;&gt;&lt;br style=&quot;font-size: 9px;&quot;&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 9px;&quot;&gt;protected final ScopeModel scopeModel;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 9px;&quot;&gt;protected final ApplicationModel applicationModel;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 9px;&quot;&gt;private final Collection&amp;lt;Class&amp;lt;? extends AbstractConfig&amp;gt;&amp;gt; supportedConfigTypes;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 9px;&quot;&gt;private final Environment environment;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 9px;&quot;&gt;private ConfigValidator configValidator;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 9px;&quot;&gt;private final AtomicBoolean initialized = new AtomicBoolean(false);&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 9px;&quot;&gt;protected ConfigMode configMode = ConfigMode.STRICT;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 9px;&quot;&gt;protected boolean ignoreDuplicatedInterface = false;&lt;/p&gt;&lt;hr style=&quot;font-size: 9px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 9px;&quot;&gt;&lt;br style=&quot;font-size: 9px;&quot;&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=9;fontFamily=Helvetica;html=1;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="-880" y="-150" width="400" height="350" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-137" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-129" target="omU1pgqW6LJjpDUwzffS-136">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2439.97" y="2707.5" as="sourcePoint" />
            <mxPoint x="2739.97" y="2707.5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-139" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-136" target="omU1pgqW6LJjpDUwzffS-138">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-136" value="configManager&lt;br&gt;.&lt;b&gt;loadConfigsOfTypeFromProps&lt;/b&gt;(&lt;br&gt;&lt;b&gt;ApplicationConfig&lt;/b&gt;.class);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;加载dubbo.appliction配置&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="2479.97" y="2677.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-141" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-138" target="omU1pgqW6LJjpDUwzffS-140">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-138" value="configManager&lt;br&gt;.loadConfigsOfTypeFromProps(&lt;br&gt;&lt;b&gt;ConfigCenterConfig&lt;/b&gt;.class);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;同理加载dubbo.config-center配置&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="2479.97" y="2757.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-143" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-140" target="omU1pgqW6LJjpDUwzffS-142">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-145" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-140" target="omU1pgqW6LJjpDUwzffS-144">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-140" value="useRegistryAsConfigCenterIfNecessary();&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;如果没有设置配置中心就尝试使用注册中心&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="2479.97" y="2837.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-142" value="configManager.loadConfigsOfTypeFromProps(&lt;br&gt;&lt;b&gt;RegistryConfig&lt;/b&gt;.class);&lt;br&gt;configManager.addConfigCenter(configCenter);" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;" vertex="1" parent="1">
          <mxGeometry x="2709.97" y="2837.5" width="220" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-147" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-144" target="omU1pgqW6LJjpDUwzffS-146">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-149" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-144" target="omU1pgqW6LJjpDUwzffS-148">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-144" value="compositeDynamicConfiguration&lt;br&gt;.addConfiguration(&lt;b&gt;prepareEnvironment&lt;/b&gt;(&lt;br&gt;configCenter));&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;从配置中心的“dubbo.properties”读取配置信息&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="2479.97" y="2917.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-146" value="TODO" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="2719.97" y="2917.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-148" value="environment.setDynamicConfiguration(&lt;br&gt;compositeDynamicConfiguration);" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="2479.97" y="2997.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-153" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-150" target="omU1pgqW6LJjpDUwzffS-152">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-162" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-164" target="omU1pgqW6LJjpDUwzffS-161">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-150" value="loadApplicationConfigs();" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="2239.97" y="3127.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-155" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-152" target="omU1pgqW6LJjpDUwzffS-154">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-170" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-152" target="omU1pgqW6LJjpDUwzffS-169">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-152" value="&amp;nbsp;initModuleDeployers();" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="2239.97" y="3257.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-157" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-154" target="omU1pgqW6LJjpDUwzffS-156">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-154" value="initMetricsReporter();&lt;br&gt;initMetricsService();" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="2239.97" y="3337.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-156" value="startMetadataCenter();&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;初始化元数据配置&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="2239.97" y="3417.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-158" value="&lt;font style=&quot;font-size: 10px;&quot;&gt;&lt;b&gt;DefaultApplicationDeployer&lt;/b&gt;&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="2264.97" y="2567.5" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-168" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=1;entryDx=0;entryDy=0;fillColor=#dae8fc;strokeColor=#6c8ebf;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-161" target="omU1pgqW6LJjpDUwzffS-131">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-161" value="&lt;div style=&quot;font-size: 9px;&quot;&gt;loadConfigsOfTypeFromProps(&lt;b&gt;ApplicationConfig&lt;/b&gt;.class);&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 9px;&quot;&gt;// 加载 dubbo.monitor.xxx&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;loadConfigsOfTypeFromProps(&lt;b&gt;MonitorConfig&lt;/b&gt;.class);&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 9px;&quot;&gt;// 加载 dubbo.metric.xxx&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;loadConfigsOfTypeFromProps(&lt;b&gt;MetricsConfig&lt;/b&gt;.class);&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 9px;&quot;&gt;// 加载 dubbo.tracing.xxx&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;loadConfigsOfTypeFromProps(&lt;b&gt;TracingConfig&lt;/b&gt;.class);&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 9px;&quot;&gt;// 加载 dubbo.protocol.xxx&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;loadConfigsOfTypeFromProps(&lt;b&gt;ProtocolConfig&lt;/b&gt;.class);&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 9px;&quot;&gt;// 加载 dubbo.registry.xxx&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;loadConfigsOfTypeFromProps(&lt;b&gt;RegistryConfig&lt;/b&gt;.class);&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 9px;&quot;&gt;// 加载 dubbo.metadata-report.xxx&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;loadConfigsOfTypeFromProps(&lt;b&gt;MetadataReportConfig&lt;/b&gt;.class);&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=left;arcSize=2;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="2719.97" y="3077.5" width="259" height="160" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-163" value="&lt;font color=&quot;#007fff&quot;&gt;这里注意&lt;b&gt;每种类型的配置都支持配置多组&lt;/b&gt;&lt;br&gt;比如 dubbo.applictions.xxx &lt;br&gt;也可以只配置一组如：dubbo.appliction.xxx&lt;br&gt;后面仅展示只配置一组的配置前缀&lt;br&gt;&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="3039.97" y="2677.5" width="210" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-166" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-150" target="omU1pgqW6LJjpDUwzffS-164">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2439.97" y="3157.5" as="sourcePoint" />
            <mxPoint x="2719.97" y="3157.5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-164" value="configManager.loadConfigs();" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="2479.97" y="3127.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-167" value="&lt;div style=&quot;text-align: center;&quot;&gt;&lt;b&gt;ApplicationConfig&lt;/b&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private String name;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private String version;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private String owner;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private String organization;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private String architecture;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private String environment;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private String compiler;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private List&amp;lt;RegistryConfig&amp;gt; &lt;b&gt;registries&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private String &lt;b&gt;registryIds&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private MonitorConfig &lt;b&gt;monitor&lt;/b&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private String dumpDirectory;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private Boolean dumpEnable;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private Boolean qosEnable;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private Boolean qosCheck;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private String qosHost;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private Integer qosPort;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private Boolean qosAcceptForeignIp;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private String qosAcceptForeignIpWhitelist;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private String qosAnonymousAccessPermissionLevel;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private String qosAnonymousAllowCommands;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private Map&amp;lt;String, String&amp;gt; parameters;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private String shutwait;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private String hostname;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private String metadataType;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private Boolean registerConsumer;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private String repository;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private Boolean enableFileCache;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private String protocol;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private String metadataServiceProtocol;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private Integer metadataServicePort;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private Integer mappingRetryInterval;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private String livenessProbe;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private String readinessProbe;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private String startupProbe;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private String registerMode;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private Boolean enableEmptyProtection;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private String serializeCheckStatus;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private Boolean autoTrustSerializeClass;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private Integer trustSerializeClassLevel;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private Boolean checkSerializable;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private String executorManagementMode;&lt;/p&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="-1880" y="40" width="400" height="580" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-174" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-169" target="omU1pgqW6LJjpDUwzffS-123">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2698.97" y="3287.5" />
              <mxPoint x="2698.97" y="3487.5" />
              <mxPoint x="1989.97" y="3487.5" />
              <mxPoint x="1989.97" y="3527.5" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-169" value="for&amp;nbsp;applicationModel.getModuleModels():&lt;br&gt;moduleModel.getDeployer().&lt;b&gt;initialize&lt;/b&gt;();&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;遍历初始化各个模块，模块不直接对应组件（注册中心、配置中心这些）&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="2479.97" y="3257.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-172" value="&lt;font color=&quot;#007fff&quot;&gt;FrameworkModel 可能包含多个 ApplicationModel, ApplicationModel 可能包含多个ModuleModel&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="-1180" y="360" width="530" height="30" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-178" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-175" target="omU1pgqW6LJjpDUwzffS-177">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-175" value="onInitialize();&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;调用&amp;nbsp;ModuleDeployListener 回调，如果有监听器的话&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="2240.97" y="3497.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-181" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-177" target="omU1pgqW6LJjpDUwzffS-180">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-177" value="&amp;nbsp;loadConfigs();" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="2240.97" y="3577.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-179" value="ModuleModel委托对象 -&amp;gt; Dubbo应用模型对象 -&amp;gt; Dubbo应用模块对象" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="1080" y="2680" width="390" height="30" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-183" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-180" target="omU1pgqW6LJjpDUwzffS-184">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2719.97" y="3607.500000000001" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-180" value="moduleModel.getConfigManager()&lt;br&gt;.loadConfigs();&lt;br&gt;moduleModel.getConfigManager()&lt;br&gt;.refreshAll();" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="2480.97" y="3577.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-184" value="&lt;div style=&quot;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;// 加载 dubbo.provider.xxx&lt;/font&gt;&lt;/div&gt;&lt;div&gt;loadConfigsOfTypeFromProps(&lt;b&gt;ProviderConfig&lt;/b&gt;.class);&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;// 加载 dubbo.consumer.xxx&lt;/font&gt;&lt;/div&gt;&lt;div&gt;loadConfigsOfTypeFromProps(&lt;b&gt;ConsumerConfig&lt;/b&gt;.class);&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;// 加载 dubbo.module.xxx&lt;/font&gt;&lt;/div&gt;&lt;div&gt;loadConfigsOfTypeFromProps(&lt;b&gt;ModuleConfig&lt;/b&gt;.class);&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=left;arcSize=2;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="2719.97" y="3572.5" width="240" height="70" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-185" value="在SpringBoot 中一般都用注解&lt;br&gt;不会用在配置文件中直接定义生产者消费者" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;fontColor=#007FFF;" vertex="1" parent="1">
          <mxGeometry x="2959.97" y="3587.5" width="210" height="40" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-186" value="&lt;font color=&quot;#ea6b66&quot; style=&quot;font-size: 10px;&quot;&gt;ApplicationModel 中的 2个ModuleModel 怎么来的？前面只看到有注册一个&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="2480.97" y="3317.5" width="350" height="30" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-193" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-188" target="omU1pgqW6LJjpDUwzffS-192">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-188" value="ModuleDeployer deployer = moduleModel.getDeployer();&lt;br&gt;future = deployer.&lt;b&gt;start&lt;/b&gt;();" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="840" y="2760" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-198" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-192" target="omU1pgqW6LJjpDUwzffS-194">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-192" value="ModuleDeployer deployer = moduleModel.getDeployer();&lt;br&gt;future = deployer.&lt;b&gt;start&lt;/b&gt;();&lt;br&gt;if (!deployer.isBackground())&lt;br&gt;future.get();" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="1080" y="2760" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-197" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-194" target="omU1pgqW6LJjpDUwzffS-196">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-199" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;fillColor=#dae8fc;strokeColor=#6c8ebf;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-194" target="omU1pgqW6LJjpDUwzffS-120">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1310" y="2910" />
              <mxPoint x="1310" y="2645" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-194" value="&lt;b&gt;applicationDeployer&lt;/b&gt;.&lt;b&gt;initialize&lt;/b&gt;();&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;前面通过DubboConfigApplicationListener已经初始化，这里会直接返回&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="600" y="2880" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-195" value="&lt;b&gt;DefaultModuleDeployer&lt;/b&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="636" y="2850" width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-201" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-196" target="omU1pgqW6LJjpDUwzffS-200">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-196" value="&lt;b&gt;return startSync();&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;&quot; color=&quot;#007fff&quot;&gt;Dubbo应用及模块启动&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#ffcd28;strokeColor=#d79b00;gradientColor=#ffa500;" vertex="1" parent="1">
          <mxGeometry x="600" y="2960" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-203" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-200" target="omU1pgqW6LJjpDUwzffS-202">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-208" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-200" target="omU1pgqW6LJjpDUwzffS-207">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-200" value="onModuleStarting();" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="840" y="2960" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-205" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-202" target="omU1pgqW6LJjpDUwzffS-204">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-210" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-202" target="omU1pgqW6LJjpDUwzffS-209">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-202" value="for listeners:&lt;br&gt;listener.onStarting(scopeModel);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;Dubbo应用及模块启动&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="1080" y="2960" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-204" value="publishModuleEvent(&lt;br&gt;DeployState.&lt;b&gt;STARTING&lt;/b&gt;);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;没看到哪里有监听这个事件，暂略&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="1320" y="2960" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-206" value="&lt;font style=&quot;font-size: 10px;&quot;&gt;DubboDeployApplicationListener&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="1335" y="2930" width="170" height="30" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-214" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-207" target="omU1pgqW6LJjpDUwzffS-213">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-207" value="initialize();&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;前面已经初始化，直接返回&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="840" y="3040" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-212" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-209" target="omU1pgqW6LJjpDUwzffS-211">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-209" value="applicationDeployer.notifyModuleChanged(&lt;br&gt;moduleModel, DeployState.STARTING);" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="1080" y="3040" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-211" value="&lt;div&gt;synchronized (stateLock) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; stateLock.notifyAll();&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;" vertex="1" parent="1">
          <mxGeometry x="1320" y="3040" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-218" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-213" target="omU1pgqW6LJjpDUwzffS-217">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-299" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-213" target="omU1pgqW6LJjpDUwzffS-298">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-213" value="&amp;nbsp;exportServices();&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;暴露服务就是向注册中心注册服务&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="840" y="3120" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-216" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;endArrow=block;endFill=0;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-215" target="omU1pgqW6LJjpDUwzffS-135">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-215" value="&lt;div style=&quot;text-align: center;&quot;&gt;&lt;b&gt;ModuleConfigManager&lt;/b&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 9px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;public static final String NAME = &quot;moduleConfig&quot;;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Map&amp;lt;String, AbstractInterfaceConfig&amp;gt; &lt;b&gt;serviceConfigCache&lt;/b&gt; = new ConcurrentHashMap&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final ConfigManager &lt;b&gt;applicationConfigManager&lt;/b&gt;;&lt;/p&gt;&lt;hr style=&quot;font-size: 9px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 9px;&quot;&gt;&lt;br style=&quot;font-size: 9px;&quot;&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=9;fontFamily=Helvetica;html=1;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="-880" y="240" width="400" height="100" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-220" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-217" target="omU1pgqW6LJjpDUwzffS-219">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-217" value="for configManager.getServices():&lt;br&gt;exportServiceInternal(sc);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;查找模块配置管理器中关于“service”的配置&lt;br&gt;遍历暴露&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="1080" y="3120" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-222" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-219" target="omU1pgqW6LJjpDUwzffS-221">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-219" value="&lt;div&gt;sc.&lt;b&gt;export&lt;/b&gt;(RegisterTypeEnum.&lt;/div&gt;&lt;div&gt;AUTO_REGISTER_BY_DEPLOYER);&lt;/div&gt;&lt;div&gt;&lt;b&gt;exportedServices&lt;/b&gt;.add(sc);&lt;/div&gt;&lt;font color=&quot;#007fff&quot;&gt;查找模块配置管理器中关于“service”的配置&lt;br&gt;遍历暴露&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="1320" y="3120" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-225" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-221" target="omU1pgqW6LJjpDUwzffS-224">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1770" y="3150" />
              <mxPoint x="1770" y="3190" />
              <mxPoint x="1070" y="3190" />
              <mxPoint x="1070" y="3230" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-221" value="&lt;div&gt;&lt;/div&gt;doExportUrls(registerType);" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="1561" y="3120" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-223" value="&lt;b&gt;ServiceConfig&lt;/b&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="1610" y="3090" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-227" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-224" target="omU1pgqW6LJjpDUwzffS-226">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-224" value="&lt;div&gt;&lt;/div&gt;ModuleServiceRepository repository = getScopeModel().&lt;b&gt;getServiceRepository&lt;/b&gt;();&lt;br&gt;serviceDescriptor = repository&lt;br&gt;.&lt;b&gt;registerService&lt;/b&gt;(getInterfaceClass());" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="1080" y="3200" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-229" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-226" target="omU1pgqW6LJjpDUwzffS-228">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-226" value="providerModel = new &lt;b&gt;ProviderModel&lt;/b&gt;(...);&lt;br&gt;repository.&lt;b&gt;registerProvider&lt;/b&gt;(providerModel);&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="1080" y="3280" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-231" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-228" target="omU1pgqW6LJjpDUwzffS-230">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-233" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-228" target="omU1pgqW6LJjpDUwzffS-232">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-228" value="List&amp;lt;URL&amp;gt; registryURLs = ConfigValidationUtils.&lt;b&gt;loadRegistries&lt;/b&gt;(this, true);&lt;br&gt;repository.&lt;b&gt;registerService&lt;/b&gt;(pathKey, interfaceClass);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;根据组件配置类数据拼接完整的向注册中心注册服务的URL&lt;/font&gt;&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="1080" y="3360" width="200" height="80" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-230" value="&lt;div&gt;List&amp;lt;URL&amp;gt; urls = UrlUtils.parseURLs(address, map);&lt;/div&gt;&lt;div&gt;for (URL url : urls) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; url = URLBuilder.from(url)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .addParameter(REGISTRY_KEY, url.getProtocol())&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .setProtocol(extractRegistryType(url))&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .setScopeModel(interfaceConfig.getScopeModel())&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .build();&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; if (provider || url.getParameter(SUBSCRIBE_KEY, true)) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; registryList.add(url);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;arcSize=4;" vertex="1" parent="1">
          <mxGeometry x="1320" y="3330" width="280" height="140" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-236" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-232" target="omU1pgqW6LJjpDUwzffS-235">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-232" value="for protocols:&lt;br&gt;doExportUrlsFor1Protocol(protocolConfig, registryURLs, registerType);&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="1080" y="3500" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-234" value="&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;registry://127.0.0.1:8848/org.apache.dubbo.registry.&lt;b&gt;RegistryService&lt;/b&gt;?&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;application=dubbo-springboot-demo-provider&amp;amp;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;dubbo=2.0.2&amp;amp;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;executor-management-mode=isolation&amp;amp;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;file-cache=true&amp;amp;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;pid=145596&amp;amp;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;registry=nacos&amp;amp;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;release=3.2.9&amp;amp;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;timestamp=1704715810770&lt;/font&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="1610" y="3330" width="400" height="140" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-238" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-235" target="omU1pgqW6LJjpDUwzffS-237">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-235" value="Map&amp;lt;String, String&amp;gt; map = buildAttributes(protocolConfig);&lt;br&gt;serviceMetadata.getAttachments()&lt;br&gt;.putAll(map);&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="1320" y="3500" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-241" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-237" target="omU1pgqW6LJjpDUwzffS-239">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-260" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-237" target="omU1pgqW6LJjpDUwzffS-259">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-237" value="URL url = buildUrl(protocolConfig, map);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;构建RPC服务的URL, 包括host port 解析&lt;/font&gt;&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="1320" y="3580" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-246" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-239" target="omU1pgqW6LJjpDUwzffS-245">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-252" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-239" target="omU1pgqW6LJjpDUwzffS-249">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-239" value="String host = &lt;b&gt;findConfiguredHosts&lt;/b&gt;(protocolConfig, provider, params);&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="1561" y="3580" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-242" value="&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&lt;b style=&quot;font-size: 10px;&quot;&gt;依次从系统环境变量&lt;/b&gt;&lt;b style=&quot;font-size: 10px;&quot;&gt;TRI_DUBBO_IP_TO_BIND、DUBBO_IP_TO_BIND&lt;/b&gt;&lt;b style=&quot;font-size: 10px;&quot;&gt;取RPC host 值,&lt;/b&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;b style=&quot;font-size: 10px;&quot;&gt;为空就从 ProtocolConfig 配置对象中取 host,&lt;/b&gt;&lt;b style=&quot;font-size: 10px;&quot;&gt;还是为空就从&amp;nbsp;ProviderConfig 配置对象中取 host,&lt;/b&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;b style=&quot;font-size: 10px;&quot;&gt;最后还要对host进行有效性检查，null、空字符串、&lt;/b&gt;&lt;b style=&quot;font-size: 10px;&quot;&gt;localhost、0.0.0.0、127.*.*.* 都是无效的host&lt;/b&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;b style=&quot;font-size: 10px;&quot;&gt;需要通过NetUtils获取本地网络接口IP&lt;br&gt;&lt;/b&gt;&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1560" y="3642.5" width="460" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-251" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-245" target="omU1pgqW6LJjpDUwzffS-247">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-245" value="&lt;b&gt;NetUtils#getLocalHost&lt;/b&gt;()&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;Demo中配置的localhost这一无效host&lt;br&gt;需要借助NetUtils重新解析本地IP&lt;br&gt;原理参考：多网卡环境Dubbo识别本地IP错误与解决.md&lt;/font&gt;&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="1801" y="3580" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-247" value="map.put(BIND_IP_KEY, hostToBind);&lt;br&gt;map.put(ANYHOST_KEY, String.valueOf(anyhost));&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="1801" y="3720" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-254" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-249" target="omU1pgqW6LJjpDUwzffS-253">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-256" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-249" target="omU1pgqW6LJjpDUwzffS-255">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-249" value="&lt;div&gt;Integer port =&lt;/div&gt;&lt;div&gt;&lt;b&gt;findConfiguredPort&lt;/b&gt;(protocolConfig, provider, this.getExtensionLoader(Protocol.class), name, params);&lt;/div&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="1561" y="3800" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-253" value="&lt;div&gt;final int defaultPort = extensionLoader.getExtension(name)&lt;/div&gt;&lt;div&gt;.getDefaultPort();&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;有个扩展点&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="1801" y="3800" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-258" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-255" target="omU1pgqW6LJjpDUwzffS-257">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-255" value="&lt;div&gt;&lt;div&gt;URL url = new &lt;b&gt;ServiceConfigURL&lt;/b&gt;(&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; name, null, null, host, port,&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; getContextPath(protocolConfig)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; .map(p -&amp;gt; p + &quot;/&quot; + path).orElse(path),&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; params);&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="1561" y="3880" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-257" value="&lt;div&gt;&lt;div&gt;&amp;nbsp;可以通过&amp;nbsp;ConfiguratorFactory 拓展其他参数&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="1561" y="3960" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-262" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-259" target="omU1pgqW6LJjpDUwzffS-261">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-264" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-259" target="omU1pgqW6LJjpDUwzffS-263">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-259" value="exportUrl(url, registryURLs, registerType);&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="1320" y="4040" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-261" value="initServiceMethodMetrics(url);&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="1320" y="4440" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-266" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-263" target="omU1pgqW6LJjpDUwzffS-265">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-292" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-263" target="omU1pgqW6LJjpDUwzffS-291">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-263" value="exportLocal(url);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;根据 url 中 scope 参数选择暴露方式，exportLocal() 暴露到本地&lt;/font&gt;&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="1560" y="4040" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-270" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-265" target="omU1pgqW6LJjpDUwzffS-269">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-265" value="doExportUrl(local, false, RegisterTypeEnum.AUTO_REGISTER);&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="1799.95" y="4040" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-267" value="&lt;font color=&quot;#007fff&quot;&gt;injvm://127.0.0.1/org.apache.dubbo.springboot.demo.&lt;b&gt;DemoService&lt;/b&gt;?&lt;br style=&quot;font-size: 10px;&quot;&gt;anyhost=true&amp;amp;application=dubbo-springboot-demo-provider&amp;amp;background=false&amp;amp;&lt;br style=&quot;font-size: 10px;&quot;&gt;bind.ip=172.17.0.1&amp;amp;bind.port=50052&amp;amp;deprecated=false&amp;amp;dubbo=2.0.2&amp;amp;&lt;br style=&quot;font-size: 10px;&quot;&gt;dynamic=true&amp;amp;executor-management-mode=isolation&amp;amp;exporter.listener=injvm&amp;amp;&lt;br style=&quot;font-size: 10px;&quot;&gt;file-cache=true&amp;amp;generic=false&amp;amp;&lt;b&gt;interface&lt;/b&gt;=org.apache.dubbo.springboot.demo.DemoService&amp;amp;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;b&gt;methods&lt;/b&gt;=sayHello&amp;amp;pid=182904&amp;amp;prefer.serialization=fastjson2,hessian2&amp;amp;release=3.2.9&amp;amp;&lt;br style=&quot;font-size: 10px;&quot;&gt;side=provider&amp;amp;timestamp=1704788919714&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1601" y="4110" width="440" height="100" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-283" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-269" target="omU1pgqW6LJjpDUwzffS-282">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-288" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-269" target="omU1pgqW6LJjpDUwzffS-287">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-269" value="Invoker&amp;lt;?&amp;gt; invoker = &lt;b&gt;proxyFactory&lt;/b&gt;&lt;br&gt;.getInvoker(ref, (Class) interfaceClass, url);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;生成调用代理&lt;br&gt;ref: 要暴露的服务实例&lt;br&gt;interfaceClass 要暴露的服务接口类&lt;/font&gt;&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="2039.97" y="4040" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-278" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;endArrow=block;endFill=0;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-271" target="omU1pgqW6LJjpDUwzffS-273">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-271" value="&lt;div style=&quot;text-align: center;&quot;&gt;&lt;b&gt;ServiceConfigBase&amp;lt;T&amp;gt;&lt;/b&gt;&lt;br&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;//要暴露的服务接口类型&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;protected Class&amp;lt;?&amp;gt; interfaceClass;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;//接口实现类型&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;protected transient T ref;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;//Service类型path&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;protected String path;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;//Provider配置&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;protected ProviderConfig provider;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;protected String providerIds;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;protected volatile String generic;&lt;/p&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="-2320" y="360" width="400" height="160" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-277" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;endArrow=block;endFill=0;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-272" target="omU1pgqW6LJjpDUwzffS-271">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-272" value="&lt;div style=&quot;text-align: center;&quot;&gt;&lt;b&gt;ServiceConfig&amp;lt;T&amp;gt;&lt;/b&gt;&lt;br&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private static final Map&amp;lt;String, Integer&amp;gt; RANDOM_PORT_MAP = new HashMap&amp;lt;String, Integer&amp;gt;();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;//&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private Protocol protocolSPI;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;//&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private ProxyFactory proxyFactory;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;//&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private ProviderModel providerModel;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private transient volatile boolean exported;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private transient volatile boolean unexported;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private transient volatile AtomicBoolean initialized = new AtomicBoolean(false);&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;//已经暴露的服务&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final Map&amp;lt;RegisterTypeEnum, List&amp;lt;Exporter&amp;lt;?&amp;gt;&amp;gt;&amp;gt; &lt;b&gt;exporters&lt;/b&gt; = new ConcurrentHashMap&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;private final List&amp;lt;ServiceListener&amp;gt; serviceListeners = new ArrayList&amp;lt;&amp;gt;();&lt;/p&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="-2320" y="560" width="400" height="240" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-279" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;endArrow=block;endFill=0;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-273" target="omU1pgqW6LJjpDUwzffS-274">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-273" value="&lt;div style=&quot;text-align: center;&quot;&gt;&lt;b&gt;AbstractServiceConfig&lt;/b&gt;&lt;br&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="-2220" y="280" width="200" height="50" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-280" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;endArrow=block;endFill=0;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-274" target="omU1pgqW6LJjpDUwzffS-275">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-274" value="&lt;div style=&quot;text-align: center;&quot;&gt;&lt;b&gt;AbstractInterfaceConfig&lt;/b&gt;&lt;br&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="-2220" y="200" width="200" height="50" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-281" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;endArrow=block;endFill=0;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-275" target="omU1pgqW6LJjpDUwzffS-276">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-275" value="&lt;div style=&quot;text-align: center;&quot;&gt;&lt;b&gt;AbstractMethodConfig&lt;/b&gt;&lt;br&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="-2220" y="120" width="200" height="50" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-276" value="&lt;div style=&quot;text-align: center;&quot;&gt;&lt;b&gt;AbstractConfig&lt;/b&gt;&lt;br&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="-2220" y="40" width="200" height="50" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-285" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-282" target="omU1pgqW6LJjpDUwzffS-284">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-290" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-282" target="omU1pgqW6LJjpDUwzffS-289">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-282" value="Exporter&amp;lt;?&amp;gt; exporter = &lt;b&gt;protocolSPI&lt;/b&gt;.export(invoker);&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="2039.9700000000003" y="4120" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-284" value="&lt;div&gt;exporters&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; .computeIfAbsent(registerType, k -&amp;gt; new CopyOnWriteArrayList&amp;lt;&amp;gt;())&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; .add(exporter);&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;缓存已经暴露的服务&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;arcSize=6;" vertex="1" parent="1">
          <mxGeometry x="2040.0000000000002" y="4200" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-287" value="TODO&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="2279.9400000000005" y="4040" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-289" value="TODO&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="2279.9400000000005" y="4120" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-294" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-291" target="omU1pgqW6LJjpDUwzffS-293">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-296" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-291" target="omU1pgqW6LJjpDUwzffS-295">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-291" value="url = exportRemote(url, registryURLs, registerType);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;根据 url 中 scope 参数选择暴露方式，exportRemote()暴露到远程，？？？，流程和 exportLocal类似&lt;/font&gt;&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="1560" y="4280" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-293" value="MetadataUtils.publishServiceDefinition(url, providerModel.getServiceModel(), getApplicationModel());&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="1560" y="4360" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-295" value="TODO&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="1801.0000000000005" y="4280" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-301" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-298" target="omU1pgqW6LJjpDUwzffS-300">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-306" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-298" target="omU1pgqW6LJjpDUwzffS-305">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-298" value="&lt;div&gt;if (moduleModel != moduleModel.getApplicationModel()&lt;/div&gt;&lt;div&gt;.getInternalModule()) &lt;span style=&quot;background-color: initial;&quot;&gt;applicationDeployer.&lt;b&gt;prepareInternalModule&lt;/b&gt;();&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="830" y="4520" width="220" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-303" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-300" target="omU1pgqW6LJjpDUwzffS-302">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-300" value="&lt;div&gt;ModuleDeployer internalModuleDeployer =&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp;applicationModel.getInternalModule()&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;.getDeployer();&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="1080" y="4520" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-304" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-302" target="omU1pgqW6LJjpDUwzffS-194">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1300" y="4630" />
              <mxPoint x="1300" y="4590" />
              <mxPoint x="580" y="4590" />
              <mxPoint x="580" y="2925" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-302" value="Future future = internalModuleDeployer.&lt;b&gt;start&lt;/b&gt;();" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="1080" y="4600" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-308" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-305" target="omU1pgqW6LJjpDUwzffS-307">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-305" value="referServices();" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="840" y="4680" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-310" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-307" target="omU1pgqW6LJjpDUwzffS-309">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-307" value="onModuleStarted();" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="840" y="4760" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-312" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-309" target="omU1pgqW6LJjpDUwzffS-311">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-309" value="&amp;nbsp;registerServices();" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="840" y="4840" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-314" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-311" target="omU1pgqW6LJjpDUwzffS-313">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-311" value="checkReferences();" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="840" y="4920" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-313" value="completeStartFuture(true);" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="840" y="5000" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-316" style="orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=1;exitDx=0;exitDy=0;entryX=0.996;entryY=0.086;entryDx=0;entryDy=0;fillColor=#dae8fc;strokeColor=#6c8ebf;entryPerimeter=0;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-315" target="omU1pgqW6LJjpDUwzffS-282">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-323" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-315" target="omU1pgqW6LJjpDUwzffS-319">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-315" value="&lt;b&gt;protocolSPI&lt;/b&gt; = this.getExtensionLoader(&lt;b&gt;Protocol&lt;/b&gt;.class)&lt;br&gt;.getAdaptiveExtension();&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="2279.94" y="3880" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-318" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-317" target="omU1pgqW6LJjpDUwzffS-315">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-317" value="&lt;b&gt;ServiceConfig&lt;br&gt;#postProcessAfterScopeModelChanged()&lt;/b&gt;&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;前面创建“ServiceBean:&amp;lt;接口全限定名&amp;gt;::”类型Bean 调用构造方法时会调用此方法&lt;br&gt;&lt;/font&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="2041.0000000000002" y="3880" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-320" style="orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=0;entryDx=0;entryDy=0;fillColor=#dae8fc;strokeColor=#6c8ebf;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-319" target="omU1pgqW6LJjpDUwzffS-269">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-326" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-319" target="omU1pgqW6LJjpDUwzffS-324">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2500" y="3990" />
              <mxPoint x="2500" y="3750" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-335" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-319" target="omU1pgqW6LJjpDUwzffS-334">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-319" value="&lt;b&gt;proxyFactory&lt;/b&gt; = this.getExtensionLoader(&lt;br&gt;&lt;b&gt;ProxyFactory&lt;/b&gt;.class)&lt;br&gt;.getAdaptiveExtension();&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="2279.9700000000003" y="3960" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-329" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-324" target="omU1pgqW6LJjpDUwzffS-328">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-324" value="&lt;span style=&quot;font-weight: normal;&quot;&gt;return &lt;/span&gt;scopeModel&lt;span style=&quot;font-weight: normal;&quot;&gt;.getExtensionLoader(type);&lt;/span&gt;&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="2520" y="3720" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-327" value="AbstractConfig" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="2570.03" y="3690" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-332" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" edge="1" parent="1" source="omU1pgqW6LJjpDUwzffS-328" target="omU1pgqW6LJjpDUwzffS-331">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-328" value="&lt;span style=&quot;font-weight: normal;&quot;&gt;return this.getExtensionDirector()&lt;br&gt;.getExtensionLoader(type);&lt;br&gt;&lt;/span&gt;&lt;font style=&quot;font-weight: normal;&quot; color=&quot;#007fff&quot;&gt;getExtensionDirector() 获取 scopeModel的&amp;nbsp;extensionDirector&lt;/font&gt;&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="2760" y="3720" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-330" value="ExtensionAccessor" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="2795.03" y="3690" width="130" height="30" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-331" value="&lt;span style=&quot;font-weight: normal;&quot;&gt;ExtensionLoader&amp;lt;T&amp;gt; loader = (ExtensionLoader&amp;lt;T&amp;gt;) extensionLoadersMap.get(type);&lt;/span&gt;&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="3000.03" y="3720" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-333" value="ExtensionDirector" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="3040.03" y="3690" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="omU1pgqW6LJjpDUwzffS-334" value="&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="2520" y="3800" width="200" height="60" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
