# 事务基础

以MySQL事务为例。

## MySQL 日志文件



## 事务特性（ACID）

事务隔离性（I）由锁实现；

原子性（A）、持久性（D）通过数据库的 redolog 实现；

一致性（C）通过数据库的 undolog 实现。

### 事务的类型

+ 扁平事务

+ 带有保存点的扁平事务

  支持提交或回滚整个事务的部分事务。

+ 链式事务 

+ 嵌套事务

+ 分布式事务

  书上给的定义："分布式事务指的是事务的参与者、 事务所在的服务器、 涉及的资源服务器以及事务管理器等分
  别位于不同分布式系统的不同服务或数据库节点上"，感觉这个不是很准确，跨连接的事务都是分布式事务。

### 多个事务并发的问题

多事务并发问题：

+ 脏写 （写写冲突）

  两个事务同时更新同一行数据，导致覆盖。

+ 脏读 （读写冲突）

  一个事务读取到另外一个事务修改但是未提交的数据。

+ 不可重复读 （读写冲突）

  一个事务先后读取数据但是读取结果不一致，侧重更新删除。

+ 幻读

  ⼀个事务先后读取⼀个范围的数据，但是出现了新数据，侧重插入。

隔离级别：

+ RU
+ RC
+ RR
+ 序列化

MVCC机制