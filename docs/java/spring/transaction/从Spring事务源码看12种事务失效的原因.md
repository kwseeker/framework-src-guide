# 从Spring事务源码看12中事务失效的原因

场景总结参考：[Spring事务失效的12种场景](https://cloud.tencent.com/developer/article/2450738)

面试时这些场景让人一一列举出来很难能说的这么全，这里分析其失效原因也仅仅是从源码角度学会分析为何会失效，希望能在任何场景都能自行分析自己写的事务代码是否会生效，这比机械性地记忆失效场景有价值地多。

声明式事务源码流程图参考：spring-transaction.drawio 第二页，
测试代码参考： SpringBoot-Labs/spring-transaction （转账案例）。

Spring事务失效的12种场景：

+ 注解方法访问权限非public 
+ 注解方法被内部调用
+ 注解方法被final修饰
+ 未被 Spring 管理
+ 多线程调用
+ 表不支持事务
+ 错误的传播特性
+ 异常在方法内部被拦截且没有再抛出
+ 异常在方法内部被拦截但是重新抛出不会回滚的异常
+ 自定义只对某些异常回滚
+ 嵌套事务回滚多了





