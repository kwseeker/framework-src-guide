<mxfile host="Electron" modified="2024-12-29T05:38:31.092Z" agent="Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/21.6.5 Chrome/114.0.5735.243 Electron/25.3.1 Safari/537.36" etag="AMTSKoYm2nODGpEB1m5A" version="21.6.5" type="device" pages="2">
  <diagram id="sk2OgI7Z_z4Y8auxr5vS" name="Seata工作原理">
    <mxGraphModel dx="1434" dy="879" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="aerit6e2gWrA8Y1na4JQ-1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;fontSize=10;fontColor=#007FFF;curved=1;dashed=1;" parent="1" source="aerit6e2gWrA8Y1na4JQ-4" target="gtt-FEtx9EPwhSPMZbqh-49" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1450" y="1830" />
              <mxPoint x="1450" y="1540" />
              <mxPoint x="410" y="1540" />
              <mxPoint x="410" y="1250" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-1" value="&lt;h1&gt;Seata分布式事务（1.4.0）&lt;/h1&gt;&lt;p style=&quot;font-size: 10px&quot;&gt;&lt;font style=&quot;font-size: 10px&quot;&gt;前置知识：&lt;br&gt;&lt;/font&gt;&lt;/p&gt;&lt;ul style=&quot;font-size: 10px&quot;&gt;&lt;li&gt;&lt;font style=&quot;font-size: 10px&quot;&gt;Netty 应用&amp;amp;工作原理&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font style=&quot;font-size: 10px&quot;&gt;Seata AT模式工作流程（不熟悉流程，看代码逻辑可能会很困惑）AT模式相当于自动化的TCC模式&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font style=&quot;font-size: 10px&quot;&gt;Guava EventBus&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font style=&quot;font-size: 10px&quot;&gt;Spring AOP、IOC流程原理（AbstractAutoProxyCreator）及 Spring Bean实例化原理 （&lt;font style=&quot;font-size: 10px&quot; color=&quot;#007fff&quot;&gt;关于&lt;/font&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px&quot;&gt;GlobalTransactionScanner AOP逻辑已经抽离出一个Demo, 代码位于msa-middleware-analysis: seata:top.kwseeker.msa.seata.aop&lt;/font&gt;）还有 InitializingBean、事件、上下文感知等&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font style=&quot;font-size: 10px&quot;&gt;Spring 数据源管理原理；Spring事务原理、Mybatis事务支持、JDBC事务原理（有点层层套娃的感觉）；&lt;/font&gt;mybatis-spring&lt;br&gt;&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="20" y="19" width="620" height="181" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-4" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-2" target="gtt-FEtx9EPwhSPMZbqh-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-2" value="&lt;b&gt;Server start&lt;/b&gt;" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="60" y="200" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-6" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-3" target="gtt-FEtx9EPwhSPMZbqh-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-38" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;fontSize=8;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-3" target="gtt-FEtx9EPwhSPMZbqh-37" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-3" value="初始化" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="40" y="280" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-8" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=9;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-5" target="gtt-FEtx9EPwhSPMZbqh-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-16" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=9;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-5" target="gtt-FEtx9EPwhSPMZbqh-15" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-5" value="获取端口：默认8091（Netty服务器端口）&lt;br&gt;Metrics初始化（如果有配置的话）&lt;br&gt;创建了个参数解析器ParameterParser，&lt;br&gt;并读取事务会话存储模式，这里选择的db" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=left;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="200" y="280" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-10" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=9;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-7" target="gtt-FEtx9EPwhSPMZbqh-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-7" value="ParameterParser初始化阶段解析传参args中的配置，主要是port、storeMode、serverNode,这里测试没传参数，port用的默认的8091、storeMode是从文件file.conf解析的，serverNode是自动生成的" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=left;" parent="1" vertex="1">
          <mxGeometry x="440" y="280" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-9" value="关于storeMode的解析是ConfigurationFactory中完成的，更多配置信息解析后存储于FileConfiguration 实例&amp;nbsp;CURRENT_FILE_INSTANCE" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=left;" parent="1" vertex="1">
          <mxGeometry x="680" y="280" width="220" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-18" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=9;fontColor=#007FFF;curved=1;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-15" target="gtt-FEtx9EPwhSPMZbqh-17" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-42" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=8;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-15" target="gtt-FEtx9EPwhSPMZbqh-41" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-15" value="NettyRemotingServer &lt;b&gt;nettyRemotingServer&lt;/b&gt; = new &lt;b&gt;NettyRemotingServer&lt;/b&gt;(WORKING_THREADS);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;创建Netty Server实例&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="190" y="360" width="220" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-28" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=9;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-17" target="gtt-FEtx9EPwhSPMZbqh-19" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-17" value="&lt;b&gt;nettyRemotingServer&lt;/b&gt;.setListenPort(&lt;br&gt;parameterParser.getPort())" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="300" y="440" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-22" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=9;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-19" target="gtt-FEtx9EPwhSPMZbqh-21" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-19" value="&lt;b&gt;UUIDGenerator&lt;/b&gt;.init(parameterParser.getServerNode())" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="190" y="520" width="220" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-24" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=9;fontColor=#007FFF;curved=1;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-21" target="gtt-FEtx9EPwhSPMZbqh-23" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-46" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=7;fontColor=#007FFF;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-21" target="gtt-FEtx9EPwhSPMZbqh-53" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="460" y="620" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-21" value="&lt;b&gt;SessionHolder&lt;/b&gt;.init(parameterParser.getStoreMode())" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="190" y="600" width="220" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-30" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=9;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-23" target="gtt-FEtx9EPwhSPMZbqh-29" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-48" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=7;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-23" target="gtt-FEtx9EPwhSPMZbqh-47" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-23" value="DefaultCoordinator coordinator = new &lt;b&gt;DefaultCoordinator&lt;/b&gt;(nettyRemotingServer);&lt;br&gt;coordinator.init();&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;创建并初始化TC&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="200" y="900" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-32" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=9;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-29" target="gtt-FEtx9EPwhSPMZbqh-31" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-29" value="&lt;b&gt;nettyRemotingServer&lt;/b&gt;&lt;br&gt;.setHandler(coordinator)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="320" y="980" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-34" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=8;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-31" target="gtt-FEtx9EPwhSPMZbqh-33" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-52" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=7;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-31" target="gtt-FEtx9EPwhSPMZbqh-51" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-31" value="&lt;div style=&quot;font-size: 8px&quot;&gt;ShutdownHook.getInstance().addDisposable(coordinator);&lt;br&gt;&lt;span&gt;ShutdownHook.getInstance().addDisposable(nettyRemotingServer);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;退出后事处理钩子&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="180" y="1060" width="240" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-36" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=8;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-33" target="gtt-FEtx9EPwhSPMZbqh-35" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-33" value="&lt;div&gt;&lt;span style=&quot;font-size: 8px&quot;&gt;&lt;b&gt;XID&lt;/b&gt;.setIpAddress(NetUtil.getLocalIp())&lt;br&gt;&lt;/span&gt;XID.setPort(nettyRemotingServer.getListenPort())&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;？？？&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="200" y="1139" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-39" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=8;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-35" target="gtt-FEtx9EPwhSPMZbqh-37" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-50" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=7;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-35" target="gtt-FEtx9EPwhSPMZbqh-49" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-35" value="&lt;div&gt;&lt;font style=&quot;font-size: 10px&quot;&gt;nettyRemotingServer.init()&lt;/font&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="220" y="1220" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-37" value="Server stop" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="60" y="1300" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-40" value="core/src/main/java/io/seata/core/rpc/netty/NettyRemotingServer.java" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=8;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="170" y="340" width="260" height="20" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-44" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=8;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-41" target="gtt-FEtx9EPwhSPMZbqh-43" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-41" value="从前面的 FileConfiguration实例读取配置，赋值给NettyRemotingServer的字段，包括通信协议类型（TCP）、工作者线程数（16）、通信协议Server类型(NIO)、是否开启心跳、读写最大空闲时间等等" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="440" y="360" width="220" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-43" value="&lt;div style=&quot;font-size: 7px;&quot;&gt;&lt;div style=&quot;font-size: 7px;&quot;&gt;SERVER_CHANNEL_CLAZZ = NioServerSocketChannel.class;&lt;/div&gt;&lt;div style=&quot;font-size: 7px;&quot;&gt;CLIENT_CHANNEL_CLAZZ = NioSocketChannel.class;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=7;align=center;" parent="1" vertex="1">
          <mxGeometry x="680" y="360" width="220" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-72" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;fontSize=10;fontColor=#000000;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-47" target="gtt-FEtx9EPwhSPMZbqh-71" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-47" value="建了5个计划任务线程池&lt;br&gt;EventBus eventBus = EventBusManager.get();&lt;br&gt;&lt;b&gt;GuavaEventBus&lt;/b&gt;&lt;br&gt;保有NettyRemotingServer实例的引用&lt;br&gt;this.core = new DefaultCore(remotingServer)&lt;br&gt;&lt;b&gt;Map&amp;lt;BranchType, AbstractCore&amp;gt; coreMap&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="460" y="880" width="200" height="80" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-85" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#FFFF00;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-49" target="gtt-FEtx9EPwhSPMZbqh-84" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-87" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#FFFF00;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-49" target="gtt-FEtx9EPwhSPMZbqh-86" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-103" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=8;fontColor=#0066CC;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-49" target="gtt-FEtx9EPwhSPMZbqh-92" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-104" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=8;fontColor=#0066CC;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-49" target="gtt-FEtx9EPwhSPMZbqh-95" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-105" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=8;fontColor=#0066CC;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-49" target="gtt-FEtx9EPwhSPMZbqh-98" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-106" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=8;fontColor=#0066CC;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-49" target="gtt-FEtx9EPwhSPMZbqh-101" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-49" value="&lt;div&gt;&lt;font style=&quot;font-size: 10px&quot;&gt;registerProcessor()&lt;br&gt;&lt;/font&gt;&lt;font color=&quot;#0066cc&quot;&gt;注册了5大类型消息的处理器&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="420" y="1220" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-51" value="&lt;div style=&quot;font-size: 8px&quot;&gt;TODO&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="460" y="1060" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-55" value="DB" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=7;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-53" target="gtt-FEtx9EPwhSPMZbqh-54" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-57" value="FILE" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=7;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-53" target="gtt-FEtx9EPwhSPMZbqh-56" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-59" value="REDIS" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=7;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-53" target="gtt-FEtx9EPwhSPMZbqh-58" edge="1">
          <mxGeometry x="0.4167" relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="580" y="620" />
              <mxPoint x="580" y="740" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-68" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-53" target="gtt-FEtx9EPwhSPMZbqh-67" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-53" value="&lt;span style=&quot;color: rgb(0 , 0 , 0) ; font-size: 9px&quot;&gt;storeMode&lt;/span&gt;" style="rhombus;whiteSpace=wrap;html=1;fontSize=7;fontColor=#007FFF;rounded=1;arcSize=7;" parent="1" vertex="1">
          <mxGeometry x="460" y="580" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-62" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=9;fontColor=#000000;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-54" target="gtt-FEtx9EPwhSPMZbqh-61" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-54" value="&lt;font style=&quot;font-size: 9px&quot;&gt;&lt;font style=&quot;font-size: 9px&quot; color=&quot;#000000&quot;&gt;用增强的SPI根据storeMode动态加载SessionManager实现类并返回实例，这里是&lt;/font&gt;&lt;font color=&quot;#000000&quot; style=&quot;font-size: 9px&quot;&gt;&lt;b&gt;DataBaseSessionManager&lt;/b&gt;&lt;/font&gt;&lt;/font&gt;" style="whiteSpace=wrap;html=1;fontSize=7;fontColor=#007FFF;rounded=1;arcSize=7;" parent="1" vertex="1">
          <mxGeometry x="620" y="600" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-56" value="&lt;font style=&quot;font-size: 10px&quot; color=&quot;#000000&quot;&gt;略&lt;/font&gt;" style="whiteSpace=wrap;html=1;fontSize=7;fontColor=#007FFF;rounded=1;arcSize=7;" parent="1" vertex="1">
          <mxGeometry x="620" y="660" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-58" value="&lt;font style=&quot;font-size: 10px&quot; color=&quot;#000000&quot;&gt;略&lt;/font&gt;" style="whiteSpace=wrap;html=1;fontSize=7;fontColor=#007FFF;rounded=1;arcSize=7;" parent="1" vertex="1">
          <mxGeometry x="620" y="720" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-60" value="&lt;h1&gt;&lt;span style=&quot;font-size: 12px ; font-weight: normal&quot;&gt;可借鉴内容：&lt;/span&gt;&amp;nbsp;&lt;/h1&gt;&lt;font style=&quot;font-size: 10px&quot;&gt;1）EnhancedServiceLoader到底增强了什么？&lt;br&gt;2）Seata 怎么使用Netty NIO实现TM\RM与TC间的通信的？应该可以提取出来一个RPC工具&lt;br&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;(protobuf定义的协议格式、支持负载均衡)&lt;br&gt;3）Netty FastThreadLocal&lt;/font&gt;&lt;br&gt;&lt;p&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="640" y="19" width="660" height="181" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-61" value="&lt;font color=&quot;#000000&quot;&gt;&lt;font size=&quot;1&quot;&gt;一共创建了4个&lt;b&gt;DataBaseSessionManager&lt;/b&gt;实例，分别处理的taskName为&lt;/font&gt;&lt;br&gt;&lt;font size=&quot;1&quot;&gt;&quot;&lt;b&gt;root.data&lt;/b&gt;&quot;、&lt;/font&gt;&lt;font size=&quot;1&quot;&gt;&quot;&lt;b&gt;async.commit.data&lt;/b&gt;&quot;、&lt;/font&gt;&lt;br&gt;&lt;font size=&quot;1&quot;&gt;&quot;&lt;b&gt;retry.commit.data&lt;/b&gt;&quot;、&lt;/font&gt;&lt;font size=&quot;1&quot;&gt;&quot;&lt;b&gt;retry.rollback.data&lt;/b&gt;&quot;&lt;/font&gt;&lt;/font&gt;" style="whiteSpace=wrap;html=1;fontSize=7;rounded=1;arcSize=7;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="820" y="590" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-66" value="&lt;font color=&quot;#007fff&quot;&gt;这里用的构造器是DataBaseSessionManager(String name)&lt;br&gt;&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="830" y="570" width="180" height="20" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-67" value="&lt;font color=&quot;#000000&quot; style=&quot;font-size: 10px&quot;&gt;reload(storeMode)&lt;/font&gt;" style="whiteSpace=wrap;html=1;fontSize=7;fontColor=#007FFF;rounded=1;arcSize=7;" parent="1" vertex="1">
          <mxGeometry x="440" y="780" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-74" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#000000;dashed=1;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-71" target="gtt-FEtx9EPwhSPMZbqh-73" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="680" y="1000" />
              <mxPoint x="680" y="880" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-80" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;dashed=1;fontSize=10;fontColor=#000000;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-71" target="gtt-FEtx9EPwhSPMZbqh-76" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="680" y="1000" />
              <mxPoint x="680" y="940" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-81" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;dashed=1;fontSize=10;fontColor=#000000;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-71" target="gtt-FEtx9EPwhSPMZbqh-77" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-82" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;dashed=1;fontSize=10;fontColor=#000000;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-71" target="gtt-FEtx9EPwhSPMZbqh-78" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-83" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;dashed=1;fontSize=10;fontColor=#000000;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-71" target="gtt-FEtx9EPwhSPMZbqh-79" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-71" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;init()&lt;/span&gt;&lt;br&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 8px&quot;&gt;启动5个计划任务，前4个间隔一秒执行一次&lt;/font&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="500" y="980" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-73" value="&lt;div&gt;&lt;font style=&quot;font-size: 10px&quot;&gt;handleRetryRollbacking()&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="750" y="860" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-76" value="&lt;div&gt;&lt;font style=&quot;font-size: 10px&quot;&gt;handleRetryCommitting()&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="750" y="920" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-77" value="&lt;div&gt;&lt;font style=&quot;font-size: 10px&quot;&gt;handleAsyncCommitting()&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="750" y="980" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-78" value="&lt;div&gt;&lt;font style=&quot;font-size: 10px&quot;&gt;timeoutCheck()&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="750" y="1039" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-79" value="&lt;div&gt;&lt;font style=&quot;font-size: 10px&quot;&gt;undoLogDelete()&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="750" y="1100" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-108" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=8;fontColor=#0066CC;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-84" target="gtt-FEtx9EPwhSPMZbqh-107" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-84" value="&lt;div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;if (initialized.compareAndSet(false, true)) {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;&amp;nbsp; &amp;nbsp; super.init();&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;}&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=left;" parent="1" vertex="1">
          <mxGeometry x="390" y="1560" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-89" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#0066CC;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-86" target="gtt-FEtx9EPwhSPMZbqh-88" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-29" value="" style="edgeStyle=entityRelationEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;fontSize=10;fontColor=#007FFF;strokeColor=#000000;entryX=1;entryY=0;entryDx=0;entryDy=0;exitX=0;exitY=1;exitDx=0;exitDy=0;elbow=vertical;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-88" target="8FWh-XU32rv7k2cZ-J7P-28" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-86" value="&lt;font style=&quot;font-size: 8px&quot;&gt;TYPE_BRANCH_REGISTER&lt;br&gt;TYPE_BRANCH_STATUS_REPORT&lt;br&gt;TYPE_GLOBAL_BEGIN &lt;font color=&quot;#007fff&quot;&gt;开启全局事务&lt;/font&gt;&lt;br&gt;TYPE_GLOBAL_COMMIT&lt;br&gt;TYPE_GLOBAL_LOCK_QUERY&lt;br&gt;TYPE_GLOBAL_REPORT&lt;br&gt;TYPE_GLOBAL_ROLLBACK&lt;br&gt;TYPE_GLOBAL_STATUS&lt;br&gt;TYPE_SEATA_MERGE&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="620" y="1190" width="170" height="100" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-88" value="&lt;b&gt;ServerOnRequestProcessor&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="840" y="1220" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-91" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#0066CC;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-92" target="gtt-FEtx9EPwhSPMZbqh-93" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-92" value="&lt;span style=&quot;font-size: 8px&quot;&gt;TYPE_BRANCH_COMMIT_RESULT&lt;br&gt;&lt;/span&gt;TYPE_BRANCH_ROLLBACK_RESULT" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="620" y="1310" width="170" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-93" value="ServerOnResponseProcessor" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="840" y="1310" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-94" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#0066CC;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-95" target="gtt-FEtx9EPwhSPMZbqh-96" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-95" value="&lt;span style=&quot;font-size: 8px&quot;&gt;TYPE_REG_RM&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="620" y="1370" width="170" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-96" value="RegRmProcessor" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="840" y="1370" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-97" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#0066CC;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-98" target="gtt-FEtx9EPwhSPMZbqh-99" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-98" value="&lt;span style=&quot;font-size: 8px&quot;&gt;TYPE_REG_CLT&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="620" y="1430" width="170" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-99" value="RegTmProcessor" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="840" y="1430" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-100" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#0066CC;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-101" target="gtt-FEtx9EPwhSPMZbqh-102" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-101" value="&lt;span style=&quot;font-size: 8px&quot;&gt;TYPE_HEARTBEAT_MSG&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="620" y="1490" width="170" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-102" value="ServerHeartbeatProcessor" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="840" y="1490" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-110" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=8;fontColor=#0066CC;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-107" target="gtt-FEtx9EPwhSPMZbqh-109" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-107" value="&lt;span style=&quot;font-size: 10px&quot;&gt;AbstractNettyRemoting$init()&lt;/span&gt;&lt;br&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;启动一个计划任务每隔3s清理一下ConcurrentHashMap&amp;lt;Integer, &lt;b&gt;MessageFuture&lt;/b&gt;&amp;gt; futures中超时的MessageFuture&lt;/font&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="640" y="1550" width="220" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-115" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=8;fontColor=#007FFF;dashed=1;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-109" target="gtt-FEtx9EPwhSPMZbqh-114" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-118" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=8;fontColor=#007FFF;dashed=1;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-109" target="gtt-FEtx9EPwhSPMZbqh-116" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-121" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;dashed=1;fontSize=8;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-109" target="gtt-FEtx9EPwhSPMZbqh-119" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-124" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=8;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-109" target="gtt-FEtx9EPwhSPMZbqh-122" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-109" value="&lt;span style=&quot;font-size: 10px&quot;&gt;serverBootstrap.start()&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;启动Netty服务器&lt;/font&gt;&lt;br&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="680" y="1640" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-113" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fontSize=8;fontColor=#0066CC;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-111" target="gtt-FEtx9EPwhSPMZbqh-107" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-111" value="&lt;span style=&quot;font-size: 10px&quot;&gt;AbstractNettyRemoting$&lt;/span&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;&lt;b&gt;sendSync&lt;/b&gt;(Channel channel, RpcMessage rpcMessage, long timeoutMillis)&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="900" y="1560" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-114" value="&lt;span style=&quot;font-size: 10px&quot;&gt;ProtocolV1Decoder&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;消息协议解码器&lt;/font&gt;&lt;br&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="860" y="1640" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-116" value="&lt;span style=&quot;font-size: 10px&quot;&gt;ProtocolV1Encoder&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(0 , 127 , 255) ; font-size: 10px&quot;&gt;消息协议编码器&lt;/span&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;&lt;br&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="860" y="1720" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-3" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-119" target="aerit6e2gWrA8Y1na4JQ-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-119" value="&lt;span style=&quot;font-size: 10px&quot;&gt;AbstractNettyRemotingServer$&lt;br&gt;ServerHandler&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;Netty请求入口处理器&lt;/b&gt;，将收到的请求通过协议约定解析出类型，然后分发给前面的5大消息处理器处理&lt;/font&gt;&lt;br&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="860" y="1800" width="180" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-126" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=8;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-122" target="gtt-FEtx9EPwhSPMZbqh-125" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-122" value="&lt;span style=&quot;font-size: 10px&quot;&gt;RegistryFactory.getInstance().register(new &lt;b&gt;InetSocketAddress&lt;/b&gt;(XID.getIpAddress(), XID.getPort()));&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;将seata-server注册到注册中心，用于服务发现，这里用的file&lt;/font&gt;&lt;br&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="860" y="1900" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-125" value="&lt;span style=&quot;font-size: 10px&quot;&gt;FileRegistryServiceImpl&lt;/span&gt;&lt;br&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;直接从前面的Configuration实例（这里测试是FileConfiguration）查找&lt;/font&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="1100" y="1910" width="170" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-127" value="seata-1.4.0" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=8;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="140" y="210" width="60" height="20" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-134" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=8;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-128" target="gtt-FEtx9EPwhSPMZbqh-133" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-128" value="&lt;b&gt;Client start&lt;/b&gt;" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1700" y="200" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-129" value="" style="whiteSpace=wrap;html=1;rounded=1;fontSize=8;fillColor=#d5e8d4;gradientColor=#97d077;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1560" y="240" width="40" height="1640" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-130" value="seata-spring-boot-starter:1.4.0" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=8;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="1780" y="210" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-136" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-133" target="gtt-FEtx9EPwhSPMZbqh-135" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-138" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=10;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-133" target="gtt-FEtx9EPwhSPMZbqh-137" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-155" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;fontSize=10;fontColor=#007FFF;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-133" target="gtt-FEtx9EPwhSPMZbqh-156" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1740" y="560" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-133" value="&lt;font style=&quot;font-size: 10px&quot;&gt;还是从spring.factories中的自动配置类开始&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1680" y="280" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-140" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-135" target="gtt-FEtx9EPwhSPMZbqh-139" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-154" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=9;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-135" target="gtt-FEtx9EPwhSPMZbqh-148" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-135" value="&lt;font style=&quot;font-size: 10px&quot;&gt;SeataAutoConfiguration&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1840" y="280" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-144" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=9;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-137" target="gtt-FEtx9EPwhSPMZbqh-143" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-146" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=9;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-137" target="gtt-FEtx9EPwhSPMZbqh-145" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-137" value="&lt;font style=&quot;font-size: 10px&quot;&gt;HttpAutoConfiguration&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1840" y="480" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-160" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-139" target="gtt-FEtx9EPwhSPMZbqh-159" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-161" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontSize=10;fontColor=#007FFF;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-139" target="gtt-FEtx9EPwhSPMZbqh-162" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2220" y="350" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2200" y="300" />
              <mxPoint x="2200" y="350" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-139" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;new GlobalTransactionScanner(...)&lt;br&gt;&lt;/span&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 8px&quot;&gt;继承AbstractAutoProxyCreator，给被@GlobalTransactional注解的方法进行增强&lt;/font&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2000" y="280" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-142" value="&lt;div style=&quot;font-size: 9px&quot;&gt;&lt;font style=&quot;font-size: 9px&quot;&gt;&lt;font style=&quot;font-size: 9px&quot;&gt;GlobalTransactionScanner 继承 AbstractAutoProxyCreator 最终实现 BeanPostProcessor, 所以这个GlobalTransactionScanner会被加到 AbstractBeanFactory的 List&amp;lt;BeanPostProcessor&amp;gt; beanPostProcessors；&lt;/font&gt;然后 Bean 初始化后走到 postProcessAfterInitialization() 会挨个执行 beanPostProcessors 的 wrapIfNecessary() 方法，最终就会判断Bean类或方法上有@&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 9px&quot;&gt;GlobalTransactional注解，有的话在方法前后添加事务控制逻辑&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="2220" y="225" width="400" height="55" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-143" value="&lt;font style=&quot;font-size: 10px&quot;&gt;TransactionPropagationIntercepter&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;为Http请求添加了个拦截器&lt;/font&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2000" y="480" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-145" value="&lt;font style=&quot;font-size: 10px&quot;&gt;HttpHandlerExceptionResolver&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;为Http请求添加了异常处理器&lt;/font&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2000" y="540" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-152" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontSize=9;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-148" target="gtt-FEtx9EPwhSPMZbqh-150" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-153" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=9;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-148" target="gtt-FEtx9EPwhSPMZbqh-151" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-148" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;SeataDataSourceConfiguration&lt;br&gt;&lt;/span&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px&quot;&gt;Seata数据源配置&lt;/font&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2000" y="380" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-150" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;SeataDataSourceBeanPostProcessor&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2220" y="380" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-151" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;SeataAutoDataSourceProxyCreator&lt;br&gt;&lt;/span&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 8px&quot;&gt;同样是AOP动态代理增强&lt;/font&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2220" y="440" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-173" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=8;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-156" target="gtt-FEtx9EPwhSPMZbqh-157" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-156" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;执行下单方法（包含对多个数据源表的修改操作）&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1680" y="600" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-174" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=8;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-157" target="gtt-FEtx9EPwhSPMZbqh-171" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-157" value="&lt;font style=&quot;font-size: 8px&quot;&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;orderService.saveOrder(orderVo)&lt;br&gt;&lt;/span&gt;&lt;div&gt;&lt;span&gt;&lt;font color=&quot;#007fff&quot;&gt;此时的orderService是一个代理类，&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;font color=&quot;#007fff&quot;&gt;在创建Bean时被后置处理器GlobalTransactionalInterceptor增强&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1840" y="600" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-159" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;GlobalTransactionalInterceptor&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2220" y="280" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-164" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-162" target="gtt-FEtx9EPwhSPMZbqh-163" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-162" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;afterPropertiesSet()&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2220" y="330" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-166" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-163" target="gtt-FEtx9EPwhSPMZbqh-165" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-167" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontSize=10;fontColor=#007FFF;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-163" target="gtt-FEtx9EPwhSPMZbqh-168" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2530" y="430" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-170" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=10;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-163" target="gtt-FEtx9EPwhSPMZbqh-169" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-163" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;initClient()&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2440" y="330" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-165" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;&lt;b&gt;TMClient&lt;/b&gt;.init(applicationId, txServiceGroup, accessKey, secretKey)&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2560" y="330" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-168" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;&lt;b&gt;RMClient&lt;/b&gt;.init(applicationId, txServiceGroup)&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2560" y="380" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-169" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;registerSpringShutdownHook()&lt;br&gt;&lt;/span&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 9px&quot;&gt;spring客户端关闭后释放TM、RM连接&lt;/font&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2560" y="430" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-176" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=8;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-171" target="gtt-FEtx9EPwhSPMZbqh-175" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-171" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;&lt;b&gt;GlobalTransactionalInterceptor&lt;/b&gt;&lt;br&gt;$invoke()&lt;br&gt;&lt;/span&gt;&lt;font style=&quot;font-size: 9px&quot; color=&quot;#007fff&quot;&gt;增强的事务控制逻辑，内部进行事务管理以及调用sql方法&lt;/font&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="2040" y="590" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-180" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontSize=10;fontColor=#007FFF;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-175" target="gtt-FEtx9EPwhSPMZbqh-184" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2360" y="620" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-188" value="@GlobalTransactional" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=8;fontColor=#007FFF;" parent="gtt-FEtx9EPwhSPMZbqh-180" vertex="1" connectable="0">
          <mxGeometry x="0.309" relative="1" as="geometry">
            <mxPoint x="-5" y="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-183" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=10;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-175" target="gtt-FEtx9EPwhSPMZbqh-186" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2360" y="680" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-189" value="@GlobalLock" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=8;fontColor=#007FFF;" parent="gtt-FEtx9EPwhSPMZbqh-183" vertex="1" connectable="0">
          <mxGeometry x="0.1437" relative="1" as="geometry">
            <mxPoint y="4" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-193" value="没有注解" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;fontSize=8;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-175" target="gtt-FEtx9EPwhSPMZbqh-192" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-175" value="&lt;font style=&quot;font-size: 10px&quot;&gt;获取被代理类&lt;br&gt;方法上的注解&lt;/font&gt;" style="rhombus;whiteSpace=wrap;html=1;rounded=1;arcSize=10;" parent="1" vertex="1">
          <mxGeometry x="2240" y="595" width="80" height="50" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-191" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=8;fontColor=#007FFF;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-184" target="gtt-FEtx9EPwhSPMZbqh-190" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-184" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;handleGlobalTransaction(&lt;br&gt;methodInvocation, globalTransactionalAnnotation)&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2420" y="630" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="9hfFum3i3umnJGC0-6NU-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;curved=1;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-186" target="9hfFum3i3umnJGC0-6NU-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-186" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;handleGlobalLock(&lt;br&gt;methodInvocation, globalLockAnnotation)&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2420" y="570" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="3WeorWaQAVRrGxh3a_DP-2" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=8;fontColor=#007FFF;curved=1;" parent="1" source="gtt-FEtx9EPwhSPMZbqh-190" target="3WeorWaQAVRrGxh3a_DP-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-190" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;transactionalTemplate.execute()&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;" parent="1" vertex="1">
          <mxGeometry x="2620" y="630" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-192" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;methodInvocation.proceed()&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2210" y="680" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gtt-FEtx9EPwhSPMZbqh-195" value="TransactionalTemplate.java" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=8;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="2645" y="610" width="110" height="20" as="geometry" />
        </mxCell>
        <mxCell id="3WeorWaQAVRrGxh3a_DP-9" value="Switch" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=9;fontColor=#007FFF;" parent="1" source="3WeorWaQAVRrGxh3a_DP-1" target="3WeorWaQAVRrGxh3a_DP-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="3WeorWaQAVRrGxh3a_DP-1" value="&lt;font style=&quot;font-size: 9px&quot;&gt;&lt;b&gt;TransactionInfo&lt;/b&gt; txInfo = business.getTransactionInfo()&lt;br&gt;&lt;b&gt;GlobalTransaction&lt;/b&gt; tx = GlobalTransactionContext.getCurrent()&lt;br&gt;&lt;font color=&quot;#0066cc&quot;&gt;&lt;b&gt;1获取事务信息&lt;br&gt;&lt;/b&gt;txInfo内容就是注解属性值&lt;/font&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2820" y="610" width="260" height="60" as="geometry" />
        </mxCell>
        <mxCell id="3WeorWaQAVRrGxh3a_DP-10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;fontSize=9;fontColor=#007FFF;curved=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="3WeorWaQAVRrGxh3a_DP-7" target="3WeorWaQAVRrGxh3a_DP-12" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2850" y="810" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2950" y="740" />
              <mxPoint x="2575" y="740" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="3WeorWaQAVRrGxh3a_DP-11" value="NOT_SUPPORTED" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#007FFF;" parent="3WeorWaQAVRrGxh3a_DP-10" vertex="1" connectable="0">
          <mxGeometry x="-0.1464" y="2" relative="1" as="geometry">
            <mxPoint x="-149" y="3" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="3WeorWaQAVRrGxh3a_DP-14" value="SUPPORTS" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=9;fontColor=#007FFF;" parent="1" source="3WeorWaQAVRrGxh3a_DP-7" target="3WeorWaQAVRrGxh3a_DP-13" edge="1">
          <mxGeometry x="0.44" relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2950" y="760" />
              <mxPoint x="2875" y="760" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="3WeorWaQAVRrGxh3a_DP-19" value="REQUIRES_NEW" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=9;fontColor=#007FFF;" parent="1" source="3WeorWaQAVRrGxh3a_DP-7" target="3WeorWaQAVRrGxh3a_DP-16" edge="1">
          <mxGeometry x="0.3869" relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2950" y="750" />
              <mxPoint x="2726" y="750" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="3WeorWaQAVRrGxh3a_DP-20" value="REQUIRED（默认）" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=9;fontColor=#007FFF;" parent="1" source="3WeorWaQAVRrGxh3a_DP-7" target="3WeorWaQAVRrGxh3a_DP-15" edge="1">
          <mxGeometry x="0.68" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="3WeorWaQAVRrGxh3a_DP-21" value="NEVER" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;fontSize=9;fontColor=#007FFF;" parent="1" source="3WeorWaQAVRrGxh3a_DP-7" target="3WeorWaQAVRrGxh3a_DP-17" edge="1">
          <mxGeometry x="0.6" relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2950" y="750" />
              <mxPoint x="3175" y="750" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="3WeorWaQAVRrGxh3a_DP-22" value="MANDATORY" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=9;fontColor=#007FFF;" parent="1" source="3WeorWaQAVRrGxh3a_DP-7" target="3WeorWaQAVRrGxh3a_DP-18" edge="1">
          <mxGeometry x="0.5059" relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2950" y="740" />
              <mxPoint x="3325" y="740" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="3WeorWaQAVRrGxh3a_DP-7" value="Propagation propagation = txInfo.getPropagation()&lt;br&gt;事务传播类型" style="rhombus;whiteSpace=wrap;html=1;fontSize=8;fontColor=#007FFF;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="2890" y="690" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="3WeorWaQAVRrGxh3a_DP-12" value="" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="2510" y="780" width="130" height="40" as="geometry" />
        </mxCell>
        <mxCell id="3WeorWaQAVRrGxh3a_DP-13" value="" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="2810" y="780" width="130" height="40" as="geometry" />
        </mxCell>
        <mxCell id="9hfFum3i3umnJGC0-6NU-6" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="3WeorWaQAVRrGxh3a_DP-15" target="9hfFum3i3umnJGC0-6NU-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="3WeorWaQAVRrGxh3a_DP-15" value="什么都没做，&lt;br&gt;直接break退出switch" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="2960" y="780" width="130" height="40" as="geometry" />
        </mxCell>
        <mxCell id="3WeorWaQAVRrGxh3a_DP-16" value="" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="2661" y="780" width="130" height="40" as="geometry" />
        </mxCell>
        <mxCell id="3WeorWaQAVRrGxh3a_DP-17" value="" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="3110" y="780" width="130" height="40" as="geometry" />
        </mxCell>
        <mxCell id="3WeorWaQAVRrGxh3a_DP-18" value="" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="3260" y="780" width="130" height="40" as="geometry" />
        </mxCell>
        <mxCell id="3WeorWaQAVRrGxh3a_DP-26" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=9;fontColor=#000000;" parent="1" source="3WeorWaQAVRrGxh3a_DP-23" target="3WeorWaQAVRrGxh3a_DP-25" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="3WeorWaQAVRrGxh3a_DP-23" value="&lt;font color=&quot;#000000&quot;&gt;GlobalLockConfig previousConfig = replaceGlobalLockConfig(txInfo)&lt;/font&gt;&lt;br&gt;&lt;font style=&quot;font-size: 8px&quot;&gt;存储当前tx信息到GlobalLockConfigHolder&lt;/font&gt;" style="whiteSpace=wrap;html=1;fontSize=9;fontColor=#007FFF;rounded=1;strokeColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="2940" y="919" width="170" height="41" as="geometry" />
        </mxCell>
        <mxCell id="3WeorWaQAVRrGxh3a_DP-28" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=9;fontColor=#007FFF;" parent="1" source="3WeorWaQAVRrGxh3a_DP-25" target="3WeorWaQAVRrGxh3a_DP-27" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="O6Wsa5e4rOjhvhJTCMX4-3" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=9;fontColor=#3399FF;" parent="1" source="3WeorWaQAVRrGxh3a_DP-25" target="O6Wsa5e4rOjhvhJTCMX4-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="3WeorWaQAVRrGxh3a_DP-25" value="&lt;font color=&quot;#000000&quot;&gt;beginTransaction(txInfo, tx)&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;2 开启全局事务&lt;/b&gt;&lt;/font&gt;" style="whiteSpace=wrap;html=1;fontSize=9;rounded=1;strokeColor=#36393d;fillColor=#cdeb8b;" parent="1" vertex="1">
          <mxGeometry x="2950" y="979" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="3WeorWaQAVRrGxh3a_DP-35" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=9;fontColor=#007FFF;" parent="1" source="3WeorWaQAVRrGxh3a_DP-27" target="3WeorWaQAVRrGxh3a_DP-34" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="3WeorWaQAVRrGxh3a_DP-44" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontSize=9;fontColor=#007FFF;" parent="1" source="3WeorWaQAVRrGxh3a_DP-27" target="3WeorWaQAVRrGxh3a_DP-43" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="3WeorWaQAVRrGxh3a_DP-27" value="&lt;font color=&quot;#000000&quot;&gt;&amp;nbsp;rs = business.execute();&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;执行业务逻辑，即前面的saveOrder()&lt;br&gt;&lt;b&gt;里边会提交分支事务&lt;/b&gt;&lt;br&gt;&lt;/font&gt;" style="whiteSpace=wrap;html=1;fontSize=9;rounded=1;strokeColor=#36393d;fillColor=#cdeb8b;" parent="1" vertex="1">
          <mxGeometry x="2950" y="1169" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-58" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=8;fontColor=#007FFF;" parent="1" source="3WeorWaQAVRrGxh3a_DP-29" target="3WeorWaQAVRrGxh3a_DP-31" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="3WeorWaQAVRrGxh3a_DP-29" value="&lt;font color=&quot;#000000&quot;&gt;&amp;nbsp;commitTransaction(tx)&lt;/font&gt;&lt;br&gt;&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;4 正常则提交事务&lt;/font&gt;&lt;/b&gt;" style="whiteSpace=wrap;html=1;fontSize=9;rounded=1;strokeColor=#36393d;fillColor=#cdeb8b;" parent="1" vertex="1">
          <mxGeometry x="3140" y="1417" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="3WeorWaQAVRrGxh3a_DP-31" value="&lt;font color=&quot;#000000&quot;&gt;&amp;nbsp; finally:&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#000000&quot;&gt;&amp;nbsp; resumeGlobalLockConfig(previousConfig)&lt;/font&gt;&lt;br&gt;&lt;div style=&quot;color: rgb(0 , 0 , 0)&quot;&gt;&amp;nbsp; triggerAfterCompletion();&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#000000&quot;&gt;&amp;nbsp; cleanUp()&lt;/font&gt;&lt;br&gt;&lt;b&gt;&amp;nbsp; &lt;font color=&quot;#007fff&quot;&gt;5 释放资源&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;fontSize=9;rounded=1;strokeColor=#36393d;align=left;fillColor=#cdeb8b;" parent="1" vertex="1">
          <mxGeometry x="2925" y="1499" width="200" height="61" as="geometry" />
        </mxCell>
        <mxCell id="3WeorWaQAVRrGxh3a_DP-40" value="正常" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=9;fontColor=#007FFF;" parent="1" source="3WeorWaQAVRrGxh3a_DP-34" target="3WeorWaQAVRrGxh3a_DP-29" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="3WeorWaQAVRrGxh3a_DP-41" value="异常" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fontSize=9;fontColor=#007FFF;" parent="1" source="3WeorWaQAVRrGxh3a_DP-34" target="3WeorWaQAVRrGxh3a_DP-37" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="3WeorWaQAVRrGxh3a_DP-34" value="业务逻辑执行" style="rhombus;whiteSpace=wrap;html=1;rounded=1;fontSize=9;fontColor=#007FFF;strokeColor=#000000;arcSize=11;" parent="1" vertex="1">
          <mxGeometry x="2980" y="1418" width="90" height="40.5" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-57" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=8;fontColor=#007FFF;" parent="1" source="3WeorWaQAVRrGxh3a_DP-37" target="3WeorWaQAVRrGxh3a_DP-31" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="3WeorWaQAVRrGxh3a_DP-37" value="&lt;div&gt;&lt;span style=&quot;color: rgb(0 , 0 , 0)&quot;&gt;completeTransactionAfterThrowing(&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(0 , 0 , 0)&quot;&gt;&lt;span&gt;txInfo, tx, ex);&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#000000&quot;&gt;throw ex;&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#3399ff&quot;&gt;&lt;b&gt;3 异常回滚事务&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;fontSize=9;rounded=1;strokeColor=#36393d;align=center;fillColor=#cdeb8b;" parent="1" vertex="1">
          <mxGeometry x="2750" y="1418.5" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-43" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="1" source="3WeorWaQAVRrGxh3a_DP-43" target="aerit6e2gWrA8Y1na4JQ-42" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="3WeorWaQAVRrGxh3a_DP-43" value="&lt;font color=&quot;#000000&quot;&gt;methodInvocation.proceed()&lt;/font&gt;" style="whiteSpace=wrap;html=1;fontSize=9;fontColor=#007FFF;rounded=1;strokeColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="3140" y="1169" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="9hfFum3i3umnJGC0-6NU-2" value="&lt;font&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;暂略&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2620" y="570" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="9hfFum3i3umnJGC0-6NU-7" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="9hfFum3i3umnJGC0-6NU-5" target="3WeorWaQAVRrGxh3a_DP-23" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9hfFum3i3umnJGC0-6NU-5" value="&lt;font color=&quot;#000000&quot;&gt;tx = GlobalTransactionContext.createNew()&lt;/font&gt;&lt;br&gt;创建DefaultGlobalTransaction实例，持有TransactionManager对象" style="whiteSpace=wrap;html=1;fontSize=9;fontColor=#007FFF;rounded=1;strokeColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="2940" y="860" width="170" height="40" as="geometry" />
        </mxCell>
        <mxCell id="9hfFum3i3umnJGC0-6NU-9" value="&lt;font style=&quot;font-size: 8px ; line-height: 1&quot;&gt;&lt;span&gt;所以GlobalTransaction本质就是TM&lt;/span&gt;&lt;br&gt;&lt;span&gt;用于开始、提交或回滚全局事务，只不过额外封装了xid、状态、角色属性&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="3110" y="865" width="150" height="35" as="geometry" />
        </mxCell>
        <mxCell id="O6Wsa5e4rOjhvhJTCMX4-1" value="需要结合AT模式流程看" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontColor=#3399FF;" parent="1" vertex="1">
          <mxGeometry x="1680" y="640" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="O6Wsa5e4rOjhvhJTCMX4-5" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=9;fontColor=#3399FF;" parent="1" source="O6Wsa5e4rOjhvhJTCMX4-2" target="O6Wsa5e4rOjhvhJTCMX4-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="O6Wsa5e4rOjhvhJTCMX4-2" value="triggerBeforeBegin()&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;开启前执行，不重要&lt;/font&gt;" style="whiteSpace=wrap;html=1;fontSize=9;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="3140" y="979" width="140" height="41" as="geometry" />
        </mxCell>
        <mxCell id="O6Wsa5e4rOjhvhJTCMX4-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=9;fontColor=#3399FF;" parent="1" source="O6Wsa5e4rOjhvhJTCMX4-4" target="O6Wsa5e4rOjhvhJTCMX4-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="O6Wsa5e4rOjhvhJTCMX4-9" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=9;fontColor=#007FFF;" parent="1" source="O6Wsa5e4rOjhvhJTCMX4-4" target="O6Wsa5e4rOjhvhJTCMX4-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="O6Wsa5e4rOjhvhJTCMX4-4" value="tx.begin(txInfo.getTimeOut(), txInfo.getName())" style="whiteSpace=wrap;html=1;fontSize=9;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="3140" y="1040" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="O6Wsa5e4rOjhvhJTCMX4-6" value="triggerAfterBegin()&lt;br&gt;" style="whiteSpace=wrap;html=1;fontSize=9;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="3140" y="1099" width="140" height="41" as="geometry" />
        </mxCell>
        <mxCell id="O6Wsa5e4rOjhvhJTCMX4-11" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=9;fontColor=#007FFF;" parent="1" source="O6Wsa5e4rOjhvhJTCMX4-8" target="O6Wsa5e4rOjhvhJTCMX4-10" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="O6Wsa5e4rOjhvhJTCMX4-13" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=9;fontColor=#007FFF;" parent="1" source="O6Wsa5e4rOjhvhJTCMX4-8" target="O6Wsa5e4rOjhvhJTCMX4-12" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="O6Wsa5e4rOjhvhJTCMX4-8" value="xid = transactionManager.begin(null, null, name, timeout)&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;调用TM begin() 开启全局事务&lt;br&gt;返回全局事务ID&lt;/font&gt;" style="whiteSpace=wrap;html=1;fontSize=9;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="3320" y="1040" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="O6Wsa5e4rOjhvhJTCMX4-10" value="status = GlobalStatus.Begin&lt;br&gt;RootContext.bind(xid)&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;修改状态：开始，记录全局事务ID&lt;/font&gt;" style="whiteSpace=wrap;html=1;fontSize=9;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="3320" y="1100" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="O6Wsa5e4rOjhvhJTCMX4-15" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=9;fontColor=#007FFF;curved=1;" parent="1" source="O6Wsa5e4rOjhvhJTCMX4-12" target="O6Wsa5e4rOjhvhJTCMX4-14" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="O6Wsa5e4rOjhvhJTCMX4-12" value="request = new GlobalBeginRequest();&lt;br&gt;GlobalBeginResponse response = (GlobalBeginResponse) syncCall(request);" style="whiteSpace=wrap;html=1;fontSize=9;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="3520" y="1040" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-2" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=9;fontColor=#007FFF;" parent="1" source="O6Wsa5e4rOjhvhJTCMX4-14" target="8FWh-XU32rv7k2cZ-J7P-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="O6Wsa5e4rOjhvhJTCMX4-14" value="&lt;b&gt;TmNettyRemotingClient&lt;/b&gt;.getInstance()&lt;br&gt;.sendSyncRequest(request)&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;其实是借Netty封装的RPC调用&lt;br&gt;消息格式：RpcMessage&lt;br&gt;&lt;/font&gt;" style="whiteSpace=wrap;html=1;fontSize=9;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="3740" y="1029" width="180" height="62" as="geometry" />
        </mxCell>
        <mxCell id="O6Wsa5e4rOjhvhJTCMX4-16" value="seata-core: io.seata.core.rpc" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=9;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="3760" y="1009" width="130" height="20" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-4" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=9;fontColor=#007FFF;" parent="1" source="8FWh-XU32rv7k2cZ-J7P-1" target="8FWh-XU32rv7k2cZ-J7P-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-1" value="&lt;b&gt;TmNettyRemotingClient&lt;/b&gt;.getInstance()&lt;br&gt;.sendSyncRequest(request)&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;其实是借Netty封装的RPC调用&lt;br&gt;消息格式：RpcMessage&lt;br&gt;&lt;/font&gt;" style="whiteSpace=wrap;html=1;fontSize=9;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="3960" y="1028" width="180" height="62" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-25" style="edgeStyle=entityRelationEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0;exitDx=0;exitDy=0;entryX=1;entryY=1;entryDx=0;entryDy=0;fontSize=10;fontColor=#007FFF;elbow=vertical;shape=link;width=-3.333333333333334;strokeColor=#007FFF;" parent="1" source="8FWh-XU32rv7k2cZ-J7P-3" target="8FWh-XU32rv7k2cZ-J7P-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-3" value="&lt;b&gt;basket.offer&lt;/b&gt;(rpcMessage)&lt;br&gt;&lt;b&gt;messageFuture.get&lt;/b&gt;(timeoutMillis, TimeUnit.MILLISECONDS)&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;还是通过队列异步往外发RPC请求&lt;br&gt;通过CompletableFuture机制获取异步结果&lt;/font&gt;" style="whiteSpace=wrap;html=1;fontSize=9;rounded=1;fillColor=#cdeb8b;strokeColor=#36393d;" parent="1" vertex="1">
          <mxGeometry x="4180" y="1028" width="180" height="62" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-9" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="1" source="8FWh-XU32rv7k2cZ-J7P-5" target="8FWh-XU32rv7k2cZ-J7P-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-5" value="GlobalTransactionScanner#&lt;br&gt;afterPropertiesSet()&lt;br&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px&quot;&gt;Spring InitializingBean接口方法&lt;/font&gt;" style="whiteSpace=wrap;html=1;fontSize=12;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="3520" y="800" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-21" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;fontSize=10;fontColor=#007FFF;" parent="1" source="8FWh-XU32rv7k2cZ-J7P-6" target="8FWh-XU32rv7k2cZ-J7P-20" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-6" value="msg = basket.poll()" style="whiteSpace=wrap;html=1;fontSize=12;rounded=1;fillColor=#cdeb8b;strokeColor=#36393d;" parent="1" vertex="1">
          <mxGeometry x="3520" y="880" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-7" value="&lt;font style=&quot;font-size: 10px&quot;&gt;倒推，可以发现在自动配置阶段启动了&lt;br&gt;消息推送线程，用于读取队列中的消息推到Netty服务端&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=12;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="3480" y="770" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-11" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="1" source="8FWh-XU32rv7k2cZ-J7P-8" target="8FWh-XU32rv7k2cZ-J7P-10" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-8" value="initClient()" style="whiteSpace=wrap;html=1;fontSize=12;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="3740" y="800" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-13" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="1" source="8FWh-XU32rv7k2cZ-J7P-10" target="8FWh-XU32rv7k2cZ-J7P-12" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-15" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="1" source="8FWh-XU32rv7k2cZ-J7P-10" target="8FWh-XU32rv7k2cZ-J7P-14" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-10" value="TMClient.init(applicationId, txServiceGroup, accessKey, secretKey)" style="whiteSpace=wrap;html=1;fontSize=10;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="3960" y="800" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-12" value="RMClient.init(applicationId, txServiceGroup)" style="whiteSpace=wrap;html=1;fontSize=10;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="3960" y="860" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-17" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="1" source="8FWh-XU32rv7k2cZ-J7P-14" target="8FWh-XU32rv7k2cZ-J7P-16" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-14" value="TmNettyRemotingClient.getInstance(...)&lt;br&gt;tmNettyRemotingClient.init()" style="whiteSpace=wrap;html=1;fontSize=10;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="4180" y="800" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-18" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=10;fontColor=#007FFF;dashed=1;" parent="1" source="8FWh-XU32rv7k2cZ-J7P-16" target="8FWh-XU32rv7k2cZ-J7P-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-16" value="1）注册返回值处理器，包括心跳返回处理器&lt;br&gt;2）创建断线重连的定时任务&lt;br&gt;3）创建线程池处理批量发送消息任务&lt;br&gt;4）创建定时任务，清除过期的返回值消息" style="whiteSpace=wrap;html=1;fontSize=10;rounded=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="4400" y="787.5" width="220" height="65" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-24" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="1" source="8FWh-XU32rv7k2cZ-J7P-20" target="8FWh-XU32rv7k2cZ-J7P-23" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-20" value="AbstractNettyRemotingClient.this&lt;br&gt;.sendAsyncRequest(sendChannel, mergeMessage)" style="whiteSpace=wrap;html=1;fontSize=12;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="3500" y="940.5" width="220" height="40" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-27" value="" style="edgeStyle=entityRelationEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;strokeColor=#000000;elbow=vertical;dashed=1;" parent="1" source="8FWh-XU32rv7k2cZ-J7P-23" target="8FWh-XU32rv7k2cZ-J7P-26" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-23" value="channel.writeAndFlush(rpcMessage)&lt;br&gt;.addListener(...)&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;通过Netty发送RPC调用&lt;/font&gt;" style="whiteSpace=wrap;html=1;fontSize=12;rounded=1;fillColor=#cdeb8b;strokeColor=#36393d;" parent="1" vertex="1">
          <mxGeometry x="3760" y="940" width="220" height="40" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-26" value="&lt;span style=&quot;font-size: 9px&quot;&gt;消息最终发到seata-server（就是TC）&lt;br&gt;的&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 9px&quot;&gt;&lt;b&gt;ServerOnRequestProcessor&lt;/b&gt;&lt;/span&gt;" style="whiteSpace=wrap;html=1;fontSize=12;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="4040" y="940.5" width="220" height="40" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-31" value="" style="edgeStyle=entityRelationEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;strokeColor=#000000;elbow=vertical;" parent="1" source="8FWh-XU32rv7k2cZ-J7P-28" target="8FWh-XU32rv7k2cZ-J7P-30" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-28" value="DefaultCoordinator" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="230" y="2000" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-33" value="&lt;span style=&quot;font-size: 8px ; background-color: rgb(248 , 249 , 250)&quot;&gt;TYPE_GLOBAL_BEGIN&lt;/span&gt;" style="edgeStyle=entityRelationEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;strokeColor=#000000;elbow=vertical;" parent="1" source="8FWh-XU32rv7k2cZ-J7P-30" target="8FWh-XU32rv7k2cZ-J7P-32" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-30" value="onRequest(AbstractMessage request, RpcContext context)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="420" y="2000" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-35" value="" style="edgeStyle=entityRelationEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;strokeColor=#000000;elbow=vertical;" parent="1" source="8FWh-XU32rv7k2cZ-J7P-32" target="8FWh-XU32rv7k2cZ-J7P-34" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-32" value="&lt;b&gt;GlobalBeginRequest&lt;/b&gt;#&lt;br&gt;handle(RpcContext rpcContext)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="700" y="2000" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-7" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="1" source="8FWh-XU32rv7k2cZ-J7P-34" target="aerit6e2gWrA8Y1na4JQ-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8FWh-XU32rv7k2cZ-J7P-34" value="&lt;b&gt;DefaultCoordinator&lt;/b&gt;#&lt;br&gt;&lt;b&gt;doGlobalBegin(request, response, rpcContext)&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="900" y="2000" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-5" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="1" source="aerit6e2gWrA8Y1na4JQ-2" target="aerit6e2gWrA8Y1na4JQ-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-2" value="&lt;span style=&quot;font-size: 10px&quot;&gt;channelRead()&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="1080" y="1810" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-4" value="&lt;span style=&quot;font-size: 10px&quot;&gt;AbstractNettyRemoting&lt;/span&gt;&lt;br&gt;&lt;span style=&quot;font-size: 10px&quot;&gt;#processMessage(ctx, (RpcMessage) msg)&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;解析消息类型，找到对应的处理器处理&lt;/font&gt;&lt;br&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="1241" y="1800" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-9" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="1" source="aerit6e2gWrA8Y1na4JQ-6" target="aerit6e2gWrA8Y1na4JQ-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-6" value="&lt;div&gt;xid = core.begin(...&lt;span&gt;)&lt;/span&gt;&lt;/div&gt;response.setXid(xid)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="1100" y="2000" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-11" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="1" source="aerit6e2gWrA8Y1na4JQ-8" target="aerit6e2gWrA8Y1na4JQ-10" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-17" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="1" source="aerit6e2gWrA8Y1na4JQ-8" target="aerit6e2gWrA8Y1na4JQ-16" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-8" value="GlobalSession.createGlobalSession(...)&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="1260" y="2000" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-13" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="1" source="aerit6e2gWrA8Y1na4JQ-10" target="aerit6e2gWrA8Y1na4JQ-12" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-19" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="1" source="aerit6e2gWrA8Y1na4JQ-10" target="aerit6e2gWrA8Y1na4JQ-18" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-10" value="session.addSessionLifecycleListener(&lt;br&gt;SessionHolder.getRootSessionManager())&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;注册SessionManager监听会话的生命周期(全局事务开启、状态变更、分支事务状态变更、事务关闭、会话关闭等)&lt;/font&gt;&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="1241" y="2060" width="199" height="60" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-15" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="1" source="aerit6e2gWrA8Y1na4JQ-12" target="aerit6e2gWrA8Y1na4JQ-14" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-21" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="1" source="aerit6e2gWrA8Y1na4JQ-12" target="aerit6e2gWrA8Y1na4JQ-20" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-12" value="session.begin()&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;修改会话状态，并将会话信息存储到数据库（测试中选的MySQL）&lt;/font&gt;&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="1260" y="2140" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-39" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.75;entryDx=0;entryDy=0;fontSize=8;fontColor=#007FFF;" parent="1" source="aerit6e2gWrA8Y1na4JQ-14" target="aerit6e2gWrA8Y1na4JQ-6" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1240" y="2220" />
              <mxPoint x="1240" y="2030" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-14" value="eventBus.post(new GlobalTransactionEvent(...))&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;这个事件总线是给监控用的，不是主线，先略&lt;/font&gt;&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="1260" y="2200" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-16" value="&amp;nbsp;XID.generateXID(transactionId)&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;XID= ip地址:端口:UUID&lt;/font&gt;&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="1460" y="2000" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-18" value="ROOT_SESSION_MANAGER = EnhancedServiceLoader.load(SessionManager.class, StoreMode.DB.getName())&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;主要是会话信息的增删改查，测试中选择了MySQL这里实例化的就是&lt;b&gt;DataBaseSessionManager&lt;/b&gt;&lt;/font&gt;&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="1481" y="2060" width="219" height="60" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-23" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="1" source="aerit6e2gWrA8Y1na4JQ-20" target="aerit6e2gWrA8Y1na4JQ-22" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-20" value="session.begin()&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="1460" y="2140" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-25" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="1" source="aerit6e2gWrA8Y1na4JQ-22" target="aerit6e2gWrA8Y1na4JQ-24" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-22" value="addGlobalSession(globalSession)&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="1660" y="2140" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-30" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=8;fontColor=#007FFF;" parent="1" source="aerit6e2gWrA8Y1na4JQ-24" target="aerit6e2gWrA8Y1na4JQ-29" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-24" value="transactionStoreManager&lt;br&gt;.writeSession(LogOperation.GLOBAL_ADD, session)&lt;br&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 8px&quot;&gt;AbstractSessionManager包含TransactionStoreManager对象引用，操作数据库进行数据存取，测试中用的&lt;b&gt;DataBaseTransactionStoreManager&lt;/b&gt; 借助JDBC进行数据存取&lt;/font&gt;&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="1860" y="2130" width="240" height="60" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-26" value="AbtractSessionManager" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="1680" y="2120" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-29" value="LogStoreDataBaseDAO&lt;br&gt;#insertGlobalTransactionDO()&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;session信息插入global_table表&lt;/font&gt;&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="2140" y="2140" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-38" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;dashed=1;fontSize=8;fontColor=#007FFF;" parent="1" source="aerit6e2gWrA8Y1na4JQ-35" target="aerit6e2gWrA8Y1na4JQ-14" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-35" value="EventBusManager.get().register(new MetricsSubscriber(registry));&lt;br&gt;&lt;div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;align=center;" parent="1" vertex="1">
          <mxGeometry x="1460" y="2200" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-37" value="DefaultCore.java" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=8;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="1301" y="1980" width="80" height="20" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-40" value="TransactionalTemplate.java" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=8;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="2895" y="590" width="110" height="20" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-45" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="1" source="aerit6e2gWrA8Y1na4JQ-42" target="aerit6e2gWrA8Y1na4JQ-44" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-42" value="&lt;font color=&quot;#000000&quot;&gt;OrderServiceImpl#saveOrder(OrderVo orderVo)&lt;/font&gt;" style="whiteSpace=wrap;html=1;fontSize=9;fontColor=#007FFF;rounded=1;strokeColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="3320" y="1169" width="160" height="41" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-44" value="&lt;font color=&quot;#000000&quot;&gt;PreparedStatementProxy#execute()&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;经过Spring、Mybatis 数据源层层代理，进入到Seata；这个还是需要先理解mybatis、spring 以及seata DataSourceProxy 对数据源的代理, 还有获取数据源连接并执行sql的流程&lt;/font&gt;" style="whiteSpace=wrap;html=1;fontSize=9;rounded=1;strokeColor=#36393d;fillColor=#cdeb8b;" parent="1" vertex="1">
          <mxGeometry x="3520" y="1158.5" width="200" height="61" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-46" value="&lt;font color=&quot;#007fff&quot;&gt;io.seata.rm.datasource.&lt;/font&gt;&lt;span style=&quot;font-size: 9px&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;PreparedStatementProxy.java&lt;/font&gt;&lt;br&gt;&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="3500" y="1138.5" width="240" height="20" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-49" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;fontColor=#007FFF;" parent="1" source="aerit6e2gWrA8Y1na4JQ-47" target="aerit6e2gWrA8Y1na4JQ-48" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-56" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=8;fontColor=#007FFF;dashed=1;" parent="1" source="aerit6e2gWrA8Y1na4JQ-47" target="aerit6e2gWrA8Y1na4JQ-55" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="3300" y="1260" />
              <mxPoint x="3300" y="1380" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-47" value="new &lt;b&gt;DataSourceProxy&lt;/b&gt;(dataSource)&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;Seata对数据源对象的封装与增强&lt;br&gt;&lt;/font&gt;" style="whiteSpace=wrap;html=1;fontSize=9;rounded=1;strokeColor=#36393d;fillColor=#cdeb8b;" parent="1" vertex="1">
          <mxGeometry x="3140" y="1240" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-53" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=8;fontColor=#007FFF;" parent="1" source="aerit6e2gWrA8Y1na4JQ-48" target="aerit6e2gWrA8Y1na4JQ-52" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-48" value="&lt;font color=&quot;#000000&quot;&gt;this.targetDataSource = targetDataSource&lt;/font&gt;" style="whiteSpace=wrap;html=1;fontSize=9;fontColor=#007FFF;rounded=1;strokeColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="3320" y="1240" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-50" value="&lt;font color=&quot;#000000&quot;&gt;&lt;span style=&quot;font-size: 8px&quot;&gt;this.resourceGroupId = resourceGroupId&lt;/span&gt;&lt;br&gt;&lt;span style=&quot;font-size: 8px&quot;&gt;Connection connection = dataSource.getConnection()&lt;/span&gt;&lt;br&gt;&lt;div style=&quot;font-size: 8px&quot;&gt;this.jdbcUrl = connection.getMetaData().getURL();&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 8px&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; this.dbType = JdbcUtils.getDbType(jdbcUrl);&lt;/span&gt;&lt;br&gt;&lt;span style=&quot;font-size: 8px&quot;&gt;RootContext.setDefaultBranchType(this.getBranchType())&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;/font&gt;" style="whiteSpace=wrap;html=1;fontSize=9;fontColor=#007FFF;rounded=1;strokeColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="3520" y="1290" width="220" height="60" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-54" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontSize=8;fontColor=#007FFF;" parent="1" source="aerit6e2gWrA8Y1na4JQ-52" target="aerit6e2gWrA8Y1na4JQ-50" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-52" value="&lt;font color=&quot;#000000&quot;&gt;init(targetDataSource, resourceGroupId)&lt;/font&gt;" style="whiteSpace=wrap;html=1;fontSize=9;fontColor=#007FFF;rounded=1;strokeColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="3320" y="1300" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="aerit6e2gWrA8Y1na4JQ-55" value="&lt;font color=&quot;#000000&quot;&gt;DataSourceProxy#getConnection()&lt;/font&gt;&lt;br&gt;执行sql依赖Executor实例,Executor通过getConnection接口获取连接&lt;font color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;" style="whiteSpace=wrap;html=1;fontSize=9;rounded=1;strokeColor=#36393d;fillColor=#cdeb8b;" parent="1" vertex="1">
          <mxGeometry x="3320" y="1360" width="160" height="40" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="_Bk1yxw2mgEpxzISUgu0" name="Seata AT模式流程">
    <mxGraphModel dx="1434" dy="879" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="jDwYeEz7AVUPLrck1M6t-0" />
        <mxCell id="jDwYeEz7AVUPLrck1M6t-1" parent="jDwYeEz7AVUPLrck1M6t-0" />
        <mxCell id="6GLvExFoW5Inv0JvdIf_-0" value="&lt;h1&gt;Seata AT模式流程（1.4.0）&lt;/h1&gt;&lt;div&gt;&lt;font style=&quot;font-size: 10px&quot;&gt;源码（AT模式的源码）基本都是按这个流程写的，大概知道模式流程对理解源码实现有很大帮助，不然可能会看懵比，就好像不熟悉Telnet通信协议工作流程硬要看协议实现源码一样难以理解（虽然实现并不复杂）。&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 10px&quot;&gt;图还是看这个吧（别人画的图）：&amp;nbsp;&lt;a href=&quot;https://www.processon.com/view/link/6007f5c00791294a0e9b611a&quot;&gt;https://www.processon.com/view/link/6007f5c00791294a0e9b611a&lt;/a&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 10px&quot;&gt;不过没有异常回滚的流程，后续重新画一下，加上异常回滚流程；&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 10px&quot;&gt;日志里面也充分体现了这个流程。&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;p&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" parent="jDwYeEz7AVUPLrck1M6t-1" vertex="1">
          <mxGeometry x="40" y="20" width="580" height="120" as="geometry" />
        </mxCell>
        <mxCell id="6GLvExFoW5Inv0JvdIf_-4" value="OrderService" style="rounded=0;whiteSpace=wrap;html=1;fontSize=10;fontColor=#007FFF;labelPosition=center;verticalLabelPosition=top;align=center;verticalAlign=bottom;" parent="jDwYeEz7AVUPLrck1M6t-1" vertex="1">
          <mxGeometry x="40" y="160" width="100" height="200" as="geometry" />
        </mxCell>
        <mxCell id="6GLvExFoW5Inv0JvdIf_-11" value="1开启全局事务&lt;br&gt;1.1 向TC发起GlobalBeginRequest请求" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.25;exitDx=0;exitDy=0;entryX=-0.006;entryY=0.101;entryDx=0;entryDy=0;entryPerimeter=0;fontSize=10;fontColor=#007FFF;" parent="jDwYeEz7AVUPLrck1M6t-1" source="6GLvExFoW5Inv0JvdIf_-5" target="6GLvExFoW5Inv0JvdIf_-10" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6GLvExFoW5Inv0JvdIf_-5" value="TM" style="rounded=0;whiteSpace=wrap;html=1;fontSize=10;fontColor=#007FFF;labelPosition=center;verticalLabelPosition=middle;align=center;verticalAlign=middle;" parent="jDwYeEz7AVUPLrck1M6t-1" vertex="1">
          <mxGeometry x="60" y="180" width="60" height="100" as="geometry" />
        </mxCell>
        <mxCell id="6GLvExFoW5Inv0JvdIf_-16" value="2 注册分支事务&lt;br&gt;2.1 向TC发起BranchRegisterRequest请求" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.25;exitDx=0;exitDy=0;entryX=-0.006;entryY=0.339;entryDx=0;entryDy=0;entryPerimeter=0;fontSize=10;fontColor=#007FFF;" parent="jDwYeEz7AVUPLrck1M6t-1" source="6GLvExFoW5Inv0JvdIf_-6" target="6GLvExFoW5Inv0JvdIf_-10" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6GLvExFoW5Inv0JvdIf_-6" value="RM" style="rounded=0;whiteSpace=wrap;html=1;fontSize=10;fontColor=#007FFF;labelPosition=center;verticalLabelPosition=middle;align=center;verticalAlign=middle;" parent="jDwYeEz7AVUPLrck1M6t-1" vertex="1">
          <mxGeometry x="60" y="300" width="60" height="40" as="geometry" />
        </mxCell>
        <mxCell id="6GLvExFoW5Inv0JvdIf_-7" value="StorageService" style="rounded=0;whiteSpace=wrap;html=1;fontSize=10;fontColor=#007FFF;labelPosition=center;verticalLabelPosition=top;align=center;verticalAlign=bottom;" parent="jDwYeEz7AVUPLrck1M6t-1" vertex="1">
          <mxGeometry x="200" y="400" width="100" height="200" as="geometry" />
        </mxCell>
        <mxCell id="6GLvExFoW5Inv0JvdIf_-8" value="TM" style="rounded=0;whiteSpace=wrap;html=1;fontSize=10;fontColor=#007FFF;labelPosition=center;verticalLabelPosition=middle;align=center;verticalAlign=middle;" parent="jDwYeEz7AVUPLrck1M6t-1" vertex="1">
          <mxGeometry x="220" y="420" width="60" height="100" as="geometry" />
        </mxCell>
        <mxCell id="6GLvExFoW5Inv0JvdIf_-9" value="RM" style="rounded=0;whiteSpace=wrap;html=1;fontSize=10;fontColor=#007FFF;labelPosition=center;verticalLabelPosition=middle;align=center;verticalAlign=middle;" parent="jDwYeEz7AVUPLrck1M6t-1" vertex="1">
          <mxGeometry x="220" y="540" width="60" height="40" as="geometry" />
        </mxCell>
        <mxCell id="6GLvExFoW5Inv0JvdIf_-15" value="1.3 返回全局事务xid&lt;br&gt;绑定到RootContext" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.036;exitY=0.16;exitDx=0;exitDy=0;fontSize=10;fontColor=#007FFF;exitPerimeter=0;" parent="jDwYeEz7AVUPLrck1M6t-1" source="6GLvExFoW5Inv0JvdIf_-10" target="6GLvExFoW5Inv0JvdIf_-5" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="561" y="226" />
              <mxPoint x="560" y="226" />
              <mxPoint x="560" y="230" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="6GLvExFoW5Inv0JvdIf_-17" value="2.3 返回分支事务branchId" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.036;exitY=0.387;exitDx=0;exitDy=0;entryX=1;entryY=0.75;entryDx=0;entryDy=0;fontSize=10;fontColor=#007FFF;exitPerimeter=0;" parent="jDwYeEz7AVUPLrck1M6t-1" source="6GLvExFoW5Inv0JvdIf_-10" target="6GLvExFoW5Inv0JvdIf_-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6GLvExFoW5Inv0JvdIf_-10" value="Seata-Server" style="rounded=0;whiteSpace=wrap;html=1;fontSize=10;fontColor=#007FFF;labelPosition=center;verticalLabelPosition=top;align=center;verticalAlign=bottom;" parent="jDwYeEz7AVUPLrck1M6t-1" vertex="1">
          <mxGeometry x="560" y="160" width="40" height="440" as="geometry" />
        </mxCell>
        <mxCell id="6GLvExFoW5Inv0JvdIf_-13" value="1.2 生成全局事务信息GlobalSession, 存储到global_table表" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.992;entryY=0.149;entryDx=0;entryDy=0;fontSize=10;fontColor=#007FFF;entryPerimeter=0;align=left;" parent="jDwYeEz7AVUPLrck1M6t-1" target="6GLvExFoW5Inv0JvdIf_-10" edge="1">
          <mxGeometry x="-0.0596" y="10" relative="1" as="geometry">
            <mxPoint x="600" y="206" as="sourcePoint" />
            <Array as="points">
              <mxPoint x="690" y="206" />
              <mxPoint x="690" y="226" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="6GLvExFoW5Inv0JvdIf_-18" value="2.2 注册分支事务，根据GlobalSession生成BranchSession,&lt;br&gt;存储到branch_table表，获取全局锁，收集行锁存储到lock_table" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.992;entryY=0.149;entryDx=0;entryDy=0;fontSize=10;fontColor=#007FFF;entryPerimeter=0;align=left;" parent="jDwYeEz7AVUPLrck1M6t-1" edge="1">
          <mxGeometry x="-0.0016" y="10" relative="1" as="geometry">
            <mxPoint x="600.32" y="310.2" as="sourcePoint" />
            <mxPoint x="600.0000000000001" y="329.75999999999993" as="targetPoint" />
            <Array as="points">
              <mxPoint x="690" y="310" />
              <mxPoint x="690" y="330" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
