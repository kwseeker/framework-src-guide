<mxfile host="Electron" modified="2023-09-22T10:18:39.009Z" agent="Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/21.6.5 Chrome/114.0.5735.243 Electron/25.3.1 Safari/537.36" etag="neugaB-Q9s2VwNQrA1fW" version="21.6.5" type="device">
  <diagram name="第 1 页" id="SFu54w4d0Ybn-GLYL5bF">
    <mxGraphModel dx="4168" dy="1034" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="uSWqA2PRX45ugPRLn6LA-1" value="&lt;p style=&quot;line-height: 1; font-size: 10px;&quot;&gt;&lt;/p&gt;&lt;h1 style=&quot;font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;Reactor-Netty 工作原理&lt;/font&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;&amp;nbsp;&lt;/font&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;(v0.9.1)&amp;nbsp;&lt;br style=&quot;&quot;&gt;&lt;/font&gt;&lt;/font&gt;&lt;/h1&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;结合ProjectReactor将Netty封装成了响应式的通信框架。v0.9.1 基于 Netty-4.1.43。&lt;/font&gt;&lt;/div&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;前提：&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;font-size: 10px;&quot;&gt;&lt;/p&gt;&lt;ul style=&quot;font-size: 10px;&quot;&gt;&lt;li style=&quot;font-size: 10px;&quot;&gt;熟悉 reactor-core、netty 实现原理和使用 （参考对应流程图）&lt;/li&gt;&lt;/ul&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;#说明：&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;ul style=&quot;font-size: 10px;&quot;&gt;&lt;li style=&quot;font-size: 10px;&quot;&gt;这里研究Reactor-Netty是怎么封装Netty和HTTP协议的， 以官方单元测试 HttpServerTests#releaseInboundChannelOnNonKeepAliveRequest() 为例&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;p style=&quot;font-size: 10px;&quot;&gt;&lt;/p&gt;&lt;p style=&quot;font-size: 10px;&quot;&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="10" y="10" width="810" height="150" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-4" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-2" target="uSWqA2PRX45ugPRLn6LA-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-16" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-2" target="uSWqA2PRX45ugPRLn6LA-15" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-2" value="HttpServer 初始化&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;返回经多多层装饰后的HttpServer对象&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10;gradientColor=#97d077;" parent="1" vertex="1">
          <mxGeometry x="40" y="200" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-6" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-3" target="uSWqA2PRX45ugPRLn6LA-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-44" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-3" target="uSWqA2PRX45ugPRLn6LA-43" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-3" value=".create()&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;主要是创建TcpServer并设置基本选项&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="240" y="200" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-8" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-5" target="uSWqA2PRX45ugPRLn6LA-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-65" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-5" target="uSWqA2PRX45ugPRLn6LA-64" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-5" value=".port(8080)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="240" y="360" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-10" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-7" target="uSWqA2PRX45ugPRLn6LA-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-71" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-7" target="uSWqA2PRX45ugPRLn6LA-70" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-7" value=".handle((req, resp) -&amp;gt; req.receive()&lt;br&gt;.then(resp.status(200).send()))&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;装配请求处理器方法（请求处理入口）&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="240" y="440" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-75" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-9" target="uSWqA2PRX45ugPRLn6LA-74" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-9" value=".wiretap(true)&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;开启wire logger&lt;br&gt;由后面的实现可以看到是注册了一个ChannelHandler实现日志记录的&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="240" y="520" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-81" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-11" target="uSWqA2PRX45ugPRLn6LA-80" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-11" value=".bindNow()&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;返回 DisposableServer 对象&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="240" y="722" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-31" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-13" target="bm2imlQ028U47hNO7TBu-30" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-13" value="Mono.when(&lt;br&gt;disposableServer.onDispose())&lt;br&gt;.block();" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="240" y="881" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-18" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-15" target="uSWqA2PRX45ugPRLn6LA-17" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-19" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=10;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-15" target="uSWqA2PRX45ugPRLn6LA-11" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-15" value="HttpServer 启动,&lt;br&gt;绑定端口并等待绑定完成" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10;gradientColor=#97d077;" parent="1" vertex="1">
          <mxGeometry x="40" y="722" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-20" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=10;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-17" target="uSWqA2PRX45ugPRLn6LA-13" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-23" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-17" target="bm2imlQ028U47hNO7TBu-22" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-17" value="HttpServer 阻塞等待服务关闭" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10;gradientColor=#97d077;" parent="1" vertex="1">
          <mxGeometry x="40" y="881" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-21" value="&lt;div style=&quot;text-align: center; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;reactor.netty.http.server&lt;font style=&quot;background-color: initial; font-size: 10px;&quot;&gt;.&lt;/font&gt;&lt;/font&gt;&lt;b style=&quot;color: rgb(0, 0, 0); background-color: initial; font-size: 10px;&quot;&gt;HttpServer&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;reator-netty HTTP服务器抽象实现类&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;//核心基于 TcpServer, 这里是默认实现&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;static final TcpServer &lt;b style=&quot;font-size: 10px;&quot;&gt;DEFAULT_TCP_SERVER&lt;/b&gt; = TcpServer.create();&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;//下面是 TcpServer 属性配置的函数式方法&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&lt;span style=&quot;color: rgb(0, 0, 0); background-color: initial; font-size: 10px;&quot;&gt;static final Function&amp;lt;TcpServer, TcpServer&amp;gt; &lt;/span&gt;&lt;b style=&quot;color: rgb(0, 0, 0); background-color: initial; font-size: 10px;&quot;&gt;COMPRESS_ATTR_CONFIG&lt;/b&gt;&lt;span style=&quot;color: rgb(0, 0, 0); background-color: initial; font-size: 10px;&quot;&gt; = (tcp) -&amp;gt; {&lt;/span&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;&amp;nbsp; &amp;nbsp; return tcp.bootstrap(HttpServerConfiguration.MAP_COMPRESS);&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;};&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;static final Function&amp;lt;TcpServer, TcpServer&amp;gt; &lt;b style=&quot;font-size: 10px;&quot;&gt;COMPRESS_ATTR_DISABLE&lt;/b&gt; = (tcp) -&amp;gt; {&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;&amp;nbsp; &amp;nbsp; return tcp.bootstrap(HttpServerConfiguration.MAP_NO_COMPRESS);&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;};&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;static final Function&amp;lt;TcpServer, TcpServer&amp;gt; &lt;b style=&quot;font-size: 10px;&quot;&gt;FORWARD_ATTR_CONFIG&lt;/b&gt; = (tcp) -&amp;gt; {&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;&amp;nbsp; &amp;nbsp; return tcp.bootstrap(HttpServerConfiguration.MAP_FORWARDED);&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;};&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;static final Function&amp;lt;TcpServer, TcpServer&amp;gt; &lt;b style=&quot;font-size: 10px;&quot;&gt;FORWARD_ATTR_DISABLE&lt;/b&gt; = (tcp) -&amp;gt; {&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;&amp;nbsp; &amp;nbsp; return tcp.bootstrap(HttpServerConfiguration.MAP_NO_FORWARDED);&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;};&lt;/font&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="-960" y="200" width="480" height="260" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-22" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;endArrow=block;endFill=1;fontSize=10;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-23" target="uSWqA2PRX45ugPRLn6LA-21" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-23" value="&lt;div style=&quot;text-align: center; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;reactor.netty.http.server&lt;font style=&quot;background-color: initial; font-size: 10px;&quot;&gt;.&lt;/font&gt;&lt;b style=&quot;background-color: initial; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;HttpServerBind&lt;/font&gt;&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;HttpServer的具体实现，单例模式对象 TcpServerBind.INSTANCE&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;static final HttpServerBind &lt;b style=&quot;font-size: 10px;&quot;&gt;INSTANCE&lt;/b&gt; = new HttpServerBind();&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;static final Function&amp;lt;DisposableServer, DisposableServer&amp;gt; &lt;b style=&quot;font-size: 10px;&quot;&gt;CLEANUP_GLOBAL_RESOURCE&lt;/b&gt; =&amp;nbsp;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;&lt;span style=&quot;white-space: pre; font-size: 10px;&quot;&gt;&#x9;&lt;/span&gt;DisposableBind::new;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;//实际使用的TcpServer对象，如果构造方法没有传参就默认使用 DEFAULT_TCP_SERVER&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;final TcpServer &lt;b style=&quot;font-size: 10px;&quot;&gt;tcpServer&lt;/b&gt;;&lt;/font&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="-960" y="494" width="480" height="126" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-24" style="orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;endArrow=diamondThin;endFill=1;fontSize=10;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-25" target="uSWqA2PRX45ugPRLn6LA-23" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-25" value="&lt;div style=&quot;text-align: center; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;reactor.netty.tcp.&lt;/font&gt;&lt;span style=&quot;color: rgb(0, 0, 0); background-color: initial; font-size: 10px;&quot;&gt;&lt;b style=&quot;font-size: 10px;&quot;&gt;TcpServer&lt;/b&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;reactor-netty Tcp服务器抽象实现类&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font color=&quot;#000000&quot; style=&quot;font-size: 10px;&quot;&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font color=&quot;#000000&quot; style=&quot;font-size: 10px;&quot;&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font color=&quot;#000000&quot; style=&quot;font-size: 10px;&quot;&gt;static final int &lt;b style=&quot;font-size: 10px;&quot;&gt;DEFAULT_PORT&lt;/b&gt; = 0;&lt;/font&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#000000&quot; style=&quot;&quot;&gt;static final LoggingHandler &lt;b&gt;LOGGING_HANDLER&lt;/b&gt; =&amp;nbsp;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#000000&quot; style=&quot;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;new LoggingHandler(TcpServer.class);&lt;br&gt;&lt;/font&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="-1400" y="200" width="400" height="120" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-26" style="orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;endArrow=block;endFill=1;fontSize=10;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-27" target="uSWqA2PRX45ugPRLn6LA-25" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-27" value="&lt;div style=&quot;text-align: center; font-size: 10px;&quot;&gt;&lt;font color=&quot;#000000&quot; style=&quot;font-size: 10px;&quot;&gt;reactor.netty.tcp.&lt;b style=&quot;font-size: 10px;&quot;&gt;Tcp&lt;/b&gt;&lt;/font&gt;&lt;b style=&quot;font-size: 10px; color: rgb(0, 0, 0); background-color: initial;&quot;&gt;ServerBind&lt;/b&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;TcpServer的具体实现，单例模式对象TcpServerBind.INSTANCE&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;同时实现了 Function&amp;lt;ServerBootStrap, ServerBootstrap&amp;gt; 接口，用于定义初始化&lt;br style=&quot;font-size: 10px;&quot;&gt;方法&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font color=&quot;#000000&quot; style=&quot;font-size: 10px;&quot;&gt;static final TcpServerBind &lt;b style=&quot;font-size: 10px;&quot;&gt;INSTANCE&lt;/b&gt; = new TcpServerBind();&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;//Netty的服务端实例&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font color=&quot;#000000&quot; style=&quot;font-size: 10px;&quot;&gt;&lt;span style=&quot;font-size: 10px;&quot;&gt;final &lt;b style=&quot;font-size: 10px;&quot;&gt;ServerBootstrap&lt;/b&gt; &lt;b style=&quot;font-size: 10px;&quot;&gt;serverBootstrap&lt;/b&gt; = this.createServerBootstrap();&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="-1400" y="494" width="400" height="126" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-28" style="orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;strokeColor=none;endArrow=block;endFill=1;fontSize=10;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-30" target="uSWqA2PRX45ugPRLn6LA-25" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-29" style="orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;endArrow=block;endFill=1;fontSize=10;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-30" target="uSWqA2PRX45ugPRLn6LA-25" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-30" value="&lt;div style=&quot;text-align: center; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;reactor.netty.tcp.&lt;/font&gt;&lt;/font&gt;&lt;span style=&quot;color: rgb(0, 0, 0); background-color: initial; font-size: 10px;&quot;&gt;&lt;b style=&quot;font-size: 10px;&quot;&gt;TcpServerOperator&lt;/b&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;用于通过装饰器模式拓展功能&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;//被装饰的TcpServer实例&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font color=&quot;#000000&quot; style=&quot;font-size: 10px;&quot;&gt;final TcpServer source;&lt;/font&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="-1780" y="494" width="320" height="105" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-31" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;endArrow=block;endFill=1;fontSize=10;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-32" target="uSWqA2PRX45ugPRLn6LA-30" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-32" value="&lt;div style=&quot;text-align: center; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;reactor.netty.tcp.&lt;/font&gt;&lt;/font&gt;&lt;/font&gt;&lt;span style=&quot;background-color: initial; font-size: 10px;&quot;&gt;&lt;b style=&quot;color: rgb(0, 0, 0); font-size: 10px;&quot;&gt;TcpServerBootstrap &lt;/b&gt;（这里是&lt;b style=&quot;font-size: 10px;&quot;&gt;装饰器模式&lt;/b&gt;）&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;//用于装配TCP服务器配置的函数式方法，每装饰一层注册一个方法&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;final Function&amp;lt;? super ServerBootstrap, ? extends ServerBootstrap&amp;gt; &lt;b&gt;bootstrapMapper&lt;/b&gt;;&lt;/font&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="-1840" y="641" width="440" height="79" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-33" style="orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;endArrow=block;endFill=1;fontSize=10;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-34" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-720.0000000000005" y="460" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-34" value="&lt;div style=&quot;text-align: center; font-size: 10px;&quot;&gt;&lt;font color=&quot;#000000&quot; style=&quot;font-size: 10px;&quot;&gt;reactor.netty.http.server.&lt;/font&gt;&lt;span style=&quot;color: rgb(0, 0, 0); background-color: initial; font-size: 10px;&quot;&gt;&lt;b style=&quot;font-size: 10px;&quot;&gt;HttpServerOperator&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;border-color: var(--border-color); margin: 0px 0px 0px 4px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;通过&lt;/span&gt;&lt;b style=&quot;background-color: initial;&quot;&gt;装饰器模式&lt;/b&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;装配上 &lt;/span&gt;&lt;b style=&quot;background-color: initial;&quot;&gt;TCP配置&lt;/b&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;、&lt;/span&gt;&lt;b style=&quot;background-color: initial;&quot;&gt;请求处理器&lt;/b&gt;&lt;span style=&quot;background-color: initial;&quot;&gt; 等组件&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font color=&quot;#000000&quot; style=&quot;font-size: 10px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font color=&quot;#000000&quot; style=&quot;font-size: 10px;&quot;&gt;final HttpServer&amp;nbsp;source; &lt;/font&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;//被装饰的HttpServer实例&lt;/font&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="-440" y="494" width="360" height="105" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-35" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;endArrow=block;endFill=1;fontSize=10;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-36" target="uSWqA2PRX45ugPRLn6LA-34" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-36" value="&lt;div style=&quot;text-align: center; font-size: 10px;&quot;&gt;&lt;font color=&quot;#000000&quot; style=&quot;font-size: 10px;&quot;&gt;reactor.netty.http.server&lt;/font&gt;&lt;font style=&quot;background-color: initial; font-size: 10px;&quot;&gt;&lt;font color=&quot;#000000&quot; style=&quot;font-size: 10px;&quot;&gt;.&lt;/font&gt;&lt;/font&gt;&lt;span style=&quot;background-color: initial; font-size: 10px;&quot;&gt;&lt;font color=&quot;#000000&quot; style=&quot;font-size: 10px;&quot;&gt;&lt;b style=&quot;font-size: 10px;&quot;&gt;HttpServerTcpConfig&lt;/b&gt;&lt;/font&gt;&lt;b style=&quot;color: rgb(0, 0, 0); font-size: 10px;&quot;&gt;&amp;nbsp;&lt;/b&gt;&lt;span style=&quot;font-size: 10px;&quot;&gt;（&lt;/span&gt;&lt;b style=&quot;font-size: 10px;&quot;&gt;装饰器模式&lt;/b&gt;&lt;span style=&quot;font-size: 10px;&quot;&gt;）&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;用于装配TCP配置信息(比如：端口、wire logger)&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;//设置端口、wire logger等配置的函数方法&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;f&lt;/font&gt;&lt;span style=&quot;color: rgb(0, 0, 0); background-color: initial;&quot;&gt;inal Function&amp;lt;? super ServerBootstrap, ? extends ServerBootstrap&amp;gt; &lt;b&gt;bootstrapMapper&lt;/b&gt;;&lt;/span&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="-480" y="660" width="440" height="100" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-39" style="orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;endArrow=block;endFill=1;fontSize=10;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-40" target="uSWqA2PRX45ugPRLn6LA-34" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-40" value="&lt;div style=&quot;text-align: center; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;reactor.netty.http.server&lt;/font&gt;&lt;font style=&quot;background-color: initial; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;.&lt;/font&gt;&lt;/font&gt;&lt;span style=&quot;background-color: initial; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;&lt;b style=&quot;font-size: 10px;&quot;&gt;HttpServerHandle&lt;/b&gt;&lt;/font&gt;&lt;b style=&quot;color: rgb(0, 0, 0); font-size: 10px;&quot;&gt;&amp;nbsp;&lt;/b&gt;（&lt;b style=&quot;font-size: 10px;&quot;&gt;装饰器模式&lt;/b&gt;）&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;用于装配处理器逻辑&lt;br&gt;&lt;br&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;/p&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;//处理请求的函数方法，它作为业务处理入口&lt;/font&gt;&lt;span style=&quot;font-size: 10px; color: rgb(0, 0, 0); background-color: initial;&quot;&gt;&lt;br&gt;final BiFunction&amp;lt;? super HttpServerRequest, ? super&lt;/span&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/font&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;HttpServerResponse, ? extends Publisher&amp;lt;Void&amp;gt;&amp;gt; &lt;b style=&quot;font-size: 10px;&quot;&gt;handler&lt;/b&gt;;&lt;/font&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="-960" y="661" width="440" height="99" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-41" value="&lt;div style=&quot;text-align: center; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;reactor.netty.resources&lt;/font&gt;&lt;font style=&quot;background-color: initial; font-size: 10px;&quot; color=&quot;#000000&quot;&gt;.&lt;/font&gt;&lt;b style=&quot;color: rgb(0, 0, 0); background-color: initial; font-size: 10px;&quot;&gt;DefaultLoopResources&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp;用于客户端和服务端创建并缓存EventLoopGroup(一组线程)的，&lt;br style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp;可以当作EventLoopGroup的工厂+管理器&lt;/font&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;//线程名前缀&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;final String&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b style=&quot;font-size: 10px;&quot;&gt;prefix&lt;/b&gt;;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;//是否是守护线程&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;final boolean&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;b style=&quot;font-size: 10px;&quot;&gt;daemon&lt;/b&gt;;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;//selector线程（即boss线程，分发请求）数量&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;final int&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;b style=&quot;font-size: 10px;&quot;&gt;selectCount&lt;/b&gt;;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;//工作线程（处理请求）数量&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;final int&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;b style=&quot;font-size: 10px;&quot;&gt;workerCount&lt;/b&gt;;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;//这三组功能同后面的三组EventLoopGroup,只是基于 &lt;b style=&quot;font-size: 10px;&quot;&gt;NioEventLoopGroup&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&lt;b style=&quot;font-size: 10px;&quot;&gt;//后面三组基于 projectreactor DefaultLoopEpoll，&lt;/b&gt;不过记得本质都是一样的，底层都是epoll,&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;只是封装不同, 默认用 useNative = true, 即用DefaultLoopEpoll&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;final AtomicReference&amp;lt;EventLoopGroup&amp;gt; &lt;b style=&quot;font-size: 10px;&quot;&gt;serverLoops&lt;/b&gt;;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;final AtomicReference&amp;lt;EventLoopGroup&amp;gt; &lt;b style=&quot;font-size: 10px;&quot;&gt;clientLoops&lt;/b&gt;;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;final AtomicReference&amp;lt;EventLoopGroup&amp;gt; &lt;b style=&quot;font-size: 10px;&quot;&gt;serverSelectLoops&lt;/b&gt;;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;//客户端线程组（并不等同于连接线程）&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;final AtomicReference&amp;lt;EventLoopGroup&amp;gt; &lt;b style=&quot;font-size: 10px;&quot;&gt;cacheNativeClientLoops&lt;/b&gt;;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;//服务端worker线程组，默认情况下和boss线程组是同一组线程，&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;//调试可以发现和下面的cacheNativeSelectLoops中的线程组是同一个对象&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;final AtomicReference&amp;lt;EventLoopGroup&amp;gt; &lt;b style=&quot;font-size: 10px;&quot;&gt;cacheNativeServerLoops&lt;/b&gt;;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;//服务端Selector(boss)线程组&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;final AtomicReference&amp;lt;EventLoopGroup&amp;gt; &lt;b style=&quot;font-size: 10px;&quot;&gt;cacheNativeSelectLoops&lt;/b&gt;;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;final AtomicBoolean&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;running;&lt;/font&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="-480" y="801" width="440" height="360" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-42" value="&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;Reactor-Netty提供了HTTP TCP UDP &lt;br&gt;三种CS实现，这里主要分析HTTP， &lt;br&gt;不过HTTP服务器是基于TCP服务器实现的&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="40" y="260" width="210" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-46" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-43" target="uSWqA2PRX45ugPRLn6LA-45" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-48" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-43" target="uSWqA2PRX45ugPRLn6LA-47" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-97" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.75;exitDx=0;exitDy=0;entryX=0;entryY=0.25;entryDx=0;entryDy=0;fillColor=#dae8fc;strokeColor=#6c8ebf;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-47" target="uSWqA2PRX45ugPRLn6LA-93" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="900" y="245" />
              <mxPoint x="900" y="737" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-43" value="HttpServerBind INSTANCE = new &lt;b&gt;HttpServerBind&lt;/b&gt;();" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="440" y="200" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-45" value="return HttpServerBind.INSTANCE;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="440" y="280" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-51" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-47" target="uSWqA2PRX45ugPRLn6LA-50" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-53" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-47" target="uSWqA2PRX45ugPRLn6LA-52" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-47" value="TcpServer.create();" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="680" y="200" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-49" value="HttpServerBind" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="490" y="170" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-50" value="return TcpServerBind.INSTANCE;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="680" y="280" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-56" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-52" target="uSWqA2PRX45ugPRLn6LA-55" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-52" value="TcpServerBind INSTANCE = new TcpServerBind();" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="920" y="200" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-54" value="TcpServerBind" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="970" y="170" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-58" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-55" target="uSWqA2PRX45ugPRLn6LA-57" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-60" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-55" target="uSWqA2PRX45ugPRLn6LA-59" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-55" value="this.serverBootstrap = createServerBootstrap();" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1160" y="200" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-62" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-57" target="uSWqA2PRX45ugPRLn6LA-61" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-57" value="BootstrapHandlers.channelOperationFactory(&lt;br&gt;this.&lt;b&gt;serverBootstrap&lt;/b&gt;, TcpUtils.&lt;b&gt;TCP_OPS&lt;/b&gt;);" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1160" y="280" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-59" value="&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;return new ServerBootstrap()&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;.option(ChannelOption.SO_REUSEADDR, true)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;.childOption(ChannelOption.AUTO_READ, false)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;.childOption(ChannelOption.TCP_NODELAY, true)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;.localAddress(newInetSocketAddress(DEFAULT_PORT));&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;arcSize=12;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1400" y="200" width="240" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-61" value="b.&lt;b&gt;option&lt;/b&gt;(OPS_OPTION, opsFactory);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;OPS_OPTION是拓展的选项，并不是Netty本身定义的&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1400" y="280" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-63" value="&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;这里的选项对应套接字选项，参考UNIX网络编程C7.5&lt;br&gt;SO_REUSEADDR：主要是为了支持已存在连接的情况下重启服务器，其他3种功能参考Markdown文档&lt;br&gt;TCP_NODELAY: 开启会禁止TCP的Nagle算法，确保响应不会因为存在待确认数据（就是响应还没发回就收到新的数据）而出现延迟&lt;br&gt;&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="1650" y="200" width="610" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-67" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-64" target="uSWqA2PRX45ugPRLn6LA-66" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-64" value="return tcpConfiguration(tcpServer -&amp;gt; tcpServer.port(port));" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="440" y="360" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-69" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-66" target="uSWqA2PRX45ugPRLn6LA-68" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-66" value="return new &lt;b&gt;HttpServerTcpConfig&lt;/b&gt;(this, tcpMapper);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;HttpServerTcpConfig是装配配置方法后的&lt;br&gt;HttpServer&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="680" y="360" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-107" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-68" target="uSWqA2PRX45ugPRLn6LA-106" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-68" value="tcpServer.port(port)&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;绑定阶段被调用&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="920" y="360" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-73" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-70" target="uSWqA2PRX45ugPRLn6LA-72" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-70" value="return new &lt;b&gt;HttpServerHandle&lt;/b&gt;(this, handler);&lt;br&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;HttpServerHandle&lt;span style=&quot;background-color: initial; font-weight: normal;&quot;&gt;是装配请求处理方法后的&lt;/span&gt;&lt;br&gt;&lt;/font&gt;&lt;/b&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;HttpServer&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="440" y="440" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-72" value="(req, resp) -&amp;gt; resp.sendNotFound()&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;处理请求阶段被调用&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="680" y="440" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-77" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-74" target="uSWqA2PRX45ugPRLn6LA-76" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-74" value="&lt;div&gt;return tcpConfiguration(tcpServer -&amp;gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; tcpServer.bootstrap(b -&amp;gt; BootstrapHandlers.updateLogSupport(b, LOGGING_HANDLER)));&lt;span style=&quot;&quot;&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="440" y="520" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-79" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-76" target="uSWqA2PRX45ugPRLn6LA-78" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-76" value="return new HttpServerTcpConfig(this, tcpMapper);&lt;br&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;HttpServerTcpConfig是装配配置方法后的&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;HttpServer，这一步装配了wire logger 函数方法&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="680" y="520" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-109" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-78" target="uSWqA2PRX45ugPRLn6LA-108" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-78" value="&lt;div&gt;tcpServer -&amp;gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; tcpServer.bootstrap(b -&amp;gt; BootstrapHandlers.updateLogSupport(b, LOGGING_HANDLER))&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="920" y="520" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-83" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-80" target="uSWqA2PRX45ugPRLn6LA-82" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-80" value="bindNow(Duration.ofSeconds(45));&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;默认绑定超时时间45s&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="440" y="722" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-85" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-82" target="uSWqA2PRX45ugPRLn6LA-84" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-94" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-82" target="uSWqA2PRX45ugPRLn6LA-93" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-82" value="bind()&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;返回Mono&amp;lt;DisposableServer&amp;gt;对象&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="680" y="722" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-84" value=".block(timeout)&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;阻塞等待Mono接收到下一个信号（元素）（&lt;/font&gt;&lt;font color=&quot;#007fff&quot;&gt;TcpServerBind#&lt;b&gt;operationComplete&lt;/b&gt;()会发送信号&lt;/font&gt;&lt;font color=&quot;#007fff&quot;&gt;）&lt;/font&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;即&lt;/font&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#007fff&quot;&gt;等待HttpServer bind 成功或失败&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="680" y="801" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-91" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-88" target="uSWqA2PRX45ugPRLn6LA-90" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-88" value="return source.bind(b)&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;层层深入最终调用HttpServerBind的bind&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1160" y="801" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-112" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-90" target="uSWqA2PRX45ugPRLn6LA-111" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-116" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-90" target="uSWqA2PRX45ugPRLn6LA-115" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-90" value="bootstrap(this)&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;装配HttpServerBind#apply()&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="1400" y="801" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-92" value="&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;HttpServer装配后的实际对象：&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;this = {&lt;b&gt;HttpServerTcpConfig&lt;/b&gt;@2224}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp;tcpServerMapper = {HttpServer$lambda@2225}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp;source = {&lt;b&gt;HttpServerHandle&lt;/b&gt;@2226}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; handler = {HttpServerTests$lambda@2218}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; source = {&lt;b&gt;HttpServerTcpConfig&lt;/b&gt;@2217}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp;tcpServerMapper = {HttpServer$lambda@2219}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp;source = {&lt;b&gt;HttpServerBind&lt;/b&gt;@2220}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; tcpServer = {TcpServerBind@2180}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;serverBootstrap = {ServerBootstrap@2182}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;labelBorderColor=none;labelBackgroundColor=#E6E6E6;" parent="1" vertex="1">
          <mxGeometry x="910" y="796" width="250" height="130" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-100" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-93" target="uSWqA2PRX45ugPRLn6LA-99" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-93" value="return bind(tcpConfiguration());" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="920" y="722" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-101" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-99" target="uSWqA2PRX45ugPRLn6LA-78" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1370" y="752" />
              <mxPoint x="1370" y="710" />
              <mxPoint x="910" y="710" />
              <mxPoint x="910" y="565" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-103" value="1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="uSWqA2PRX45ugPRLn6LA-101" vertex="1" connectable="0">
          <mxGeometry x="-0.8832" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-102" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-99" target="uSWqA2PRX45ugPRLn6LA-68" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1390" y="752" />
              <mxPoint x="1390" y="510" />
              <mxPoint x="910" y="510" />
              <mxPoint x="910" y="405" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-104" value="3" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="uSWqA2PRX45ugPRLn6LA-102" vertex="1" connectable="0">
          <mxGeometry x="-0.8751" y="-3" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-105" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-99" target="uSWqA2PRX45ugPRLn6LA-88" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-214" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-99" target="uSWqA2PRX45ugPRLn6LA-72" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1380" y="752" />
              <mxPoint x="1380" y="600" />
              <mxPoint x="660" y="600" />
              <mxPoint x="660" y="485" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-215" value="2" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="uSWqA2PRX45ugPRLn6LA-214" vertex="1" connectable="0">
          <mxGeometry x="-0.8734" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-37" style="rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=1;exitDx=0;exitDy=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" source="uSWqA2PRX45ugPRLn6LA-99" target="uSWqA2PRX45ugPRLn6LA-92" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-99" value="tcpServerMapper.apply(&lt;br&gt;source.tcpConfiguration())&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;层层深入调用tcpServerMapper函数式方法&lt;br&gt;对TcpServer进行装配&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="1160" y="722" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-128" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-106" target="uSWqA2PRX45ugPRLn6LA-127" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-106" value="b -&amp;gt; TcpUtils.updatePort(b, port)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="1160" y="360" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-149" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-108" target="uSWqA2PRX45ugPRLn6LA-148" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-108" value="b -&amp;gt; BootstrapHandlers.updateLogSupport(b, &lt;b&gt;LOGGING_HANDLER&lt;/b&gt;)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="1160" y="520" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-110" value="&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;TcpServer装配后的实际对象：&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;b = {TcpServerBootstrap@2244}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp;bootstrapMapper = {HttpServer$lambda@2245}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp;source = {TcpServerBootstrap@2242}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; bootstrapMapper = {HttpServerHandle@2234}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; source = {TcpServerBootstrap@2232}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp;bootstrapMapper = {TcpServer$lambda@2233}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp;source = {TcpServerBind@2180}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; serverBootstrap = {ServerBootstrap@2181}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;labelBackgroundColor=#E6E6E6;" parent="1" vertex="1">
          <mxGeometry x="1160" y="890" width="240" height="120" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-114" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-111" target="uSWqA2PRX45ugPRLn6LA-113" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-118" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-111" target="uSWqA2PRX45ugPRLn6LA-117" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-111" value="bind()" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1400" y="881" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-57" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-113" target="bm2imlQ028U47hNO7TBu-56" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-113" value="map(CLEANUP_GLOBAL_RESOURCE)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1400" y="1140" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-144" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-115" target="uSWqA2PRX45ugPRLn6LA-143" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2140" y="831" />
              <mxPoint x="2140" y="470" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-115" value="ServerBootstrap apply(ServerBootstrap b)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="1640" y="801" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-121" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-117" target="uSWqA2PRX45ugPRLn6LA-120" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-123" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-117" target="uSWqA2PRX45ugPRLn6LA-122" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-117" value="b = configure();" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1640" y="881" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-119" value="TcpServer" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="1700" y="860" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-176" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-120" target="uSWqA2PRX45ugPRLn6LA-175" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-120" value="return bind(b);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;此时b是经过层层装饰后的TcpServer对象&lt;br&gt;此方法会层层深入执行 TcpServerBind#bind&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="1640" y="1040" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-124" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-122" target="uSWqA2PRX45ugPRLn6LA-106" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2100" y="911" />
              <mxPoint x="2100" y="430" />
              <mxPoint x="1140" y="430" />
              <mxPoint x="1140" y="405" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-158" value="1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="uSWqA2PRX45ugPRLn6LA-124" vertex="1" connectable="0">
          <mxGeometry x="-0.5046" y="-3" relative="1" as="geometry">
            <mxPoint x="-3" y="22" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-125" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-122" target="uSWqA2PRX45ugPRLn6LA-108" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2100" y="911" />
              <mxPoint x="2100" y="590" />
              <mxPoint x="1140" y="590" />
              <mxPoint x="1140" y="565" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-137" value="3" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="uSWqA2PRX45ugPRLn6LA-125" vertex="1" connectable="0">
          <mxGeometry x="-0.5921" y="-1" relative="1" as="geometry">
            <mxPoint x="-21" y="-76" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-126" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-122" target="uSWqA2PRX45ugPRLn6LA-115" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2100" y="911" />
              <mxPoint x="2100" y="871" />
              <mxPoint x="1620" y="871" />
              <mxPoint x="1620" y="846" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-138" value="4" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="uSWqA2PRX45ugPRLn6LA-126" vertex="1" connectable="0">
          <mxGeometry x="-0.7185" y="3" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-132" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-122" target="uSWqA2PRX45ugPRLn6LA-129" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-134" value="2" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="uSWqA2PRX45ugPRLn6LA-132" vertex="1" connectable="0">
          <mxGeometry x="0.2167" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-38" style="rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=0.608;entryDx=0;entryDy=0;entryPerimeter=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" source="uSWqA2PRX45ugPRLn6LA-122" target="uSWqA2PRX45ugPRLn6LA-110" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-122" value="bootstrapMapper.apply(source.configure()&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;一层层地执行 bootstrapMapper, 先克隆TcpServer, 然后配置端口、ConnectionObserver、日志ChannelHandler、线程组、HTTP协议相关&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="1880" y="881" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-127" value="b.&lt;b&gt;localAddress&lt;/b&gt;(_updatePort(&lt;br&gt;b.config().localAddress(), port))" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1400" y="360" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-131" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-129" target="uSWqA2PRX45ugPRLn6LA-130" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-129" value="HttpServerHandle#apply()" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2120" y="881" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-136" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-130" target="uSWqA2PRX45ugPRLn6LA-135" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-140" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-130" target="uSWqA2PRX45ugPRLn6LA-139" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-130" value="ConnectionObserver observer = BootstrapHandlers&lt;br&gt;.&lt;b&gt;childConnectionObserver&lt;/b&gt;(b);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;ConnectionObserver 是TCP连接生命周期的监听器&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2360" y="881" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-142" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-135" target="uSWqA2PRX45ugPRLn6LA-141" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-135" value="BootstrapHandlers.childConnectionObserver(&lt;br&gt;b, observer.then(this));&lt;br&gt;return b;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2360" y="961" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-201" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.75;exitDx=0;exitDy=0;entryX=1;entryY=0.25;entryDx=0;entryDy=0;fillColor=#d5e8d4;strokeColor=#82b366;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-139" target="uSWqA2PRX45ugPRLn6LA-182" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2580" y="931" />
              <mxPoint x="2580" y="1190" />
              <mxPoint x="2350" y="1190" />
              <mxPoint x="2350" y="1215" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-139" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;div&gt;ConnectionObserver obs = (ConnectionObserver) b.config()&lt;/div&gt;&lt;div&gt;&amp;nbsp; .childOptions()&lt;/div&gt;&lt;div&gt;&amp;nbsp; .get(&lt;b&gt;OBSERVER_OPTION&lt;/b&gt;);&lt;/div&gt;&lt;div&gt;if (obs == null) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; return ConnectionObserver.&lt;b&gt;emptyListener&lt;/b&gt;();&amp;nbsp;&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;b.&lt;b&gt;childOption&lt;/b&gt;(&lt;b&gt;OBSERVER_OPTION&lt;/b&gt;, null);&lt;/div&gt;&lt;div&gt;return obs;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#d5e8d4;strokeColor=#82b366;align=left;arcSize=8;" parent="1" vertex="1">
          <mxGeometry x="2600" y="871" width="220" height="80" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-202" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.75;exitDx=0;exitDy=0;entryX=1;entryY=0.25;entryDx=0;entryDy=0;fillColor=#d5e8d4;strokeColor=#82b366;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-141" target="uSWqA2PRX45ugPRLn6LA-182" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2580" y="1006" />
              <mxPoint x="2580" y="1190" />
              <mxPoint x="2350" y="1190" />
              <mxPoint x="2350" y="1215" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-141" value="b.&lt;b&gt;childOption&lt;/b&gt;(&lt;b&gt;OBSERVER_OPTION&lt;/b&gt;, connectionObserver);" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="2600" y="961" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-162" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-143" target="uSWqA2PRX45ugPRLn6LA-161" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-143" value="HttpServerConfiguration conf = HttpServerConfiguration.getAndClean(b);" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2160" y="440" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-151" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-148" target="uSWqA2PRX45ugPRLn6LA-150" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-148" value="c =&amp;nbsp;new &lt;b&gt;LoggingHandlerSupportConsumer&lt;/b&gt;(&lt;br&gt;handler, debugSsl);&lt;br&gt;b.&lt;b&gt;childHandler&lt;/b&gt;(updateConfiguration(&lt;br&gt;b.config().childHandler(), name, c));" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1400" y="520" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-156" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-150" target="uSWqA2PRX45ugPRLn6LA-155" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-216" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.75;exitDx=0;exitDy=0;entryX=0;entryY=0.25;entryDx=0;entryDy=0;fillColor=#d5e8d4;strokeColor=#82b366;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-217" target="uSWqA2PRX45ugPRLn6LA-209" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2110" y="565" />
              <mxPoint x="2110" y="1430" />
              <mxPoint x="2340" y="1430" />
              <mxPoint x="2340" y="1455" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-218" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-150" target="uSWqA2PRX45ugPRLn6LA-217" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-150" value="&lt;b&gt;BootstrapPipelineHandler&lt;/b&gt; p = getOrCreateInitializer(handler);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;初始为空，这里会创建&amp;nbsp;BootstrapPipelineHandler&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1640" y="520" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-155" value="p.&lt;b&gt;add&lt;/b&gt;(new PipelineConfiguration(c, name));&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;注册Pipeline Handler&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1640" y="601" width="200" height="59" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-160" value="BootstrapHandlers" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="1440" y="490" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-164" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-161" target="uSWqA2PRX45ugPRLn6LA-163" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-161" value="conf.SSL配置" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="2160" y="520" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-166" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-163" target="uSWqA2PRX45ugPRLn6LA-165" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-170" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-163" target="uSWqA2PRX45ugPRLn6LA-169" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-163" value="线程组配置" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="2160" y="599" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-168" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-165" target="uSWqA2PRX45ugPRLn6LA-167" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-172" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-165" target="uSWqA2PRX45ugPRLn6LA-171" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-165" value="BootstrapHandlers&lt;br&gt;.channelOperationFactory(b);" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="2160" y="680" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-174" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-167" target="uSWqA2PRX45ugPRLn6LA-173" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-167" value="HTTP协议相关配置&lt;br&gt;协议版本、解码器、压缩、cookie相关&lt;br&gt;支持多种版本协议，这里只关注h11" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="2160" y="776" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-169" value="&lt;font style=&quot;font-size: 8px;&quot;&gt;LoopResources loops = HttpResources.get();&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;font style=&quot;font-size: 8px;&quot;&gt;EventLoopGroup selector = loops.onServerSelect(LoopResources.DEFAULT_NATIVE);&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;font style=&quot;font-size: 8px;&quot;&gt;EventLoopGroup elg = loops.onServer(LoopResources.DEFAULT_NATIVE);&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;font style=&quot;font-size: 8px;&quot;&gt;b.&lt;b&gt;group&lt;/b&gt;(selector, elg).&lt;b&gt;channel&lt;/b&gt;(loops.onServerChannel(elg));&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;arcSize=6;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="2400" y="589" width="320" height="81" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-171" value="b.option(OPS_OPTION, null);&lt;br&gt;return ops;&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;清除自定义选项&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="2400" y="680.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-173" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;font style=&quot;font-size: 8px;&quot;&gt;return BootstrapHandlers.&lt;b&gt;updateConfiguration&lt;/b&gt;(b,&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;font style=&quot;font-size: 8px;&quot;&gt;&amp;nbsp; &amp;nbsp; NettyPipeline.HttpInitializer,&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;font style=&quot;font-size: 8px;&quot;&gt;&amp;nbsp; &amp;nbsp; new Http1Initializer(conf.decoder.maxInitialLineLength(),&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;font style=&quot;font-size: 8px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; conf.decoder.maxHeaderSize(),&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;font style=&quot;font-size: 8px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; conf.decoder.maxChunkSize(),&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;font style=&quot;font-size: 8px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; conf.decoder.validateHeaders(),&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;font style=&quot;font-size: 8px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; conf.decoder.initialBufferSize(),&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;font style=&quot;font-size: 8px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; conf.minCompressionSize,&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;font style=&quot;font-size: 8px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; compressPredicate(conf.compressPredicate, conf.minCompressionSize),&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;font style=&quot;font-size: 8px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; conf.forwarded,&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;font style=&quot;font-size: 8px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; conf.cookieEncoder,&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;font style=&quot;font-size: 8px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; conf.cookieDecoder));&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#d5e8d4;strokeColor=#82b366;arcSize=7;align=left;" parent="1" vertex="1">
          <mxGeometry x="2400" y="746" width="320" height="120" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-179" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-175" target="uSWqA2PRX45ugPRLn6LA-178" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-175" value="SSL相关，&lt;br&gt;其实就是往ChannelHandler 责任链中加入了SSL的处理，暂略" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1880" y="1040" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-177" value="TcpServerBind" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="1930" y="1018" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-181" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;dashed=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-178" target="uSWqA2PRX45ugPRLn6LA-180" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-178" value="return Mono.&lt;b&gt;create&lt;/b&gt;(sink-&amp;gt;{...})&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;sink -&amp;gt; {} 定义序列生成逻辑，参考reactor-core的流程图&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1880" y="1120" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-183" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-180" target="uSWqA2PRX45ugPRLn6LA-182" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-180" value="ServerBootstrap bootstrap = b.clone();&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;又克隆了一次，为何不再原对象上操作，&lt;br&gt;哪里会复用么？&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="2120" y="1120" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-185" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-182" target="uSWqA2PRX45ugPRLn6LA-184" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-204" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-182" target="uSWqA2PRX45ugPRLn6LA-203" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-182" value="&lt;div&gt;ConnectionObserver &lt;b&gt;obs&lt;/b&gt; = BootstrapHandlers&lt;/div&gt;&lt;div&gt;.&lt;b&gt;connectionObserver&lt;/b&gt;(bootstrap);&lt;/div&gt;&lt;div&gt;ConnectionObserver &lt;b&gt;childObs&lt;/b&gt; = BootstrapHandlers&lt;/div&gt;&lt;div&gt;.&lt;b&gt;childConnectionObserver&lt;/b&gt;(bootstrap);&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="2100" y="1200" width="240" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-187" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-184" target="uSWqA2PRX45ugPRLn6LA-186" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-206" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-184" target="uSWqA2PRX45ugPRLn6LA-205" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-184" value="&lt;div&gt;ChannelOperations.OnSetup ops =&lt;/div&gt;&lt;div&gt;BootstrapHandlers&lt;br&gt;.&lt;b&gt;channelOperationFactory&lt;/b&gt;(bootstrap);&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;创建ChannelOperations工厂&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="2120" y="1280" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-189" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-186" target="uSWqA2PRX45ugPRLn6LA-188" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-186" value="convertLazyLocalAddress(bootstrap);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;懒配置SocketAddress, 默认没用到，暂略&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="2120" y="1360" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-191" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-188" target="uSWqA2PRX45ugPRLn6LA-190" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-210" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-188" target="uSWqA2PRX45ugPRLn6LA-209" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-188" value="BootstrapHandlers.&lt;b&gt;finalizeHandler&lt;/b&gt;(&lt;br&gt;bootstrap, ops, new ChildObserver(childObs));" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="2120" y="1440" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-193" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-190" target="uSWqA2PRX45ugPRLn6LA-192" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-48" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-190" target="bm2imlQ028U47hNO7TBu-47" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-190" value="ChannelFuture f = bootstrap.bind();&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;Tcp服务器bind&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="2120" y="1601" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-195" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-192" target="uSWqA2PRX45ugPRLn6LA-194" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-192" value="DisposableBind disposableServer = new DisposableBind(sink, f, obs, bootstrap);" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="2120" y="1720" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-197" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-194" target="uSWqA2PRX45ugPRLn6LA-196" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-3" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-194" target="bm2imlQ028U47hNO7TBu-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-194" value="f.&lt;b&gt;addListener&lt;/b&gt;(disposableServer);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;HttpServer bind成功或失败后会回调 operationComplete() 继承自&lt;b&gt;ChannelFutureListener&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2120" y="1800" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-35" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="uSWqA2PRX45ugPRLn6LA-196" target="bm2imlQ028U47hNO7TBu-34" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-196" value="sink.onCancel(disposableServer);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;注册Mono取消的回调方法，&lt;br&gt;只是用于在Mono取消后调用&lt;b&gt;dispose&lt;/b&gt;()释放资源&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2120" y="1938.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-198" value="&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;HttpServer初始化后的实际对象：&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;this = {&lt;b&gt;HttpServerTcpConfig&lt;/b&gt;@2224}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp;tcpServerMapper = {HttpServer$lambda@2225}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp;source = {&lt;b&gt;HttpServerHandle&lt;/b&gt;@2226}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; handler = {HttpServerTests$lambda@2218}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; source = {&lt;b&gt;HttpServerTcpConfig&lt;/b&gt;@2217}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp;tcpServerMapper = {HttpServer$lambda@2219}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp;source = {&lt;b&gt;HttpServerBind&lt;/b&gt;@2220}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; tcpServer = {TcpServerBind@2180}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;serverBootstrap = {ServerBootstrap@2182}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-440" y="350" width="250" height="130" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-199" value="&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;TcpServer装配后的实际对象：&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;b = {TcpServerBootstrap@2244}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp;bootstrapMapper = {HttpServer$lambda@2245}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp;source = {TcpServerBootstrap@2242}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; bootstrapMapper = {HttpServerHandle@2234}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; source = {TcpServerBootstrap@2232}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp;bootstrapMapper = {TcpServer$lambda@2233}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp;source = {TcpServerBind@2180}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp; serverBootstrap = {ServerBootstrap@2181}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-1780" y="360" width="240" height="120" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-200" value="&lt;div style=&quot;text-align: center;&quot;&gt;&lt;font style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;reactor.netty.&lt;/font&gt;&lt;font style=&quot;background-color: initial;&quot; color=&quot;#000000&quot;&gt;channel.&lt;/font&gt;&lt;/font&gt;&lt;b style=&quot;color: rgb(0, 0, 0); background-color: initial;&quot;&gt;BootstrapHandlers&lt;/b&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;&quot;&gt;&amp;nbsp;Helper to update configuration the main {@link Bootstrap} and&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp;{@link ServerBootstrap} handlers&lt;/span&gt;&lt;br&gt;&lt;font color=&quot;#000000&quot;&gt;&amp;nbsp;&lt;/font&gt;&lt;br&gt;&amp;nbsp;//为 ServerBootStrap 初始化配置 ChannelHandler&lt;br&gt;&lt;font color=&quot;#000000&quot;&gt;&amp;nbsp;public static void finalizeHandler(ServerBootstrap b, ChannelOperations.OnSetup&lt;/font&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;&lt;font color=&quot;#000000&quot;&gt;&lt;span style=&quot;&quot;&gt;&lt;span style=&quot;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;opsFactory, ConnectionObserver childListener)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp;&lt;/span&gt;//为 Bootstrap 即客户端初始化配置 ChannelHandler&lt;div&gt;&lt;font color=&quot;#000000&quot;&gt;&amp;nbsp;public static void finalizeHandler(Bootstrap b,&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#000000&quot;&gt;&amp;nbsp; &amp;nbsp; ChannelOperations.OnSetup opsFactory, ConnectionObserver listener)&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#000000&quot;&gt;&amp;nbsp;//&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#000000&quot;&gt;&amp;nbsp;public static void channelOperationFactory(AbstractBootstrap&amp;lt;?, ?&amp;gt; b,&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#000000&quot;&gt;&amp;nbsp; &amp;nbsp; ChannelOperations.OnSetup opsFactory)&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#000000&quot;&gt;&amp;nbsp;public static ChannelOperations.OnSetup channelOperationFactory(AbstractBootstrap&amp;lt;?, ?&amp;gt; b)&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#000000&quot;&gt;&amp;nbsp;public static void connectionObserver(AbstractBootstrap&amp;lt;?, ?&amp;gt; b,&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#000000&quot;&gt;&amp;nbsp; &amp;nbsp; ConnectionObserver connectionObserver)&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#000000&quot;&gt;&amp;nbsp;public static void childConnectionObserver(ServerBootstrap b,&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#000000&quot;&gt;&amp;nbsp; &amp;nbsp; ConnectionObserver connectionObserver)&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#000000&quot;&gt;&amp;nbsp;public static Bootstrap updateConfiguration(Bootstrap b, String name,&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#000000&quot;&gt;&amp;nbsp; &amp;nbsp; BiConsumer&amp;lt;ConnectionObserver, ? super Channel&amp;gt; c)&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#000000&quot;&gt;&amp;nbsp;public static Bootstrap updateLogSupport(Bootstrap b, LoggingHandler handler)&lt;/font&gt;&lt;/div&gt;&lt;/font&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="-480" y="1200" width="440" height="340" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-203" value="读取AbstractBootstrap选项Map中&lt;br&gt;名为&lt;b&gt;connectionObserver&lt;/b&gt;的选项的值" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="2360" y="1200" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-205" value="ChannelOperations.OnSetup ops = (ChannelOperations.OnSetup) b.config().options().get(&lt;b&gt;OPS_OPTION&lt;/b&gt;);" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="2360" y="1280" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-212" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="uSWqA2PRX45ugPRLn6LA-209" target="uSWqA2PRX45ugPRLn6LA-211" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-209" value="&lt;font style=&quot;font-size: 9px;&quot;&gt;ChannelHandler handler = b.config().&lt;b&gt;childHandler&lt;/b&gt;();&lt;br&gt;&lt;b&gt;pipeline&lt;/b&gt; = (BootstrapPipelineHandler) handler;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="2360" y="1440" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-211" value="b.&lt;b&gt;childHandler&lt;/b&gt;(new &lt;b&gt;BootstrapInitializerHandler&lt;/b&gt;(pipeline, opsFactory, childListener));" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="2360" y="1520" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-213" value="&lt;div style=&quot;text-align: center;&quot;&gt;&lt;font style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;reactor.netty.&lt;/font&gt;&lt;font style=&quot;background-color: initial;&quot; color=&quot;#000000&quot;&gt;channel.&lt;/font&gt;&lt;/font&gt;&lt;font style=&quot;background-color: initial;&quot; color=&quot;#000000&quot;&gt;&lt;b&gt;BootstrapHandlers&lt;/b&gt;&lt;/font&gt;&lt;font style=&quot;background-color: initial;&quot;&gt;&lt;font style=&quot;background-color: initial;&quot; color=&quot;#000000&quot;&gt;.&lt;/font&gt;&lt;/font&gt;&lt;b style=&quot;background-color: initial; color: rgb(0, 0, 0);&quot;&gt;BootstrapInitializerHandler&amp;nbsp;&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;text-align: center;&quot;&gt;&lt;font color=&quot;#000000&quot;&gt;extends ChannelInitializer&amp;lt;Channel&amp;gt;&lt;/font&gt;&lt;br&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp;ChannelHandler pipeline 初始化器&lt;/font&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;// 存储待配置的PipelineConfiguration的List容器&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#000000&quot;&gt;final &lt;b&gt;BootstrapPipelineHandler&lt;/b&gt; pipeline;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;// 连接状态变更的监听器&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#000000&quot;&gt;final ConnectionObserver&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;listener;&lt;span style=&quot;&quot;&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;// OPS_OPTION 配置&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;span style=&quot;&quot;&gt;&lt;font color=&quot;#000000&quot;&gt;final ChannelOperations.OnSetup opsFactory;&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="-960" y="1200" width="440" height="160" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-217" value="BootstrapPipelineHandler p = new BootstrapPipelineHandler p = &lt;b&gt;BootstrapPipelineHandler&lt;/b&gt;(&lt;br&gt;Collections.emptyList());" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="1880" y="520" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-219" value="&lt;font color=&quot;#007fff&quot;&gt;将后面创建的 BootstrapPipelineHandler&lt;br&gt;赋值给 ServerBootstrap childHandler&lt;br&gt;&amp;nbsp;&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="1400" y="589" width="230" height="60" as="geometry" />
        </mxCell>
        <mxCell id="uSWqA2PRX45ugPRLn6LA-220" value="&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;这里对BootstrapPipelineHandler&lt;br&gt;又注册了 &lt;b&gt;Http1Initializer&lt;/b&gt; 这个 Handler&lt;br&gt;&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="2725" y="756" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-1" value="&lt;font color=&quot;#007fff&quot;&gt;MonoCreate 发布者在onSubscribe() &lt;br&gt;触发订阅后，会执行 sink -&amp;gt; {...} 逻辑&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="1880" y="1190" width="220" height="40" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-10" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="bm2imlQ028U47hNO7TBu-2" target="bm2imlQ028U47hNO7TBu-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-2" value="TcpServerBind#operationComplete()&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;无论成功或失败都会发送信号（序列元素）&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="2360" y="1800" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-5" value="&lt;div&gt;f.&lt;b&gt;removeListener&lt;/b&gt;(this);&lt;/div&gt;&lt;div&gt;if (f.channel().isActive()) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; f.channel().&lt;b&gt;close&lt;/b&gt;();&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; HttpResources.get().disposeWhen(&lt;/div&gt;&lt;div&gt;bootstrap.config().localAddress());&lt;/div&gt;&lt;div&gt;} else if (!f.isDone()) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; f.&lt;b&gt;cancel&lt;/b&gt;(true);&lt;/div&gt;&lt;div style=&quot;&quot;&gt;}&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;arcSize=6;" parent="1" vertex="1">
          <mxGeometry x="2600" y="1919" width="200" height="99" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-12" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="bm2imlQ028U47hNO7TBu-9" target="bm2imlQ028U47hNO7TBu-11" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-13" value="失败" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#007FFF;" parent="bm2imlQ028U47hNO7TBu-12" vertex="1" connectable="0">
          <mxGeometry x="-0.25" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-15" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;rounded=1;" parent="1" source="bm2imlQ028U47hNO7TBu-9" target="bm2imlQ028U47hNO7TBu-14" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-16" value="成功" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#007FFF;" parent="bm2imlQ028U47hNO7TBu-15" vertex="1" connectable="0">
          <mxGeometry x="-0.038" y="-2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-9" value="!f.isSuccess()" style="rhombus;whiteSpace=wrap;html=1;fontSize=10;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="2600" y="1790" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-19" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;rounded=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" source="bm2imlQ028U47hNO7TBu-11" target="uSWqA2PRX45ugPRLn6LA-84" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2940" y="1790" />
              <mxPoint x="2940" y="1030" />
              <mxPoint x="660" y="1030" />
              <mxPoint x="660" y="831" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-11" value="if (f.isCancelled())&amp;nbsp;&lt;br&gt;&amp;nbsp; &amp;nbsp; return;&lt;br&gt;sink.&lt;b&gt;error&lt;/b&gt;(ChannelBindException.fail(&lt;br&gt;bootstrap, f.cause()));" style="whiteSpace=wrap;html=1;fontSize=10;rounded=1;align=left;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2720" y="1760" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-18" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fillColor=#dae8fc;strokeColor=#6c8ebf;rounded=1;" parent="1" source="bm2imlQ028U47hNO7TBu-14" target="uSWqA2PRX45ugPRLn6LA-84" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2940" y="1869" />
              <mxPoint x="2940" y="1030" />
              <mxPoint x="660" y="1030" />
              <mxPoint x="660" y="831" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-21" value="信号" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="bm2imlQ028U47hNO7TBu-18" vertex="1" connectable="0">
          <mxGeometry x="0.9705" y="-3" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-14" value="&lt;div&gt;sink.&lt;b&gt;success&lt;/b&gt;(this);&lt;/div&gt;&lt;div&gt;selectorObserver.&lt;b&gt;onStateChange&lt;/b&gt;(this, ConnectionObserver.State.CONNECTED);&lt;span style=&quot;&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;this即DisposableBind对象&lt;/font&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;fontSize=10;rounded=1;align=left;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2720" y="1839" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-20" value="&lt;font color=&quot;#007fff&quot;&gt;发送信号&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="2950" y="1775" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-25" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-22" target="bm2imlQ028U47hNO7TBu-24" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-22" value="关闭HttpServer" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10;gradientColor=#97d077;" parent="1" vertex="1">
          <mxGeometry x="40" y="1080" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-27" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-24" target="bm2imlQ028U47hNO7TBu-26" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-24" value=".disposeNow()&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;主动关闭&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="240" y="1080" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-29" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-26" target="bm2imlQ028U47hNO7TBu-28" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-26" value="dispose();&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;关闭通道，释放资源&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="440" y="1080" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-28" value="onDispose().block(timeout);" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="440" y="1160" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-30" value="return FutureMono.from(channel().closeFuture());&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;closeFuture()会等待关闭通道&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="440" y="881" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-36" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="bm2imlQ028U47hNO7TBu-34" target="bm2imlQ028U47hNO7TBu-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-34" value="TcpServerBind#&lt;b&gt;dispose&lt;/b&gt;()&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;关闭通道，释放Http资源&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2360" y="1938.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-41" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-39" target="bm2imlQ028U47hNO7TBu-40" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-39" value="客户端连接处理" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10;gradientColor=#97d077;" parent="1" vertex="1">
          <mxGeometry x="40" y="2079" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-52" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;" parent="1" source="bm2imlQ028U47hNO7TBu-40" target="bm2imlQ028U47hNO7TBu-51" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-40" value="&lt;div&gt;EpollEventLoop#&lt;span style=&quot;background-color: initial;&quot;&gt;run()&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;这里只分析NIO,至于为何走到这，&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;参考Netty源码流程图，4.1.43等新版本 NioEventLoop改名为了EpollEventLoop&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="240" y="2079" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-42" value="&lt;div style=&quot;text-align: center; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;reactor.netty.ConnectionObserver&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;&quot;&gt;此接口是TCP连接（Connection）生命周期的监听器，生命周期的5种状态：&lt;br&gt;&lt;br&gt;//状态改变后回调&lt;br&gt;&lt;font color=&quot;#000000&quot;&gt;void onStateChange(Connection connection, State newState);&lt;/font&gt;&lt;br&gt;//链接另一个ConnectionObserver&lt;br&gt;&lt;font color=&quot;#000000&quot;&gt;ConnectionObserver then(ConnectionObserver other)&lt;/font&gt;&lt;br&gt;&lt;br&gt;//&amp;nbsp;interface State 内部类定义&lt;br&gt;// 连接被建立且可用&lt;br&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#000000&quot;&gt;State CONNECTED = ReactorNetty.CONNECTED;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;// 连接被绑定到通道操作并已准备好交互&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#000000&quot;&gt;State CONFIGURED = ReactorNetty.CONFIGURED;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#000000&quot;&gt;State ACQUIRED = ReactorNetty.ACQUIRED;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#000000&quot;&gt;State RELEASED = ReactorNetty.RELEASED;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#000000&quot;&gt;State DISCONNECTING = ReactorNetty.DISCONNECTING;&lt;/font&gt;&lt;/div&gt;&lt;/font&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="-960" y="801" width="440" height="239" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-43" value="&lt;div style=&quot;text-align: center;&quot;&gt;&lt;font style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;reactor.netty.&lt;/font&gt;&lt;font style=&quot;background-color: initial;&quot; color=&quot;#000000&quot;&gt;channel.&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;text-align: center;&quot;&gt;&lt;font color=&quot;#000000&quot;&gt;&lt;b&gt;ChannelOperations&lt;/b&gt;&amp;lt;INBOUND extends NettyInbound, OUTBOUND extends NettyOutbound&amp;gt;&lt;/font&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp;定义响应式的ChannelHandler&lt;/font&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px; font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#000000&quot;&gt;final Connection&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;connection&lt;/b&gt;;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#000000&quot;&gt;final FluxReceive&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;b&gt;inbound&lt;/b&gt;;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#000000&quot;&gt;final ConnectionObserver&amp;nbsp; &lt;b&gt;listener&lt;/b&gt;;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#000000&quot;&gt;final MonoProcessor&amp;lt;Void&amp;gt; &lt;b&gt;onTerminate&lt;/b&gt;;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 4px;&quot;&gt;&lt;font color=&quot;#000000&quot;&gt;volatile Subscription &lt;b&gt;outboundSubscription&lt;/b&gt;;&lt;/font&gt;&lt;/p&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="-1440" y="800" width="440" height="240" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-46" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;endArrow=diamondThin;endFill=1;" parent="1" source="bm2imlQ028U47hNO7TBu-44" target="uSWqA2PRX45ugPRLn6LA-213" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-44" value="&lt;div style=&quot;text-align: center;&quot;&gt;&lt;font style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#000000&quot;&gt;reactor.netty.&lt;/font&gt;&lt;font style=&quot;background-color: initial;&quot; color=&quot;#000000&quot;&gt;channel.&lt;/font&gt;&lt;/font&gt;&lt;font style=&quot;background-color: initial;&quot; color=&quot;#000000&quot;&gt;&lt;b&gt;BootstrapHandlers&lt;/b&gt;&lt;/font&gt;&lt;font style=&quot;background-color: initial;&quot;&gt;&lt;font style=&quot;background-color: initial;&quot; color=&quot;#000000&quot;&gt;.&lt;/font&gt;&lt;/font&gt;&lt;b style=&quot;color: rgb(0, 0, 0); background-color: initial;&quot;&gt;BootstrapPipelineHandler&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;text-align: center;&quot;&gt;&lt;font color=&quot;#000000&quot;&gt;&amp;nbsp;extends ArrayList&amp;lt;PipelineConfiguration&amp;gt;&amp;nbsp;&lt;/font&gt;&lt;span style=&quot;color: rgb(0, 0, 0); background-color: initial;&quot;&gt;implements ChannelHandler&lt;/span&gt;&lt;/div&gt;&lt;hr style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp;是一个List容器，存储PipelineConfiguration&lt;br&gt;&lt;/font&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=10;fontFamily=Helvetica;html=1;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="-1360" y="1240" width="360" height="80" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-59" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="bm2imlQ028U47hNO7TBu-47" target="bm2imlQ028U47hNO7TBu-58" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-47" value="doBind(localAddress);" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="2360" y="1601" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-49" value="&lt;font style=&quot;font-size: 10px;&quot;&gt;这步是Netty的源码实现，这里不细讲&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="2365" y="1661" width="190" height="30" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-50" value="&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#007fff&quot;&gt;&lt;b style=&quot;&quot;&gt;绑定后用于监听连接的Channel的pipeline&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#007fff&quot;&gt;pipeline = {DefaultChannelPipeline@2934}&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#007fff&quot;&gt;&amp;nbsp;&lt;b&gt;head&lt;/b&gt; = {DefaultChannelPipeline$&lt;b&gt;HeadContext&lt;/b&gt;@2941}&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#007fff&quot;&gt;&amp;nbsp; &lt;b&gt;next&lt;/b&gt; = {DefaultChannelHandlerContext@3278} &quot;ChannelHandlerContext(ServerBootstrap$&lt;b&gt;ServerBootstrapAcceptor&lt;/b&gt;#0, [id: 0x6bc5b9d7])&quot;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp;handler = {ServerBootstrap$ServerBootstrapAcceptor@3282}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; childGroup = {EpollEventLoopGroup@2565}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; childHandler = {BootstrapHandlers$&lt;b&gt;BootstrapInitializerHandler&lt;/b&gt;@2728}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; childOptions = {Map$Entry[2]@3003}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; childAttrs = {Map$Entry[0]@3017}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; enableAutoReadTask = {ServerBootstrap$ServerBootstrapAcceptor$1@3318}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; added = true&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp;&lt;b style=&quot;&quot;&gt;next&lt;/b&gt; = {DefaultChannelPipeline$&lt;b style=&quot;&quot;&gt;TailContext&lt;/b&gt;@2942}&lt;/font&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="2800" y="1600" width="650" height="160" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-55" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-51" target="bm2imlQ028U47hNO7TBu-128" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="680" y="2108.9999999999995" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-51" value="&lt;div&gt;EpollEventLoop#&lt;/div&gt;&lt;div&gt;processReady(events, strategy)&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;注意Netty新版本没有这个方法了，新版本&lt;/font&gt;&lt;/div&gt;&lt;font color=&quot;#007fff&quot;&gt;在processReady&lt;/font&gt;&lt;span style=&quot;color: rgb(0, 127, 255); background-color: initial;&quot;&gt;()处理&lt;/span&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="440" y="2079" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-53" value="&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;服务端启动阶段会创建用于监听连接的Channel&lt;br&gt;在客户端发起连接后还会创建与客户端一对一的通信Channel&lt;br&gt;childHandler 就是用于通信Channel的Handler&lt;br&gt;&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="40" y="2139" width="290" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-56" value="CLEANUP_GLOBAL_RESOURCE = DisposableBind::new;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1640" y="1140" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-58" value="&lt;font color=&quot;#007fff&quot;&gt;主要是创建监听连接的Channel 和 Handler pipeline, 然后执行端口绑定操作&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="2600" y="1601" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-60" value="&lt;div&gt;ChannelHandler注册流程：&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;１）先新建ChannelInitializer封装成DefaultChannelHandlerContext加入pipeline末尾（tail节点前），提交Handler注册任务Ａ到 pendingHandlerCallbackHead 链表（后面register阶段才会启动执行）&lt;/div&gt;&lt;div&gt;２）bind阶段，事件循环线程T启动后第一个任务执行register0(), 会扫描pendingHandlerCallbackHead并执行Handler注册任务，上面A任务会执行，A任务会再向事件循环线程池注册一个异步任务B, 用于执行用户定制的ChannelInitializer并封装ServerBootstrapAcceptor再添加到pipeline末尾, A任务执行完成会将前面默认创建的ChannelInitializer从pipeline删除掉&lt;/div&gt;&lt;div&gt;３）事件循环线程T的下一个循环，会扫描taskQueue读取任务B并执行，将ServerBootstrapAcceptor封装成DefaultChannelHandlerContext加入pipeline末尾&lt;/div&gt;&lt;div&gt;最终服务端启动阶段完成后&lt;b&gt;用于接收连接的Channel&lt;/b&gt;（类NioServerSocketChannel, Acceptor）的Handler pipeline:&lt;br&gt;&lt;b&gt;HeadContext &amp;lt;---&amp;gt;&amp;nbsp;ServerBootstrapAcceptor &amp;lt;---&amp;gt; TailContext&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;NioServerSocketChannel 是用于监听连接的Channel (本质是Server Socket 文件)&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;4)&amp;nbsp;至于建立连接后&lt;b&gt;用于通信的 Channel的 Handler pipeline&lt;/b&gt; 是在processSelectedKeys()&amp;nbsp;&lt;span style=&quot;background-color: initial;&quot;&gt;接受到连接事件后，调用&lt;/span&gt;ServerBootstrapAcceptor&lt;span style=&quot;background-color: initial;&quot;&gt;#channelRead() 执行子Channel Handler的注册的&lt;/span&gt;&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#007FFF;" parent="1" vertex="1">
          <mxGeometry x="2600" y="1310.5" width="320" height="289.5" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-82" value="这部分流程大部分是Netty源码实现&lt;br&gt;由于版本不一样代码有变化，&lt;br&gt;重新过下Netty这部分代码" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="215" y="2013" width="210" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-93" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-87" target="bm2imlQ028U47hNO7TBu-92" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-117" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="bm2imlQ028U47hNO7TBu-87" target="bm2imlQ028U47hNO7TBu-108" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-87" value="&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;div&gt;for (PipelineConfiguration pipelineConfiguration : &lt;b&gt;pipeline&lt;/b&gt;) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; pipelineConfiguration.consumer&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;.&lt;b&gt;accept&lt;/b&gt;(listener, ch);&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="3320" y="2798" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-89" value="BootstrapHandlers" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="3360" y="2769" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-90" value="调 reactor-netty 代码" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="3170" y="2812" width="130" height="30" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-115" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="bm2imlQ028U47hNO7TBu-92" target="bm2imlQ028U47hNO7TBu-114" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-92" value="&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;1&quot;&gt;ChannelOperations.addReactiveBridge(ch, opsFactory, listener);&lt;/font&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="3320" y="3400" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-215" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="bm2imlQ028U47hNO7TBu-94" target="bm2imlQ028U47hNO7TBu-214" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-94" value="&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;1&quot;&gt;Http1Initializer#accept()&lt;/font&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot; size=&quot;1&quot;&gt;5个Handler: Http协议编解码器、访问日志记录、压缩、请求处理、监控&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="3560" y="2878" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-99" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-96" target="bm2imlQ028U47hNO7TBu-98" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-217" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="bm2imlQ028U47hNO7TBu-96" target="bm2imlQ028U47hNO7TBu-106" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-96" value="&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;1&quot;&gt;p.addLast(NettyPipeline.HttpCodec, new &lt;b&gt;HttpServerCodec&lt;/b&gt;(line, header, chunk, validate, buffer));&lt;/font&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="3800" y="2959.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-101" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-98" target="bm2imlQ028U47hNO7TBu-100" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-98" value="&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;div&gt;&lt;div style=&quot;&quot;&gt;if (ACCESS_LOG) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; p.addLast(NettyPipeline.AccessLogHandler, &lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;new &lt;b&gt;AccessLogHandler&lt;/b&gt;());&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="3800" y="3039.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-103" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-100" target="bm2imlQ028U47hNO7TBu-102" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-100" value="&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;div&gt;if (alwaysCompress) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; p.addLast(NettyPipeline.CompressionHandler,&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; new &lt;b&gt;SimpleCompressionHandler&lt;/b&gt;());&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="3800" y="3119.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-105" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-102" target="bm2imlQ028U47hNO7TBu-104" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-218" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="bm2imlQ028U47hNO7TBu-102" target="bm2imlQ028U47hNO7TBu-106" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-219" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="bm2imlQ028U47hNO7TBu-102" target="bm2imlQ028U47hNO7TBu-111" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-102" value="&lt;div style=&quot;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;1&quot;&gt;p.&lt;b&gt;addLast&lt;/b&gt;(NettyPipeline.HttpTrafficHandler,&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;1&quot;&gt;new &lt;b&gt;HttpTrafficHandler&lt;/b&gt;(listener, forwarded, compressPredicate, cookieEncoder, cookieDecoder));&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="3800" y="3198.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-104" value="&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;div&gt;ChannelHandler handler = p.get(NettyPipeline.ChannelMetricsHandler);&lt;/div&gt;&lt;div&gt;if (handler != null) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; p.addAfter(NettyPipeline.HttpTrafficHandler, NettyPipeline.HttpMetricsHandler, &lt;b&gt;httpMetrics&lt;/b&gt;);&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="3800" y="3277" width="200" height="81" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-106" value="&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;1&quot;&gt;handlerAdded(ChannelHandlerContext ctx)&lt;/font&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="4080.06" y="2959.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-118" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="bm2imlQ028U47hNO7TBu-108" target="bm2imlQ028U47hNO7TBu-94" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-213" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-108" target="bm2imlQ028U47hNO7TBu-212" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-108" value="&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;1&quot;&gt;LoggingHandlerSupportConsumer#accept()&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot; size=&quot;1&quot;&gt;通过 addXxx() 注册&lt;/font&gt;&lt;/div&gt;&lt;font color=&quot;#007fff&quot; size=&quot;1&quot;&gt;NettyPipeline.LoggingHandler&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="3560" y="2798" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-221" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-111" target="bm2imlQ028U47hNO7TBu-220" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-111" value="&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;1&quot;&gt;ctx.read()&lt;/font&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" parent="1" vertex="1">
          <mxGeometry x="4080.06" y="3198.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-114" value="&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;div&gt;ch.pipeline()&lt;span style=&quot;background-color: initial;&quot;&gt;.addLast(&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;NettyPipeline.ReactiveBridge,&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;new &lt;b&gt;ChannelOperationsHandler&lt;/b&gt;(opsFactory, listener));&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="3560" y="3400" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-116" value="&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;测试案例中子Channel(用于通信的Channel) Handler pipeline&lt;/b&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;pipeline = {DefaultChannelPipeline@2778}&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp;head = {DefaultChannelPipeline$HeadContext@2786}&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; next = {DefaultChannelHandlerContext@3132}&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp;handler = {&lt;b&gt;LoggingHandler&lt;/b&gt;@3136}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp;next = {DefaultChannelHandlerContext@2969}&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; handler = {BootstrapHandlers$&lt;b&gt;BootstrapInitializerHandler&lt;/b&gt;@2800}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; next = {DefaultChannelHandlerContext@3463}&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;handler = {&lt;b&gt;HttpServerCodec&lt;/b&gt;@3741}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;next = {DefaultChannelHandlerContext@3504}&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; handler = {&lt;b&gt;HttpTrafficHandler&lt;/b&gt;@3503}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; next = {DefaultChannelHandlerContext@3853&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;handler = {&lt;b&gt;ChannelOperationsHandler&lt;/b&gt;@3852}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;next = {DefaultChannelPipeline$TailContext@2787}&lt;/font&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="3320" y="3179.5" width="400" height="210" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-133" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-128" target="bm2imlQ028U47hNO7TBu-132" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-128" value="&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;final int fd = events.fd(i);&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;final long ev = events.events(i);&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;AbstractEpollChannel ch = &lt;b&gt;channels&lt;/b&gt;.get(fd);&lt;br&gt;&lt;/span&gt;AbstractEpollUnsafe unsafe = (AbstractEpollUnsafe) ch.unsafe();&lt;/font&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" parent="1" vertex="1">
          <mxGeometry x="680" y="2079" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-139" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="bm2imlQ028U47hNO7TBu-132" target="bm2imlQ028U47hNO7TBu-134" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-140" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="bm2imlQ028U47hNO7TBu-132" target="bm2imlQ028U47hNO7TBu-135" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-141" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="bm2imlQ028U47hNO7TBu-132" target="bm2imlQ028U47hNO7TBu-137" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-132" value="ev" style="rhombus;whiteSpace=wrap;html=1;fontSize=10;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="740" y="2231" width="80" height="72" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-143" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-134" target="bm2imlQ028U47hNO7TBu-142" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-134" value="&lt;div style=&quot;&quot;&gt;Native.EPOLLERR | Native.&lt;b&gt;EPOLLOUT&lt;/b&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" parent="1" vertex="1">
          <mxGeometry x="920" y="2157" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-145" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-135" target="bm2imlQ028U47hNO7TBu-144" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-135" value="&lt;div style=&quot;&quot;&gt;Native.EPOLLERR | Native.&lt;b&gt;EPOLLIN&lt;/b&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" parent="1" vertex="1">
          <mxGeometry x="920" y="2237" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-147" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-137" target="bm2imlQ028U47hNO7TBu-146" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-137" value="&lt;div style=&quot;&quot;&gt;Native.&lt;b&gt;EPOLLRDHUP&lt;/b&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" parent="1" vertex="1">
          <mxGeometry x="920" y="2317" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-142" value="&lt;div style=&quot;&quot;&gt;unsafe.epollOutReady();&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" parent="1" vertex="1">
          <mxGeometry x="1160" y="2157" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-149" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-144" target="bm2imlQ028U47hNO7TBu-148" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-236" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.75;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="bm2imlQ028U47hNO7TBu-144" target="bm2imlQ028U47hNO7TBu-237" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="450" y="2510" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1370" y="2282" />
              <mxPoint x="1370" y="2388" />
              <mxPoint x="420" y="2388" />
              <mxPoint x="420" y="2631" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-144" value="&lt;div style=&quot;&quot;&gt;unsafe.epollInReady();&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" parent="1" vertex="1">
          <mxGeometry x="1160" y="2237" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-146" value="&lt;div style=&quot;&quot;&gt;unsafe.epollRdHupReady();&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" parent="1" vertex="1">
          <mxGeometry x="1160" y="2317" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-151" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-148" target="bm2imlQ028U47hNO7TBu-150" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-148" value="&lt;div style=&quot;&quot;&gt;final ChannelConfig config = config();&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" parent="1" vertex="1">
          <mxGeometry x="1400" y="2237" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-153" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-150" target="bm2imlQ028U47hNO7TBu-152" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-150" value="&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;final EpollRecvByteAllocatorHandle allocHandle = recvBufAllocHandle();&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;allocHandle.edgeTriggered(&lt;/font&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;isFlagSet(Native.EPOLLET));&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;allocHandle.reset(config);&lt;/font&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;allocHandle.attemptedBytesRead(1);&lt;/font&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" parent="1" vertex="1">
          <mxGeometry x="1380" y="2317" width="240" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-155" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-152" target="bm2imlQ028U47hNO7TBu-154" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-152" value="&lt;div style=&quot;&quot;&gt;final ChannelPipeline pipeline = pipeline();&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;这里获取的是Acceptor Channel 的 pipeline&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" parent="1" vertex="1">
          <mxGeometry x="1400" y="2397" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-165" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="bm2imlQ028U47hNO7TBu-154" target="bm2imlQ028U47hNO7TBu-164" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-154" value="&lt;div style=&quot;&quot;&gt;epollInBefore();&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" parent="1" vertex="1">
          <mxGeometry x="1400" y="2476" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-159" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-156" target="bm2imlQ028U47hNO7TBu-158" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-156" value="&lt;div style=&quot;&quot;&gt;allocHandle.readComplete();&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" parent="1" vertex="1">
          <mxGeometry x="1400" y="2679" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-161" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-158" target="bm2imlQ028U47hNO7TBu-160" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-158" value="&lt;div style=&quot;&quot;&gt;pipeline.&lt;b&gt;fireChannelReadComplete&lt;/b&gt;();&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="1400" y="2762" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-163" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-160" target="bm2imlQ028U47hNO7TBu-162" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-160" value="&lt;div style=&quot;&quot;&gt;&lt;div&gt;if (exception != null) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; pipeline.&lt;b&gt;fireExceptionCaught&lt;/b&gt;(exception);&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;发生异常的异常处理&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="1400" y="2842" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-162" value="&lt;div style=&quot;&quot;&gt;&lt;div&gt;finally {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; epollInFinally(config);&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;" parent="1" vertex="1">
          <mxGeometry x="1400" y="2922" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-166" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="bm2imlQ028U47hNO7TBu-164" target="bm2imlQ028U47hNO7TBu-156" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-168" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="bm2imlQ028U47hNO7TBu-164" target="bm2imlQ028U47hNO7TBu-167" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-164" value="&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;div&gt;do {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; allocHandle.lastBytesRead(&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;socket.&lt;b&gt;accept&lt;/b&gt;(acceptedAddress));&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; pipeline.&lt;b&gt;fireChannelRead&lt;/b&gt;(&lt;b&gt;newChildChannel&lt;/b&gt;(&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; allocHandle.lastBytesRead(), acceptedAddress, 1, &lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;acceptedAddress[0]));&lt;/div&gt;&lt;div&gt;} while (allocHandle.continueReading());&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;arcSize=7;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="1380" y="2556" width="240" height="103" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-170" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-167" target="bm2imlQ028U47hNO7TBu-169" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-188" value="1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="bm2imlQ028U47hNO7TBu-170" vertex="1" connectable="0">
          <mxGeometry x="-0.2235" y="-2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-167" value="&lt;div style=&quot;&quot;&gt;AbstractChannelHandlerContext&lt;/div&gt;&lt;div style=&quot;&quot;&gt;.invokeChannelRead(head, msg);&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;HeadContext&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" parent="1" vertex="1">
          <mxGeometry x="1640" y="2577.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-172" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-169" target="bm2imlQ028U47hNO7TBu-171" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-169" value="&lt;div style=&quot;&quot;&gt;final Object m = next.pipeline.touch(&lt;/div&gt;&lt;div style=&quot;&quot;&gt;ObjectUtil.checkNotNull(msg, &quot;msg&quot;), next);&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;EventExecutor executor = next.executor();&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;next.&lt;b&gt;invokeChannelRead&lt;/b&gt;(m);&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" parent="1" vertex="1">
          <mxGeometry x="1880" y="2577.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-174" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-171" target="bm2imlQ028U47hNO7TBu-173" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-194" value="2" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="bm2imlQ028U47hNO7TBu-174" vertex="1" connectable="0">
          <mxGeometry x="0.0118" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-192" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.75;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="bm2imlQ028U47hNO7TBu-171" target="bm2imlQ028U47hNO7TBu-177" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-195" value="3" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="bm2imlQ028U47hNO7TBu-192" vertex="1" connectable="0">
          <mxGeometry x="-0.2666" y="-2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-171" value="&lt;div style=&quot;&quot;&gt;((ChannelInboundHandler) handler()).channelRead(this, msg);&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" parent="1" vertex="1">
          <mxGeometry x="2120" y="2577.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-191" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.75;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;" parent="1" source="bm2imlQ028U47hNO7TBu-173" target="bm2imlQ028U47hNO7TBu-169" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2580" y="2623" />
              <mxPoint x="2580" y="2659" />
              <mxPoint x="1860" y="2659" />
              <mxPoint x="1860" y="2623" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-173" value="&lt;div style=&quot;&quot;&gt;invokeChannelRead(findContextInbound(&lt;/div&gt;&lt;div style=&quot;&quot;&gt;MASK_CHANNEL_READ), msg);&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;查找下一个InBound Handler&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" parent="1" vertex="1">
          <mxGeometry x="2360" y="2577.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-176" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-177" target="bm2imlQ028U47hNO7TBu-179" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-198" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-177" target="bm2imlQ028U47hNO7TBu-197" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-177" value="&lt;div style=&quot;&quot;&gt;child.&lt;b&gt;pipeline&lt;/b&gt;().addLast(&lt;b&gt;childHandler&lt;/b&gt;);&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2359.9399999999996" y="2702" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-178" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="bm2imlQ028U47hNO7TBu-179" target="bm2imlQ028U47hNO7TBu-183" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-179" value="&lt;div style=&quot;&quot;&gt;return &lt;b&gt;addLast&lt;/b&gt;(null, &lt;b&gt;handlers&lt;/b&gt;);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;这步和ServerBootstrapAcceptor&lt;br&gt;注册流程相同，后面省略了很多细节&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2599.9399999999996" y="2702" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-180" value="DefaultChannelPipeline" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="2624.9399999999996" y="2672" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-181" value="&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;pipeline = {DefaultChannelPipeline@2778}&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp;head = {DefaultChannelPipeline$HeadContext@2786}&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; next = {DefaultChannelHandlerContext@2969}&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp;handler = {BootstrapHandlers$&lt;b&gt;BootstrapInitializerHandler&lt;/b&gt;@2800}&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 10px;&quot;&gt;&amp;nbsp; &amp;nbsp;next = {DefaultChannelPipeline$TailContext@2787}&lt;/font&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=top;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="2839.9399999999996" y="2631" width="330" height="70" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-227" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;dashed=1;" parent="1" source="bm2imlQ028U47hNO7TBu-183" target="bm2imlQ028U47hNO7TBu-226" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-183" value="&lt;div style=&quot;&quot;&gt;addLast0(newCtx);&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;添加异步任务，执行子Channel Handler注册&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;由事件循环线程执行&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" parent="1" vertex="1">
          <mxGeometry x="2839.9399999999996" y="2702" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-208" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="bm2imlQ028U47hNO7TBu-184" target="bm2imlQ028U47hNO7TBu-204" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-184" value="&lt;div style=&quot;&quot;&gt;&amp;nbsp;callHandlerAdded0(newCtx);&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" parent="1" vertex="1">
          <mxGeometry x="3319.9999999999995" y="2702" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-186" value="ServerBootstrap#&lt;b&gt;ServerBootstrapAcceptor&lt;/b&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="2329.94" y="2671" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-200" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-197" target="bm2imlQ028U47hNO7TBu-199" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-197" value="&lt;div style=&quot;&quot;&gt;&lt;div&gt;setChannelOptions(child, childOptions, logger);&lt;/div&gt;&lt;div&gt;setAttributes(child, childAttrs);&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" parent="1" vertex="1">
          <mxGeometry x="2359.9399999999996" y="2782" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-202" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;" parent="1" source="bm2imlQ028U47hNO7TBu-199" target="bm2imlQ028U47hNO7TBu-201" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-211" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-199" target="bm2imlQ028U47hNO7TBu-210" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-199" value="&lt;div style=&quot;&quot;&gt;childGroup.register(child).addListener(new ChannelFutureListener() {&lt;span style=&quot;background-color: initial;&quot;&gt;...});&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;将子Channel注册到workerGroup&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="2359.9399999999996" y="2862" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-201" value="&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;div&gt;public void operationComplete(ChannelFuture future) throws Exception {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; if (!future.isSuccess())&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;forceClose&lt;/b&gt;(child, future.cause());&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;" parent="1" vertex="1">
          <mxGeometry x="2599.9999999999995" y="2862" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-203" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-204" target="bm2imlQ028U47hNO7TBu-206" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-204" value="&lt;div style=&quot;&quot;&gt;&lt;div&gt;if (setAddComplete()) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; handler().handlerAdded(this);&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;此处if 为了确保只会注册一次&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;" parent="1" vertex="1">
          <mxGeometry x="3560" y="2702" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-205" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-206" target="bm2imlQ028U47hNO7TBu-207" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-206" value="&lt;div style=&quot;&quot;&gt;&lt;div&gt;if (initChannel(ctx)) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; removeState(ctx);&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;" parent="1" vertex="1">
          <mxGeometry x="3800" y="2702" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-209" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="bm2imlQ028U47hNO7TBu-207" target="bm2imlQ028U47hNO7TBu-87" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="4020" y="2731" />
              <mxPoint x="4020" y="2781" />
              <mxPoint x="3300" y="2781" />
              <mxPoint x="3300" y="2828" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-207" value="&lt;div style=&quot;&quot;&gt;initChannel((C) ctx.channel());&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="4040" y="2702" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-210" value="&lt;div style=&quot;&quot;&gt;catch:&lt;/div&gt;&lt;div style=&quot;&quot;&gt;forceClose(child, t);&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" parent="1" vertex="1">
          <mxGeometry x="2359.9999999999995" y="2950" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-212" value="&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;1&quot;&gt;pipeline.addFirst(&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;1&quot;&gt;NettyPipeline.LoggingHandler, handler);&lt;/font&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="3800.06" y="2798" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-216" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="bm2imlQ028U47hNO7TBu-214" target="bm2imlQ028U47hNO7TBu-96" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-214" value="&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;1&quot;&gt;ChannelPipeline p = channel.pipeline();&lt;/font&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" parent="1" vertex="1">
          <mxGeometry x="3800.06" y="2878" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-223" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-220" target="bm2imlQ028U47hNO7TBu-222" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-220" value="&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;1&quot;&gt;final AbstractChannelHandlerContext next = findContextOutbound(MASK_READ);&lt;/font&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" parent="1" vertex="1">
          <mxGeometry x="4320.06" y="3198.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-225" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-222" target="bm2imlQ028U47hNO7TBu-224" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-222" value="&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;1&quot;&gt;next.invokeRead();&lt;/font&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" parent="1" vertex="1">
          <mxGeometry x="4320.06" y="3277" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-224" value="&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;1&quot;&gt;((ChannelOutboundHandler) handler()).read(this);&lt;/font&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="4320.06" y="3358" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-228" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;dashed=1;" parent="1" source="bm2imlQ028U47hNO7TBu-226" target="bm2imlQ028U47hNO7TBu-184" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-226" value="&lt;div style=&quot;&quot;&gt;register0(promise);&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" parent="1" vertex="1">
          <mxGeometry x="3079.9999999999995" y="2702" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-231" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bm2imlQ028U47hNO7TBu-229" target="bm2imlQ028U47hNO7TBu-230" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-229" value="客户端请求处理" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10;gradientColor=#97d077;" parent="1" vertex="1">
          <mxGeometry x="40" y="2240" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-233" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;dashed=1;" parent="1" source="bm2imlQ028U47hNO7TBu-230" target="bm2imlQ028U47hNO7TBu-51" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="420" y="2270" />
              <mxPoint x="420" y="2124" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-230" value="EpollEventLoop#run()" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="240" y="2240" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-232" value="bossGroup" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="280" y="2139" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-234" value="客户端连接处理&lt;br&gt;&lt;b&gt;AbstractEpollServerChannel&lt;/b&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="1400" y="2202" width="190" height="40" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-235" value="客户端请求流处理&lt;br&gt;&lt;b&gt;AbstractEpollStreamChannel&lt;/b&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="445" y="2561.25" width="190" height="40" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-16" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="bm2imlQ028U47hNO7TBu-237" target="OufeQLtWHH6x2uHgA8jM-2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bm2imlQ028U47hNO7TBu-237" value="&lt;div style=&quot;&quot;&gt;final ChannelConfig config = config();&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" parent="1" vertex="1">
          <mxGeometry x="440" y="2601.25" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-1" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-2" target="OufeQLtWHH6x2uHgA8jM-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-2" value="&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;final EpollRecvByteAllocatorHandle allocHandle = recvBufAllocHandle();&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;allocHandle.edgeTriggered(&lt;/font&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;isFlagSet(Native.EPOLLET));&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;allocHandle.reset(config);&lt;/font&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;allocHandle.attemptedBytesRead(1);&lt;/font&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="420" y="2681.25" width="240" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-3" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-4" target="OufeQLtWHH6x2uHgA8jM-6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-4" value="&lt;div style=&quot;&quot;&gt;final ChannelPipeline pipeline = pipeline();&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;这里获取的是子Channel（通信Channel） 的 pipeline，每个连接对应一个Channel实例, 对应一个pipeline实例&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="440" y="2761.25" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-5" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-6" target="OufeQLtWHH6x2uHgA8jM-15">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-6" value="&lt;div style=&quot;&quot;&gt;epollInBefore();&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="440" y="2840.25" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-7" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-8" target="OufeQLtWHH6x2uHgA8jM-10">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-8" value="&lt;div style=&quot;&quot;&gt;allocHandle.readComplete();&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="440" y="3041.25" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-9" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-10" target="OufeQLtWHH6x2uHgA8jM-12">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-10" value="&lt;div style=&quot;&quot;&gt;pipeline.&lt;b&gt;fireChannelReadComplete&lt;/b&gt;();&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="440" y="3120.75" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-11" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-12" target="OufeQLtWHH6x2uHgA8jM-13">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-12" value="&lt;div style=&quot;&quot;&gt;&lt;div&gt;if (exception != null) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; pipeline.&lt;b&gt;fireExceptionCaught&lt;/b&gt;(exception);&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;发生异常的异常处理&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="440" y="3200.75" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-13" value="&lt;div style=&quot;&quot;&gt;&lt;div&gt;finally {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; epollInFinally(config);&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;" vertex="1" parent="1">
          <mxGeometry x="440" y="3280.75" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-14" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-15" target="OufeQLtWHH6x2uHgA8jM-8">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-15" value="&lt;div style=&quot;&quot;&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;do {&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/font&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;byteBuf = allocHandle.allocate(allocator);&lt;br&gt;&amp;nbsp; &amp;nbsp; allocHandle.lastBytesRead(doReadBytes(byteBuf));&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; ...&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;1&quot;&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/font&gt;&lt;font size=&quot;1&quot;&gt;pipeline.&lt;b&gt;fireChannelRead&lt;/b&gt;(byteBuf);&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;} while (allocHandle.continueReading());&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;arcSize=7;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="420" y="2920.25" width="240" height="103" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-17" value="workerGroup" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="275" y="2300" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-22" value="&lt;font style=&quot;font-size: 10px;&quot;&gt;&lt;b&gt;HeadContext&lt;/b&gt; （Inbound + Outbound）&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="720" y="2920.25" width="280" height="80" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-23" value="&lt;div style=&quot;&quot;&gt;channelRead()&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="730" y="2958.38" width="80" height="26.75" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-25" value="&lt;font style=&quot;font-size: 10px;&quot;&gt;&lt;b&gt;LoggingHandler&lt;/b&gt; （Inbound + Outbound）&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="720" y="3041.25" width="280" height="80" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-26" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-15" target="OufeQLtWHH6x2uHgA8jM-23">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-27" value="&lt;div style=&quot;&quot;&gt;channelRead()&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="730" y="3080" width="80" height="26.75" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-28" value="&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#007fff&quot;&gt;ChannelHandler 借助 &lt;b&gt;AbstractChannelHandlerContext &lt;br&gt;&lt;/b&gt;（双向链表数据结构，还包括executionMask等信息）&lt;br&gt;实现责任链模式，这里pipeline只列举常用的Handler&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="720" y="2862" width="280" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-29" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-23" target="OufeQLtWHH6x2uHgA8jM-27">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-30" value="&lt;font style=&quot;font-size: 10px;&quot;&gt;&lt;b&gt;HttpServerCodec&lt;/b&gt;&amp;nbsp;（HttpServerRequestDecoder: Inbound + HttpServerResponseEncoder: Outbound）&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="720" y="3160" width="280" height="80" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-31" value="&lt;div style=&quot;&quot;&gt;channelRead()&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="730" y="3200.75" width="80" height="26.75" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-104" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=0;entryDx=0;entryDy=0;fillColor=#d5e8d4;strokeColor=#82b366;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-32" target="OufeQLtWHH6x2uHgA8jM-43">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-32" value="&lt;font style=&quot;font-size: 10px;&quot;&gt;&lt;b&gt;HttpTrafficHandler&lt;/b&gt;&amp;nbsp;（Inbound + Outbound）&lt;br&gt;(此Handler只是用于中转)&lt;br&gt;&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="720" y="3280.75" width="280" height="80" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-33" value="&lt;div style=&quot;&quot;&gt;channelRead()&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="730" y="3321.5" width="80" height="26.75" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-105" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0;entryDx=0;entryDy=0;fillColor=#d5e8d4;strokeColor=#82b366;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-35" target="OufeQLtWHH6x2uHgA8jM-69">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-35" value="&lt;font style=&quot;font-size: 10px;&quot;&gt;&lt;b&gt;ChannelOperationsHandler&lt;/b&gt;&amp;nbsp;（Inbound）&lt;br&gt;（实际的请求处理器）&lt;br&gt;&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="720" y="3400" width="280" height="80" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-112" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-36" target="OufeQLtWHH6x2uHgA8jM-111">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-36" value="&lt;div style=&quot;&quot;&gt;channelRead()&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="730" y="3440.75" width="80" height="26.75" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-37" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-27" target="OufeQLtWHH6x2uHgA8jM-31">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-39" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-31" target="OufeQLtWHH6x2uHgA8jM-33">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-40" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-33" target="OufeQLtWHH6x2uHgA8jM-36">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-42" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-43" target="OufeQLtWHH6x2uHgA8jM-46">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-43" value="&lt;font style=&quot;font-size: 10px;&quot;&gt;&lt;b&gt;channelRead&lt;/b&gt;(ChannelHandlerContext ctx, Object msg)&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="240" y="3560" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-44" value="&lt;b&gt;HttpTrafficHandler&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="280" y="3530" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-45" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-46" target="OufeQLtWHH6x2uHgA8jM-49">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-46" value="&lt;font style=&quot;font-size: 10px;&quot;&gt;通过 HAProxyMessageReader 获取请求来源地址，没有就从channel获取&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="480" y="3560" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-47" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-49" target="OufeQLtWHH6x2uHgA8jM-51">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="700" y="3701" />
              <mxPoint x="700" y="3651" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-48" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-49" target="OufeQLtWHH6x2uHgA8jM-52">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-49" value="&lt;font style=&quot;font-size: 10px;&quot;&gt;支持两种请求HTTP格式&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="480" y="3671" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-50" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-51" target="OufeQLtWHH6x2uHgA8jM-54">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-51" value="HttpRequest&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;HTTP，支持长连接、异步响应&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="720" y="3621" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-52" value="&lt;font style=&quot;font-size: 10px;&quot;&gt;DecoderResultProvider&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;自定义协议&lt;/font&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="720" y="3720" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-53" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-54" target="OufeQLtWHH6x2uHgA8jM-56">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-54" value="更新状态：是否是长连接、待响应请求数量、是否溢出（待响应数量超过1就是溢出）" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="880" y="3621" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-55" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-56" target="OufeQLtWHH6x2uHgA8jM-59">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-56" value="DecoderResult decoderResult = request.decoderResult();&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;即使用Http解码器读取请求内容&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="880" y="3700" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-57" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-59" target="OufeQLtWHH6x2uHgA8jM-61">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-58" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-59" target="OufeQLtWHH6x2uHgA8jM-63">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-59" value="HttpServerOperations ops = new &lt;b&gt;HttpServerOperations&lt;/b&gt;(...);&lt;br&gt;ops.&lt;b&gt;bind&lt;/b&gt;();&lt;br&gt;&lt;font style=&quot;font-size: 9px;&quot; color=&quot;#007fff&quot;&gt;定义Http处理的操作，封装了HttpTrafficHandler的属性, 只是设置下CONNECTION属性&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="880" y="3780" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-60" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-61" target="OufeQLtWHH6x2uHgA8jM-65">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-61" value="listener.onStateChange(ops, ConnectionObserver.State.&lt;b&gt;CONFIGURED&lt;/b&gt;);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;调用 TcpServerBind$ChildObserver 监听方法&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="880" y="3859.5" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-62" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fillColor=#d5e8d4;strokeColor=#82b366;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-63" target="OufeQLtWHH6x2uHgA8jM-72">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-63" value="&lt;div&gt;channel().&lt;b&gt;attr&lt;/b&gt;(&lt;br&gt;ReactorNetty.CONNECTION)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;.set(this);&lt;span style=&quot;&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;bind仅仅是将当前ops添加到属性，便于后面取&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1120" y="3780" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-64" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-65" target="OufeQLtWHH6x2uHgA8jM-67">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-65" value="ctx.fireChannelRead(msg);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;交给pipeline中handler责任链下一个节点处理&lt;br&gt;即 ChannelOperationsHandler&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="880" y="3940" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-66" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-67" target="OufeQLtWHH6x2uHgA8jM-69">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-67" value="invokeChannelRead(findContextInbound(&lt;br&gt;MASK_CHANNEL_READ), msg);" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1120" y="3940" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-68" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-69" target="OufeQLtWHH6x2uHgA8jM-72">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-69" value="&lt;b&gt;channelRead&lt;/b&gt;(ChannelHandlerContext ctx, Object msg)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="1360" y="3940" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-70" value="&lt;b&gt;ChannelOperationsHandler&lt;/b&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="1370" y="3910" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-71" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-72" target="OufeQLtWHH6x2uHgA8jM-73">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-72" value="ChannelOperations&amp;lt;?, ?&amp;gt; ops = ChannelOperations.get(ctx.channel());" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1600" y="3940" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-77" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-73" target="OufeQLtWHH6x2uHgA8jM-76">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1840.5" y="4050" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-73" value="ops.&lt;b&gt;onInboundNext&lt;/b&gt;(ctx, msg);" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1600" y="4020" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-103" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-76" target="OufeQLtWHH6x2uHgA8jM-79">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-109" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-76" target="OufeQLtWHH6x2uHgA8jM-108">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-76" value="&lt;b&gt;listener&lt;/b&gt;().onStateChange(this, HttpServerState.&lt;b&gt;REQUEST_RECEIVED&lt;/b&gt;);&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;listener 即&amp;nbsp;TcpServerBind$ChildObserver&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1840" y="4020" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-78" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-79" target="OufeQLtWHH6x2uHgA8jM-81">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-79" value="&lt;b&gt;TcpServerBind$ChildObserver&lt;/b&gt;#&lt;br&gt;&lt;b&gt;onStateChange&lt;/b&gt;(Connection connection, State newState)&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;这个才是真正的请求处理器入口&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="2080" y="4020" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-80" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-81" target="OufeQLtWHH6x2uHgA8jM-84">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-81" value="&lt;b&gt;childObs&lt;/b&gt;.&lt;b&gt;onStateChange&lt;/b&gt;(connection, newState);" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="2319.5" y="4020" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-83" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-84" target="OufeQLtWHH6x2uHgA8jM-89">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-84" value="&lt;div&gt;HttpServerOperations &lt;b&gt;ops&lt;/b&gt; = (HttpServerOperations) connection;&lt;/div&gt;&lt;div&gt;Mono.&lt;b&gt;fromDirect&lt;/b&gt;(&lt;b&gt;handler&lt;/b&gt;.apply(ops, ops))&amp;nbsp; &amp;nbsp; &lt;span style=&quot;background-color: initial;&quot;&gt;.&lt;b&gt;subscribe&lt;/b&gt;(ops.disposeSubscriber());&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;每个请求都会新建Mono做响应式处理&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="2559.5" y="4010" width="200" height="80" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-85" value="HttpServerHandle" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="2599.5" y="3980" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-88" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-89" target="OufeQLtWHH6x2uHgA8jM-91">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-89" value="&lt;div&gt;ops.disposeSubscriber()&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#007fff&quot;&gt;指定订阅者&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="2560" y="4160" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-90" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-91" target="OufeQLtWHH6x2uHgA8jM-102">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-91" value="return this;&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;this是ChannelOperations 类型&lt;br&gt;即 HttpServerOperations 是订阅者&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="2799.5" y="4160" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-92" value="&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#007fff&quot;&gt;关于Mono.fromDirect().subscribe()&lt;br&gt;原理，参考 ProjectReactor流程图&lt;br&gt;&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="2560" y="4090" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-102" value="&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;public final void onSubscribe(Subscription s) {&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; if (Operators.&lt;b&gt;setOnce&lt;/b&gt;(OUTBOUND_CLOSE, this, s)) {&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; s.request(Long.MAX_VALUE);&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&amp;nbsp; &amp;nbsp; }&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;}&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 9px;&quot;&gt;即通过FieldUpdater只修改当前对象&amp;nbsp;Subscription outboundSubscription 字段一次，成功就触发Publisher发送&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font color=&quot;#007fff&quot; style=&quot;font-size: 9px;&quot;&gt;setOnce() 可以避免请求被重复处理&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=left;arcSize=7;" vertex="1" parent="1">
          <mxGeometry x="3039.5" y="4140" width="240.5" height="100" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-106" value="&lt;font color=&quot;#007fff&quot;&gt;此处handler即用户自定义的请求处理方法&lt;br&gt;比如 handle((req, resp) -&amp;gt; req.receive().then(resp.status(200).send()))&lt;br&gt;&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="2759.5" y="3970" width="390" height="40" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-107" value="&lt;div&gt;&amp;nbsp; &amp;nbsp; private static final int &lt;b&gt;MASK_ALL_INBOUND&lt;/b&gt; = MASK_EXCEPTION_CAUGHT | MASK_CHANNEL_REGISTERED |&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; MASK_CHANNEL_UNREGISTERED | MASK_CHANNEL_ACTIVE | MASK_CHANNEL_INACTIVE | MASK_CHANNEL_READ |&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; MASK_CHANNEL_READ_COMPLETE | MASK_USER_EVENT_TRIGGERED | MASK_CHANNEL_WRITABILITY_CHANGED;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; private static final int &lt;b&gt;MASK_ALL_OUTBOUND&lt;/b&gt; = MASK_EXCEPTION_CAUGHT | MASK_BIND | MASK_CONNECT | MASK_DISCONNECT |&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; MASK_CLOSE | MASK_DEREGISTER | MASK_READ | MASK_WRITE | MASK_FLUSH;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="1020" y="3031.25" width="800" height="90" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-108" value="onInboundComplete();&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;Inbound 处理完成，俺pipeline Outbound Handler 顺序执行写返回操作&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="1840" y="4100" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-114" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-111" target="OufeQLtWHH6x2uHgA8jM-113">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-111" value="&lt;div style=&quot;&quot;&gt;ChannelOptions#&lt;/div&gt;&lt;div style=&quot;&quot;&gt;onInboundComplete()&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="805" y="3503.25" width="110" height="26.75" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-116" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-113" target="OufeQLtWHH6x2uHgA8jM-115">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-113" value="&lt;div style=&quot;&quot;&gt;write()&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="910" y="3321.5" width="80" height="26.75" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-118" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-115" target="OufeQLtWHH6x2uHgA8jM-117">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-115" value="&lt;div style=&quot;&quot;&gt;write() flush()&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="910" y="3200.75" width="80" height="26.75" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-119" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-117" target="OufeQLtWHH6x2uHgA8jM-120">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1050" y="2980" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-117" value="&lt;div style=&quot;&quot;&gt;write() flush()&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="910" y="3080" width="80" height="26.75" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-122" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-120" target="OufeQLtWHH6x2uHgA8jM-121">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-120" value="&lt;div style=&quot;&quot;&gt;write()&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="910" y="2958.37" width="80" height="26.75" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-124" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="OufeQLtWHH6x2uHgA8jM-121" target="OufeQLtWHH6x2uHgA8jM-123">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-121" value="unsafe.write(msg, promise);&lt;br&gt;unsafe.flush();&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;这里的write是写Buffer, flush 才是真正的写返回&lt;/font&gt;" style="whiteSpace=wrap;html=1;fontSize=10;rounded=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="1040" y="2941.76" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OufeQLtWHH6x2uHgA8jM-123" value="socket.writeAddress()&lt;br&gt;&lt;font color=&quot;#007fff&quot;&gt;最终通过native方法写数据&lt;/font&gt;" style="whiteSpace=wrap;html=1;fontSize=10;rounded=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="1220" y="2941.76" width="160" height="60" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
